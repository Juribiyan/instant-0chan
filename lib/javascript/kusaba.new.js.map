{"version":3,"sources":["es6/src/kusaba.new.js"],"names":["style_cookie","style_cookie_txt","style_cookie_site","ispage","kumod_set","is_entering","_messages","en","noLocalStorage","oops","blankResponse","expandingThread","newThread","NewThread","replyTo","cancel","update","updatingCounts","couldntFetch","noNewPosts","replies","settings_fxEnabled","settings_showReplies","settings_sfwMode","settings_expandImgFull","settings_constrainWidth","settings_newMediaViewer","settings_hidePostBtn","enterCaptcha","selectText","dcls","watchOn","captcharot","threadUpdationAutomatically","stopFuckingDolls","del","delandban","ban","stickthread","unstickthread","lockthread","unlockthread","returnDesktop","returnTouch","forceDesktop","okay","captchalang","reply","imageDownscaledBy","videoDownscaledBy","toFit","newReplies","newThreadsAvailable","loading","anonymous","sortBy","bumpOrder","lastReply","creationDate","replyCount","doStick","showHidden","doNotStick","hideHidden","search","threadOnPage","goToThread","smallPics","largePics","legacyMode","threads","comments","active_since","last_active","active_on","tryAgain","xhrError","details","thread","post","posts","deleted","deletedMulti","report","reported","reportedMulti","fileRemoved","file","files","collapse","asMod","asOP","historyEmpty","noDataLoaded","unable_load_20","captchaLangChanged","found","links","selectMultiple","selected","directLink","quoteLink","maxAttNumReached","unsupportedFileType","hideName","removeFile","spoilerOnOff","hidePost","unhidePost","settings_hideCompletely","pinUnpin","hideForm","collapseExpand","notEmpty","showName","showSubject","showEmbeds","showPassword","showTTL","attachFile","classicSimplifiedForm","showMarkup","refreshCatalog","cancelTimer","saved","savedMulti","password","captcha","captchaImage","refreshCaptcha","showCaptcha","captchaExpired","mod_","ru","odc","_l","locale","hasOwnProperty","onReady","pushTask","fn","isReady","tasks","push","ready","forEach","Array","prototype","indexOf","elt","len","length","from","arguments","Math","ceil","floor","Utf8","encode","string","String","fromCharCode","replace","c","utftext","n","charCodeAt","decode","i","c2","c3","Cookie","name","regexp","RegExp","hit","exec","document","cookie","unescape","replaceAll","value","days","expires","date","Date","setTime","getTime","toGMTString","str","to","idx","_lastActiveForm","Object","defineProperty","window","get","getClientRects","updateActiveForm","set","el","querySelectorAll","a","classList","remove","form","_findParent","add","contains","toggleFormCollapse","floating","querySelector","lastActiveForm","findClosest","selector","height","innerHeight","list","closest","map","call","rect","offset","abs","y","filter","sort","e1","e2","insert","text","breakBefore","breakAfter","textarea","start","selectionStart","end","selectionEnd","pre","substr","charBefore","charAfter","selectionRange","setSelectionRange","focus","markup","$target","istart","iend","element","find","startPos","endPos","substring","bullets","bullet","$area","val","split","newtxt","quotes","type","areaVal","tag","quote","b","v","eval","checkhighlight","match","location","toString","$","highlight","id","offTimeout","removeClass","this_board_dir","$post","parents","addClass","setTimeout","bcr","getBoundingClientRect","docHeight","documentElement","clientHeight","bottom","top","postX","scrollTop","spaceAround","scrollTo","password_length","get_password","pass","getCookie","randomString","togglePassword","passwordbox_html","html","toLowerCase","newhtml","show","set_cookie","Styles","all","titles","init","_","each","getElementsByTagName","link","getAttribute","_default","hasAttribute","custom","current","customBypass","in_array","initiated","decide","testingCSS","LSfetchJSON","title","addStyle","url","setStyle","$clink","click","ev","preventDefault","quitTest","parent","slideUp","$cancelLink","append","setCustom","sc","setDefault","change","stylename","removeBypass","addBypass","oldcookie","newcookie","brd","join","scrollAnchor","save","sheet","disabled","restore","onTest","m","capitalize","escape","$link","testStyle","pups","succ","time","confirmLongTermTest","localStorage","setItem","JSON","stringify","removeItem","HiddenItems","hideCompletely","ls","kind","lists","write","buildCSS","unhide","hide","hiddenPosts","node","updateCSS","injector","inject","isHidden","hideItem","saveList","unhideItem","hideThread","slideDown","$thread","$form","promise","done","toggleFormFloating","unhideThread","togglePost","$body","$btn","css","attr","expandthread","threadid","board","expandFrom","data","expandTo","$omitted","prependTo","HTMLoader","getThread","err","replaceWith","replyMap","showReplies","newposts","busy","options","defaults","expectedPost","silent","onError","onSuccess","timestamp","execute","task","next","replies_container","$newposts_get","$lastQrl","last","lastpost","idb","bd","insertAdjacentHTML","unreadCounter","refreshTimestamp","info","stack","shift","flyTo","dest","destBox","destX","x","width","destY","elBox","style","transformOrigin","Promise","resolve","getComputedStyle","transition","oldBox","offRight","right","innerWidth","toggle","box","newWidth","left","toggleFormRow","btn","dataset","row","rem","isRowEmpty","_originalTitle","focal","inputs","checked","trim","updateReminders","float","pinner","getParentPost","f","then","drags","mousedown","e","stopPropagation","dragsOff","prop","hidePostForm","_preview","_pinned","toggleFormSimplify","simplify","simplified","clonePostForm","anchorID","preview","boardName","getPostbox","Captcha","enabled","state","newForm","oldForm","cloneNode","innerText","blotter","onclick","uniqueId","l","newid","input","setAttribute","resetForm","richFileInput","initForm","maybePost","_findPrevious","matches","skip","anchor","pinned","ondragstart","ondrop","quickreply","$this","threadID","postID","fromExternalBoard","is_overboard","$preview","needInsert","_findNext","formExists","formHidden","formFloating","quotation","getPostQuotation","parentElement","insertAdjacentElement","existingForm","_getSelection","getSelection","selection","selectedText","anchorNode","getLocalSelection","sel","_isChildOf","popupMessage","content","delay","console","warn","forceEnable","captchaTimeout","addImgLoadListener","cw","onClick","bind","addEventListener","evt","onFieldClick","onload","onImageLoad","evType","onAnimationEnd","_state","s","offsetWidth","clear","refresh","ctrlKey","altKey","target","switch_lang","cColor","slice","ku_boardspath","random","img","src","formatFileSize","bytes","round","handleFiles","fromClipboard","maxfiles","slotsLeft","filesLeft","fileAttached","handleFile","fx","ns","ext","pop","allowedFiletypes","fname","sizeFormatted","size","reader","FileReader","result","addFile","readAsDataURL","extra","index","store","recalcForm","thisEl","updateInfo","toUpperCase","naturalWidth","naturalHeight","onerror","_ext","updateTitle","count","innerHTML","$el","hasClass","serialize","fd","fe","_this","on","$entry","toggleClass","select","item","items","clipboardData","originalEvent","arr","getAsFile","nodeName","dataTransfer","Sortable","create","animation","handle","removeAttribute","area","previousElementSibling","clearStore","handleCtrlEnter","activeElement","Ajax","submitPost","redirectTo","href","sage","hcaptcha","async","response","key","actuallySubmitPost","catch","error","shownErrors","hCaptchaResponse","alertsToRemove","clone","closeByID","showError","captchafield","showWarning","FormData","xr","XMLHttpRequest","postToken","open","action","status","res","parse","error_verbose","error_type","ku_cgipath","badatt","error_data","attachmenttype","position","timings","log","nokoInput","noko","thread_replyto","post_id","reload","send","reportPost","callback","forms","delform","postsReported","postErrors","success","msg","message","timerToken","postsSaved","$reply","modThread","$a","$li","$posthead","$extrabtns","prepend","makeIcon","deleteItems","has","delToken","inspectFormData","formData","pair","entries","classes","bare","addCaptchaToMenu","$menu","keydown","MediaViewer","postnum","imgurl","thumburl","imgw","imgh","isVideo","thumb","initZoom","createContainer","resetTransform","PostPreviews","pinPreview","thBCR","thumb_x","thumb_y","thumb_w","thumb_h","win_w","viewer","clientWidth","win_h","scaleDownFactor","pre_w","mi_w","mi_h","me","_ins","createMediaElement","refreshList","currentThumb","visibility","updateCounter","showPercentage","_isVideo","setVolume","_scaleDownFactor","currentMediaItem","_realWidth","body","overflow","requestAnimationFrame","container","transform","min","thumbw","thumbh","findIndex","handleZoom","mouseX","clientX","mouseY","clientY","isMouseDown","handleDrag","button","ov","pointerEvents","gripX","gripY","emptyClick","isDragged","pnb","switchItem","toggleFullSize","translateX","translateY","scale","zoomAmount","minScale","zoomSteps","dir","sign","deltaY","initialScale","zSteps","z","concat","centerX","centerY","newScale","isNaN","applyTransform","flashLabel","dx","dy","initialTransX","initialTransY","parseVideo","parseImg","vid","volume","onvolumechange","muted","clearTimeout","flashLabelTimeout","svg","resizeFactor","offScreen","thumbBCR","transX","transY","onCollapse","underImageSrc","trans","Element","firstElementChild","lastElementChild","nextElementSibling","expandimg_old","getElementById","fc_width","$element","$postbody","$fc_filename","event","which","Settings","expandImgFull","max_w","offset_el","offsetLeft","offsetParent","new_w","ratio","zoom","notice","createElement","textDecoration","textNode","createTextNode","appendChild","insertBefore","maxWidth","expandimg","newMediaViewer","mv","zindex","_parseLink","cl","_mouseover","isCatalog","parsedURL","parentid","postid","previewid","children","first","before","mouseleave","_mouseout","mouseover","mouseOverPreview","pageY","pageX","zIndex","cursor","getPost","ebtns","is","fadeout","nodelay","predelay","_timings","fade","pin","temporary","o","set_inputs","savedName","em","postpassword","set_delpass","special","load","nodeType","tagName","complete","readyState","handler","apply","trigger","jQuery","_checkbox","clicked","settingName","defaultValue","perBoard","settingNameGeneral","removeAttr","fxEnabled","changed","off","is_catalog","sfwMode","constrainWidth","hidePostBtn","rswap","swap","after","setCaptchaLang","lang","offClick","readyset","isTouch","pf","chpok","LatexIT","checkgotothread","checknamesave","bnrs","processNodeInsertion","add_mob_menu","menu_show","cloud20","mouseenter","head","js","OpenLatexEditor","expandVideo","xl","animate","htm","stripHTML","ref","postnode","formBoard","postBody","qoutation","unwrapEmbed","wrapEmbed","countries","$fig","$fsz","pause","itemCount","$postnode","isOP","opmod","visible","$boundTo","ofs","offsetTop","outerHeight","outerWidth","fileid","$pn","pid","__menuProps","isFile","$md","isShown","menu","$item","$pass","$c","special_error","errors","cssLink","styleName","isTrip","resize","$fileMenu","textbox","onfocus","onblur","animationName","catalog","appendTo","trip","getJSON","formatDate","fadeIn","fail","liveupd_ena","io","updater","doubletap","bindType","delegateType","handleObj","targetData","now","delta","lastTouch","touches","origType","property","changedTouches","NTP","calc","t0","t1","t2","t3","sync","pending","valueOf","ajax","servertime","synced","timeWithOffset","getServerTime","externallyResolvingPromise","promiseResolve","promiseReject","reject","$node","prettyPrint","render","iv","updateTTL","ms_left","srvTime","min_left","h_left","padLeft","markOnly","clearInterval","setInterval","audio","play","noop","newThreads","socket","connect","liveupd_api","subscribeTo","liveupd_sitename","thr","dispatch","emit","writable","configurable","token","notifyAboutNewThreads","notifyAboutNewRepliesOnBoardPage","showNewReplies","hasFocus","board_desc","new_thread_id","showNewThreads","room","repliesOnBoardPage","reply_id","refreshNewRepliesCount","$counter","clearCounter","loadNewReplies","$freshReplies","freshReplies","__alreadyLoading","$wta","bySelf","postsDeleted","insideDeletedThread","filesDeleted","fileErrors","deletedClasses","by_op","by_mod","itemtype","prev","thread_id","kumod","expandVideo_old","$mov","movieurl","dt","uid","video","checkd","doc","navigatepages","docloc","page","docloc_trimmed","lastIndexOf","docloc_valid","relativepost","maxthreads","getElementsByName","newrelativepost","attachEvent","NodeList","parentNode","Node","root","postNum","repliesContainer","linkData","className","linkDestBoard","linkPostNum","includes","elements","dimensions","scrollY","_top","mid","elMap","parentBCR","elems","pos","relativeVisibleWidth","relativeVisibleHeight","primaryVisibility","secondaryVisibility","primaryOffset","secondaryOffset","bcrBefore","loaded","bcrAfter","scrollBy","lastTime","vendors","cancelAnimationFrame","currTime","timeToCall","max","menu_current","menu_last","dl","queue","clearQueue","menu_pin","toggle_oldmenu","mode","implementation","hasFeature","eqn","txt","atxt","extxt","r","g","replaceWithSrc","$scope","scope","normalizergb","toFixed","normalizergba","needle","haystack","opt","extend","$drag","z_idx","drg_h","drg_w","pos_y","pos_x","onMove","$iw","paddingBottom","code","enccode","encodeURI","$ew","empty","isClone","fields","field","onchange","indicator","embedLinks","process","site","nextCheckbox","exp","onmouseleave","hideTimeout","onmouseenter","cms","areaID","ro","readOnly","sub","ttl","fileButton","alias","existing","styleSheet","cssText","removeChild","chars","mm","$mmw","overboard_dir","overboard_desc","cats","boards10","getBoards","order","boards","b20","cat","ix","desc","R","sqrt","allboards","toexpand","sd","sect","section","rs","rj","query","display","opts","ku_boardsfolder","reduced","bnr","path","toDisplay","randomItem","getRandomInt","array","sites","rx","fruit","conf","layout","respectStickied","expandOnHover","saveConfig","myConf","refreshBtn","sortBtns","v_d_i","pinBtns","hideBtns","layoutBtns","searchInput","$card","getEmbedThumb","currentTarget","threadIX","model","hidden","rendered","$group","build","gallery","fileTypes","image","jpgThumb","iconsAvailable","embed","authorities","short","Dow","dateLocal","dows","getDay","yy","getFullYear","mo","getMonth","Mon","mons","dd","getDate","hh","getHours","getMinutes","ss","getSeconds","entry","sortByOrder","sby","repeat","buildEntry","thumbnail_url","outerHTML","thumbnail_medium","processed","embeds","smallThumb","file_type","ftype","thumbURL","vartype","bigThumb","smallSrc","expandable","op","repliesLabel","reply_count","last_reply","images","countersCombined","posterauthority","nameDatePriority","tripcode","poster","this_board_defaultName","dateCompact","searchData","subject","buildIndicators","layouts","stickied","lock","locked","deathmark","deleted_timestamp","indicatorsCombined","tmp","createHTMLDocument","textContent","overboard","_boards","unique","boardid","idFromName","built","lastvisits","last_ts","parseInt","dataType","valstr","$brd","loadThread","boardID","force_html_nocache","thrno","postMap","cached","threadMaps","secondTry","cachedPost","range","force","threadMap","reduce","cachedPostboxes","pb","hcaptchaScript","firstChild","switchFileType","exts","buildAlert","marginTop","timeout","onHold","old","reverse","ar","ae","holdOffTimeout","scheduleClose","aid","byID","cooldown","upd","cls","contentsOnly","contents","iconMap","historyToggle","destroy","defaultTimeout","container_id","pupclass","historySize","cloneDeep","junkProperty"],"mappings":"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","file":"kusaba.new.js","sourcesContent":["'use strict';\r\n\r\nvar style_cookie;\r\nvar style_cookie_txt;\r\nvar style_cookie_site;\r\nvar kumod_set=false;\r\nvar ispage;\r\nvar is_entering=false;\r\n\r\nvar _messages = {\r\n  en: {\r\n    noLocalStorage: \"Your browser does not support LocalStorage\",\r\n    oops: \"Something went wrong...\",\r\n    blankResponse: \"blank response\",\r\n    expandingThread: \"Expanding thread...\",\r\n    newThread: \"new thread\",\r\n    NewThread: \"New thread\",\r\n    replyTo: \"reply to\",\r\n    cancel: \"Cancel\",\r\n    update: \"Update\",\r\n    updatingCounts: \"Updating...\",\r\n    couldntFetch: \"Could not fetch this post\",\r\n    noNewPosts: \"No new posts\",\r\n    replies: \"Replies\",\r\n    settings_fxEnabled: \"Animation effects\",\r\n    settings_showReplies: \"Show replies inside posts\",\r\n    settings_sfwMode: \"NSFW mode\",\r\n    settings_expandImgFull: \"Expand images to full size\",\r\n    settings_constrainWidth: \"Constrain content width\",\r\n    settings_newMediaViewer: \"Experimental media viewer\",\r\n    settings_hidePostBtn: 'Post hide buttons',\r\n    enterCaptcha: \"Please enter captcha.\",\r\n    selectText: \"Select some text\",\r\n    dcls: \"Double click to show source\",\r\n    watchOn: \"Watch on\",\r\n    captcharot: \"Captcha has rotted\",\r\n    threadUpdationAutomatically: \"Tread is being updated automatically.\",\r\n    stopFuckingDolls: \"<b> AJAX-   AJAX- .</b><br />(,  )\",\r\n    del: \"Delete\",\r\n    delandban: \"Delete and ban\",\r\n    ban: \"Ban\",\r\n    stickthread: \"Stick thread\",\r\n    unstickthread: \"Unstick thread\",\r\n    lockthread: \"Lock thread\",\r\n    unlockthread: \"Unlock thread\",\r\n    returnDesktop: \"Switch to desktop interface\",\r\n    returnTouch: \"Switch to touch interface\",\r\n    forceDesktop: \"Force Desktop interface\",\r\n    okay: \"Okay\",\r\n    captchalang: \"Captcha language\",\r\n    reply: \"Reply\",\r\n    imageDownscaledBy: \"Image was downscaled by\",\r\n    videoDownscaledBy: \"Video was downscaled by\",\r\n    toFit: \"to feet screen\",\r\n    newReplies: \"New replies\",\r\n    newThreadsAvailable: \"New threads available.\",\r\n    loading: \"Loading\",\r\n    anonymous: \"Anonymous\",\r\n    sortBy: \"Sort by\",\r\n    bumpOrder: \"Bump order\",\r\n    lastReply: \"Last reply\",\r\n    creationDate: \"Creation date\",\r\n    replyCount: \"Reply count\",\r\n    doStick: \"Respect stickied\",\r\n    showHidden: \"Show hidden\",\r\n    doNotStick: \"Ignore stickied\",\r\n    hideHidden: \"Hide hidden\",\r\n    search: \"Search\",\r\n    threadOnPage: \"Thread is on page\",\r\n    goToThread: \"Go to thread\",\r\n    smallPics: \"Small pictures\",\r\n    largePics: \"Large pictures\",\r\n    legacyMode: \"Legacy mode\",\r\n    threads: \"Threads\",\r\n    comments: \"Replies\",\r\n    active_since: \"Active since\",\r\n    last_active: \"Last seen\",\r\n    active_on: \"Active on\",\r\n    tryAgain: \"Try again\",\r\n    xhrError: \"XHR error\",\r\n    details: \"details\",\r\n    thread: \"Thread\",\r\n    post: 'Post',\r\n    posts: \"Posts\",\r\n    deleted:'has been deleted',\r\n    deletedMulti: 'have been deleted',\r\n    report: 'Report',\r\n    reported:'has been reported',\r\n    reportedMulti: 'have been reported',\r\n    fileRemoved: 'File<br>removed.',\r\n    file: 'File',\r\n    files: 'Files',\r\n    collapse: 'Collapse',\r\n    asMod: 'as Mod',\r\n    asOP: 'as OP',\r\n    historyEmpty: 'History is empty',\r\n    noDataLoaded: 'No data was loaded',\r\n    unable_load_20: 'Unable to load 2.0 boards list',\r\n    captchaLangChanged: 'Captcha laguage changed',\r\n    found: 'Found',\r\n    links: 'Links',\r\n    selectMultiple: 'Select multiple',\r\n    selected: 'Selected',\r\n    directLink: 'Direct link',\r\n    quoteLink: 'Quote link',\r\n    maxAttNumReached: 'Attachments number limit reached.',\r\n    unsupportedFileType: 'unsupported file type',\r\n    hideName:'Hide file name',\r\n    removeFile: 'Remove file',\r\n    spoilerOnOff: 'Spoier On/Off',\r\n    hidePost: 'Hide post',\r\n    unhidePost: 'Unhide post',\r\n    settings_hideCompletely: 'Hide items completely',\r\n    pinUnpin: 'Pin/Unpin',\r\n    hideForm: 'Hide form',\r\n    collapseExpand: 'Collapse/Expand',\r\n    notEmpty: 'Not empty',\r\n    showName: 'Show/hide name/trip field',\r\n    showSubject: 'Show/hide subject field',\r\n    showEmbeds: 'Show/hide embeds',\r\n    showPassword: 'Show/hide password field',\r\n    showTTL: 'Show/hide time-to-live field',\r\n    attachFile: 'Attach file...',\r\n    classicSimplifiedForm: 'Classic/simplified form',\r\n    showMarkup: 'Show/hide markup',\r\n    refreshCatalog: 'Refresh catalog',\r\n    cancelTimer: 'Cancel timer',\r\n    saved:'saved from deletion',\r\n    savedMulti: 'saved from deletion',\r\n    password: 'Password',\r\n    captcha: 'Captcha',\r\n    captchaImage: 'Captcha image',\r\n    refreshCaptcha: 'Refresh captcha',\r\n    showCaptcha: 'Show captcha',\r\n    captchaExpired: 'Captcha has expired.',\r\n    mod_: 'Mod.'\r\n  },\r\n  ru: {\r\n    noLocalStorage: \"localStorage   \",\r\n    oops: \"-   ...\",\r\n    blankResponse: \" \",\r\n    expandingThread: \" ...\",\r\n    newThread: \" \",\r\n    NewThread: \" \",\r\n    replyTo: \" \",\r\n    cancel: \"\",\r\n    update: \"\",\r\n    updatingCounts: \"  ...\",\r\n    couldntFetch: \"    \",\r\n    noNewPosts: \"  \",\r\n    replies: \"\",\r\n    settings_fxEnabled: \" \",\r\n    settings_showReplies: \"   \",\r\n    settings_sfwMode: \"  \",\r\n    settings_expandImgFull: \"    \",\r\n    settings_constrainWidth: \"  \",\r\n    settings_newMediaViewer: \"  \",\r\n    settings_hidePostBtn: '  ',\r\n    enterCaptcha: \",  .\",\r\n    selectText: \"  \",\r\n    dcls: \"Double click to show source\",\r\n    watchOn: \" \",\r\n    odc: \"javascript:LatexIT.replaceWithSrc(this);\",\r\n    captcharot: \" \",\r\n    threadUpdationAutomatically: \"  \",\r\n    stopFuckingDolls: \"<b> AJAX-   AJAX- .</b><br />(,  )\",\r\n    del: \"\",\r\n    delandban: \"  \",\r\n    ban: \"\",\r\n    stickthread: \" \",\r\n    unstickthread: \" \",\r\n    lockthread: \" \",\r\n    unlockthread: \" \",\r\n    returnDesktop: \"   \",\r\n    returnTouch: \"  -\",\r\n    forceDesktop: \"Force Desktop interface\",\r\n    okay: \"\",\r\n    captchalang: \" \",\r\n    reply: \"\",\r\n    imageDownscaledBy: \"  \",\r\n    videoDownscaledBy: \"  \",\r\n    toFit: \"  \",\r\n    newReplies: \" \",\r\n    newThreadsAvailable: \"  .\",\r\n    loading: \"\",\r\n    anonymous: \"\",\r\n    sortBy: \" \",\r\n    bumpOrder: \"\",\r\n    lastReply: \" \",\r\n    creationDate: \" \",\r\n    replyCount: \" \",\r\n    doStick: \"\",\r\n    showHidden: \" \",\r\n    doNotStick: \" \",\r\n    hideHidden: \" \",\r\n    search: \"\",\r\n    threadOnPage: \"   \",\r\n    goToThread: \"  \",\r\n    smallPics: \" \",\r\n    largePics: \" \",\r\n    legacyMode: \" \",\r\n    threads: \"\",\r\n    comments: \"\",\r\n    active_since: \"\",\r\n    last_active: \" \",\r\n    active_on: \" \",\r\n    tryAgain: \" \",\r\n    xhrError: \" XHR\",\r\n    details: \"\",\r\n    thread: \"\",\r\n    post: '',\r\n    posts: '',\r\n    deleted:'',\r\n    deletedMulti: '',\r\n    report: '',\r\n    reported:':  ',\r\n    reportedMulti: ':  ',\r\n    fileRemoved: '<br>.',\r\n    file: '',\r\n    files: '',\r\n    collapse: '',\r\n    asMod: '  ',\r\n    asOP: '  ',\r\n    historyEmpty: ' ',\r\n    noDataLoaded: '  ',\r\n    unable_load_20: 'Unable to load 2.0 boards list',\r\n    captchaLangChanged: '  ',\r\n    found: '',\r\n    links: '',\r\n    selectMultiple: ' ',\r\n    selected: '',\r\n    directLink: '   ',\r\n    quoteLink: '  ',\r\n    maxAttNumReached: '   .',\r\n    unsupportedFileType: '  ',\r\n    hideName:'  ',\r\n    removeFile: ' ',\r\n    spoilerOnOff: ' /',\r\n    hidePost: ' ',\r\n    unhidePost: ' ',\r\n    settings_hideCompletely: '    ',\r\n    pinUnpin: '/',\r\n    hideForm: ' ',\r\n    collapseExpand: '/',\r\n    notEmpty: ' ',\r\n    showName: '/  ',\r\n    showSubject: '/  ',\r\n    showEmbeds: '/ ',\r\n    showPassword: '/   ',\r\n    showTTL: '/  ',\r\n    attachFile: ' ...',\r\n    classicSimplifiedForm: '/ ',\r\n    showMarkup: '/ ',\r\n    refreshCatalog: ' ',\r\n    cancelTimer: ' ',\r\n    saved:'  ',\r\n    savedMulti: '  ',\r\n    password: '',\r\n    captcha: 'Captcha',\r\n    captchaImage: 'Captcha image',\r\n    refreshCaptcha: ' ',\r\n    showCaptcha: ' ',\r\n    captchaExpired: ' .',\r\n    mod_: '.'\r\n  }\r\n}\r\nvar _l = (typeof locale !== 'undefined' && _messages.hasOwnProperty(locale)) ? _messages[locale] : _messages.ru;\r\n\r\nvar onReady = {\r\n  pushTask: function(fn) {\r\n    if (this.isReady)\r\n      fn()\r\n    else\r\n      this.tasks.push(fn)\r\n  },\r\n  tasks: [],\r\n  ready: function() {\r\n    this.isReady = true\r\n    this.tasks.forEach(fn=>fn())\r\n  }\r\n}\r\n\r\n/* IE/Opera fix, because they need to go learn a book on how to use indexOf with arrays */ // Is this still relevant tho?\r\nif (!Array.prototype.indexOf) {\r\n  Array.prototype.indexOf = function(elt /*, from*/) {\r\n  var len = this.length;\r\n\r\n  var from = Number(arguments[1]) || 0;\r\n  from = (from < 0)\r\n     ? Math.ceil(from)\r\n     : Math.floor(from);\r\n  if (from < 0)\r\n    from += len;\r\n\r\n  for (; from < len; from++) {\r\n    if (from in this &&\r\n      this[from] === elt)\r\n    return from;\r\n  }\r\n  return -1;\r\n  };\r\n}\r\n\r\n/* Utf8 strings de-/encoder */\r\nvar Utf8 = {\r\n  // public method for url encoding\r\n  encode : function (string) {\r\n    string = string.replace(/\\r\\n/g,\"\\n\");\r\n    var utftext = \"\";\r\n    for (var n = 0; n < string.length; n++) {\r\n      var c = string.charCodeAt(n);\r\n      if (c < 128) {\r\n        utftext += String.fromCharCode(c);\r\n      }\r\n      else if((c > 127) && (c < 2048)) {\r\n        utftext += String.fromCharCode((c >> 6) | 192);\r\n        utftext += String.fromCharCode((c & 63) | 128);\r\n      }\r\n      else {\r\n        utftext += String.fromCharCode((c >> 12) | 224);\r\n        utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n        utftext += String.fromCharCode((c & 63) | 128);\r\n      }\r\n    }\r\n    return utftext;\r\n  },\r\n  // public method for url decoding\r\n  decode : function (utftext) {\r\n    var string = \"\", i = 0, c = 0, c1 = 0, c2 = 0, c3 = 0\r\n    while ( i < utftext.length ) {\r\n      c = utftext.charCodeAt(i);\r\n      if (c < 128) {\r\n        string += String.fromCharCode(c);\r\n        i++;\r\n      }\r\n      else if((c > 191) && (c < 224)) {\r\n        c2 = utftext.charCodeAt(i+1);\r\n        string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\r\n        i += 2;\r\n      }\r\n      else {\r\n        c2 = utftext.charCodeAt(i+1);\r\n        c3 = utftext.charCodeAt(i+2);\r\n        string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n        i += 3;\r\n      }\r\n    }\r\n    return string;\r\n  }\r\n}\r\n\r\nfunction Cookie(name) {\r\n  if (arguments.length == 1) {\r\n    // with(document.cookie) {\r\n      var regexp=new RegExp(\"(^|;\\\\s+)\"+name+\"=(.*?)(;|$)\");\r\n      var hit=regexp.exec(document.cookie);\r\n      if(hit&&hit.length>2) return Utf8.decode(unescape(replaceAll(hit[2],'+','%20')));\r\n      else return '';\r\n    // }\r\n  } else {\r\n    var value = arguments[1]\r\n    , days = arguments[2]\r\n    , expires=\"\"\r\n    if(days) {\r\n      var date=new Date();\r\n      date.setTime(date.getTime()+(days*24*60*60*1000));\r\n      expires=\"; expires=\"+date.toGMTString();\r\n    }\r\n    document.cookie=name+\"=\"+value+expires+\"; path=/\";\r\n  }\r\n}\r\n\r\nfunction replaceAll(str, from, to) {\r\n  var idx = str.indexOf( from );\r\n  while ( idx > -1 ) {\r\n    str = str.replace( from, to );\r\n    idx = str.indexOf( from );\r\n  }\r\n  return str;\r\n}\r\n\r\nvar _lastActiveForm = false\r\nObject.defineProperty(window, 'lastActiveForm', {\r\n  get: function() {\r\n    if (!_lastActiveForm || !_lastActiveForm.getClientRects().length) {\r\n      updateActiveForm()\r\n    }\r\n    return _lastActiveForm\r\n  },\r\n  set: function(el) {\r\n    document.querySelectorAll('.qrf-active').forEach(a => a.classList.remove('qrf-active'))\r\n    if (el) {\r\n      let form = el._findParent('form') // _findParent retuns element itself if in matches the selector\r\n      form.classList.add('qrf-active')\r\n      if (form.classList.contains('collapsed')) {\r\n        toggleFormCollapse(form, false/* uncollapse*/, false/* no focus*/)\r\n      }\r\n      _lastActiveForm  = form\r\n    }\r\n    else\r\n      _lastActiveForm = false\r\n  }\r\n})\r\nfunction updateActiveForm() {\r\n  let floating = document.querySelector('.qrf-floating:not(.collapsed)')\r\n  if (floating) {\r\n    lastActiveForm = floating\r\n    return\r\n  }\r\n  lastActiveForm = findClosest('.qrf-floating.collapsed, .quick-reply-form textarea')\r\n  return\r\n}\r\n\r\nfunction findClosest(selector) {\r\n  let height = window.innerHeight\r\n  , hh = height / 2\r\n  , list = document.querySelectorAll(selector)\r\n  if (!list) return false\r\n  let closest = [].map.call(list, el => {\r\n    let rect = el.getClientRects()\r\n    , offset = rect.length\r\n      ? Math.abs(hh - (rect[0].y + rect[0].height/2))\r\n      : null\r\n    return { el: el, offset: offset }\r\n  })\r\n  .filter(a => a.offset !== null)\r\n  .sort((e1, e2) => e1.offset < e2.offset ? -1 : 1)\r\n  return closest.length ? closest[0].el : false\r\n}\r\n\r\nfunction insert(text, breakBefore=true, breakAfter=true) {\r\n  let form = lastActiveForm || document.querySelector('#postform')\r\n  , textarea = form && form.querySelector('textarea')\r\n  if(textarea) {\r\n    if (form.classList.contains('collapsed')) {\r\n      toggleFormCollapse(form, false/* uncollapse*/, false/* no focus*/)\r\n    }\r\n    let start = textarea.selectionStart\r\n    , end = textarea.selectionEnd\r\n    , pre = textarea.value.substr(0,start)\r\n    , post = textarea.value.substr(end)\r\n    , charBefore = pre[pre.length-1]\r\n    , charAfter = post[0]\r\n    if (breakBefore && text[0] !== \"\\n\" && charBefore && charBefore !== \"\\n\")\r\n      text = \"\\n\"+text\r\n    if (breakAfter && text[text.length-1] !== \"\\n\" && charAfter !== \"\\n\")\r\n      text += \"\\n\"\r\n    let selectionRange = start + text.length\r\n    textarea.value = pre + text + post\r\n    textarea.setSelectionRange(selectionRange, selectionRange)\r\n    textarea.focus()\r\n  }\r\n}\r\n\r\nfunction markup($target, start, end, istart, iend) {\r\n  let element = $target.find('textarea').get(0);\r\n  if (element.selectionStart || element.selectionStart == '0') {\r\n    element.focus();\r\n    let startPos = element.selectionStart\r\n    , endPos = element.selectionEnd\r\n    , selected = element.value.substring(startPos, endPos);\r\n    if(selected.indexOf('\\n') === (-1) && typeof istart !== \"undefined\" && typeof iend !== \"undefined\") {\r\n      start = istart; end = iend;\r\n    }\r\n    element.value = element.value.substring(0, startPos) + start + element.value.substring(startPos, endPos) + end + element.value.substring(endPos, element.value.length);\r\n  } else {\r\n    element.value += start + end;\r\n  }\r\n}\r\n\r\nfunction bullets($target, bullet, istart, iend) {\r\n  let $area = $target.find('textarea')\r\n  , element = $area[0]\r\n  , startPos = element.selectionStart\r\n  , endPos = element.selectionEnd\r\n  , selected = $area.val().substring(startPos, endPos)\r\n  if(!~selected.indexOf('\\n') && typeof istart !== \"undefined\" && typeof iend !== \"undefined\") {\r\n    element.value = element.value.substring(0, startPos) + istart + element.value.substring(startPos, endPos) + iend + element.value.substring(endPos, element.value.length);\r\n  }\r\n  else {\r\n    selected = $area.val().substring(startPos, endPos).split('\\n');\r\n    var newtxt = \"\";\r\n    for(var i=0; i<selected.length; i++) {\r\n      newtxt += (bullet + selected[i]);\r\n      if(i < (selected.length - 1)) newtxt += '\\n';\r\n    }\r\n    $area.val(\r\n      $area.val().substring(0, startPos)\r\n      + newtxt +\r\n      $area.val().substring(endPos)\r\n    );\r\n  }\r\n}\r\n\r\nfunction quotes($target, type) {\r\n  let $area = $target.find('textarea')\r\n  , areaVal = $area.val()\r\n  , element = $area[0]\r\n  , startPos = element.selectionStart\r\n  , endPos = element.selectionEnd\r\n  , selected = areaVal.substring(startPos, endPos)\r\n  , newtxt = \"\"\r\n  if (~selected.indexOf('\\n')) { // multiline quoting\r\n    selected = areaVal.substring(startPos, endPos).split('\\n')\r\n    for(var i=0; i<selected.length; i++) {\r\n      let bullet = (type=='g') ? '>'\r\n        : (type=='r') ? '<'\r\n          : (i%2) ? '<'\r\n            : '>'\r\n      newtxt += (bullet + ' ' + selected[i])\r\n      if(i < (selected.length - 1)) newtxt += '\\n'\r\n    }\r\n  }\r\n  else { // inline quoting\r\n    let tag = type=='r' ? 'rq' : 'q'\r\n    newtxt = `[${tag}]${selected}[/${tag}]`\r\n  }\r\n  element.value =\r\n    areaVal.substring(0, startPos)\r\n    + newtxt +\r\n    areaVal.substring(endPos)\r\n}\r\n\r\nfunction quote(b, a) {\r\n  var v = eval(\"document.\" + a + \".message\");\r\n  v.value += \">>\" + b + \"\\n\";\r\n  v.focus();\r\n}\r\n\r\nfunction checkhighlight() {\r\n  var match;\r\n  if(match=/#i([0-9]+)/.exec(document.location.toString()))\r\n    if(!$('#postform textarea').val())\r\n      insert(\">>\"+match[1]);\r\n  if(match=/#([0-9]+)/.exec(document.location.toString()))\r\n    highlight(match[1]);\r\n}\r\n\r\nfunction highlight(id, offTimeout=5000) {\r\n  $('.highlight').removeClass('highlight');\r\n  if (!(''+id).split('-')[1])\r\n    id += '-'+this_board_dir\r\n  let $post = $(`#postbody${id}`).parents('.reply')\r\n  if (!$post.length) return false;\r\n  let post = $post[0]\r\n  $post.addClass('highlight');\r\n  if (offTimeout) {\r\n    setTimeout(() => $post.removeClass('highlight'), offTimeout)\r\n  }\r\n  // Scroll to post\r\n  let bcr = post.getBoundingClientRect()\r\n  , docHeight = document.documentElement.clientHeight\r\n  if (bcr.bottom > docHeight || bcr.top < 0) {\r\n    let postX = bcr.top + document.documentElement.scrollTop\r\n    , spaceAround = docHeight - bcr.height\r\n    window.scrollTo(0, postX - (spaceAround ? Math.ceil(spaceAround/2) : 0))\r\n  }\r\n  return true\r\n}\r\n\r\nconst password_length = 20;\r\n\r\nfunction get_password(name) {\r\n  let pass = getCookie(name);\r\n  if(pass) return pass;\r\n  pass = randomString(password_length)\r\n  Cookie(name, pass, 365);\r\n  return(pass);\r\n}\r\n\r\nfunction togglePassword() {\r\n  var passwordbox_html = $(\"#passwordbox\").html().toLowerCase();\r\n  var newhtml = '<td></td><td></td>';\r\n  if (passwordbox_html == newhtml) {\r\n    newhtml = '<td class=\"postblock\">Mod</td><td><input type=\"text\" name=\"modpassword\" size=\"28\" maxlength=\"75\">&nbsp;<acronym title=\"Display staff status (Mod/Admin)\">D</acronym>:&nbsp;<input type=\"checkbox\" name=\"displaystaffstatus\" checked>&nbsp;<acronym title=\"Lock\">L</acronym>:&nbsp;<input type=\"checkbox\" name=\"lockonpost\">&nbsp;&nbsp;<acronym title=\"Sticky\">S</acronym>:&nbsp;<input type=\"checkbox\" name=\"stickyonpost\">&nbsp;&nbsp;<acronym title=\"Raw HTML\">RH</acronym>:&nbsp;<input type=\"checkbox\" name=\"rawhtml\">&nbsp;&nbsp;<acronym title=\"Name\">N</acronym>:&nbsp;<input type=\"checkbox\" name=\"usestaffname\"></td>';\r\n  }\r\n  $(\"#passwordbox\").html(newhtml).show();\r\n  return false;\r\n}\r\n\r\n// proxied functions\r\nfunction getCookie(name)                {   return Cookie(name)                     }\r\nfunction set_cookie(name,value,days)    {   return Cookie(name,value,days)          }\r\n\r\nvar Styles = {\r\n  all: [], titles: [],\r\n  init: function() {\r\n    _.each(document.getElementsByTagName(\"link\"), function(link) {\r\n      if(link.getAttribute(\"rel\").indexOf(\"style\")!=-1 && link.getAttribute(\"title\")) {\r\n        this.all.push(link);\r\n        this.titles.push(link.getAttribute(\"title\"));\r\n        if(link.getAttribute(\"rel\").indexOf(\"alternate\")===-1) {\r\n          this._default = link.getAttribute(\"title\");\r\n        }\r\n        if(link.hasAttribute(\"data-custom\")) {\r\n          this.custom = link.getAttribute(\"title\");\r\n        }\r\n      }\r\n    }, this);\r\n    this.current = this._default;\r\n    var customBypass = getCookie('bypasscustom');\r\n    this.customBypass = (customBypass.length && typeof this_board_dir !== 'undefined' && in_array(this_board_dir, customBypass.split('|'))) ? true : false;\r\n    this.initiated = true\r\n  },\r\n  decide: function() {\r\n    this.init();\r\n    var testingCSS = LSfetchJSON('testing-css')\r\n    if(testingCSS) {\r\n      let title = this.addStyle(testingCSS.url, testingCSS.title)\r\n      this.setStyle(title)\r\n      var $clink = $('<a href=\"#\">  '+title+'.css</a>')\r\n      $clink.click(function(ev) {\r\n        ev.preventDefault()\r\n        Styles.quitTest()\r\n        $(this).parent().slideUp()\r\n      })\r\n      this.$cancelLink = $('<div style=\"font-weight: bold\"></div>').append($clink)\r\n      return\r\n    }\r\n    if(this.hasOwnProperty('custom') && !this.customBypass)\r\n      return this.setCustom();\r\n    var sc = getCookie(style_cookie);\r\n    if(sc && in_array(sc, this.titles))\r\n      this.setStyle(sc);\r\n    else {\r\n      this.setDefault();\r\n      set_cookie(\"kustyle_site\",this._default,365);\r\n      set_cookie(\"kustyle\",this._default,365);\r\n    }\r\n  },\r\n  change: function(stylename) {\r\n    if(!in_array(stylename, this.titles) || this.current === stylename) return;\r\n    this.setStyle(stylename);\r\n    if(this.hasOwnProperty('custom') && this.custom === stylename) {\r\n      this.removeBypass();\r\n    }\r\n    else {\r\n      if(this.hasOwnProperty('custom'))\r\n        this.addBypass();\r\n      set_cookie(\"kustyle_site\",stylename,365);\r\n      set_cookie(\"kustyle\",stylename,365);\r\n    }\r\n  },\r\n  removeBypass: function() {\r\n    if(!this.customBypass || typeof this_board_dir === 'undefined') return;\r\n    this.customBypass = false;\r\n    var oldcookie = getCookie('bypasscustom').split('|'), newcookie = [];\r\n    _.each(oldcookie, function(brd) {\r\n      if(brd !== this_board_dir) newcookie.push(brd);\r\n    });\r\n    newcookie = newcookie.length ? newcookie.join('|') : '';\r\n    set_cookie(\"bypasscustom\",newcookie,365);\r\n  },\r\n  addBypass: function() {\r\n    if(this.customBypass || typeof this_board_dir === 'undefined') return;\r\n    this.customBypass = true;\r\n    var cookie = getCookie('bypasscustom').split('|');\r\n    if(!in_array(this_board_dir, cookie)) {\r\n      cookie.push(this_board_dir);\r\n      set_cookie(\"bypasscustom\",cookie.join('|'),365);\r\n    }\r\n  },\r\n  setDefault: function() {\r\n    if(this.hasOwnProperty('_default') && this.current !== this._default)\r\n      this.setStyle(this._default);\r\n  },\r\n  setCustom: function() {\r\n    if(this.hasOwnProperty('custom'))\r\n      this.setStyle(this.custom);\r\n  },\r\n  setStyle: function(stylename) {\r\n    if(!in_array(stylename, this.titles)) return;\r\n    if (scrollAnchor && scrollAnchor.save)\r\n      scrollAnchor.save('setstyle', '.postnode')\r\n    _.each(this.all, function(sheet) {\r\n      sheet.disabled=true;    // Hello IE\r\n      if(sheet.getAttribute(\"title\") === stylename)\r\n        sheet.disabled=false;\r\n    });\r\n    if (scrollAnchor && scrollAnchor.restore)\r\n      scrollAnchor.restore('setstyle')\r\n    this.current = stylename;\r\n  },\r\n  onTest: null,\r\n  addStyle: function(url, title='') {\r\n    if (! title) {\r\n      let m = /(?:.+\\/)?(.+)\\.css/i.exec(url)\r\n      if(!m) return;\r\n      title = m[1]\r\n    }\r\n    title = _.capitalize(_.escape(title))\r\n    if(!in_array(title, this.titles)) {\r\n      var $link = $('<link rel=\"stylesheet\" type=\"text/css\" href=\"'+url+'\" title=\"'+title+'\" disabled>')\r\n      $('head').append($link);\r\n      this.titles.push(title)\r\n      this.all.push($link[0])\r\n    }\r\n    return title\r\n  },\r\n  testStyle: function(url, title) {\r\n    title = this.addStyle(url, title)\r\n    this.setStyle(title)\r\n    this.onTest = {\r\n      url: url,\r\n      title: title\r\n    }\r\n    pups.succ(`  ${title}.\r\n      <div class=\"styletest-form\">\r\n        <button onclick=\"Styles.confirmLongTermTest()\">OK</button>\r\n        <button onclick=\"Styles.quitTest()\">${_l.cancel}</button>\r\n      </div>`, {time: 0, save: true})\r\n  },\r\n  confirmLongTermTest: function() {\r\n    if(this.onTest)\r\n      localStorage.setItem('testing-css', JSON.stringify(this.onTest))\r\n  },\r\n  quitTest: function() {\r\n    localStorage.removeItem('testing-css')\r\n    this.decide()\r\n  }\r\n}\r\nif(style_cookie) Styles.decide();\r\n\r\nvar HiddenItems = {\r\n  init: function() {\r\n    this.hideCompletely = localStorage['hideCompletely.'+this_board_dir]=='true'\r\n    ;['posts', 'threads'].forEach(kind => {\r\n      let ls = localStorage[`hidden${_.capitalize(kind)}`]\r\n      , list = ls ? ls.split(',').filter(a => a) : []\r\n      this.lists[kind] = list\r\n    })\r\n    document.write(`<style id=\"injector:hideitems\">${this.buildCSS()}</style>`)\r\n  },\r\n  buildCSS: function() {\r\n    let unhide = [], hide = [], hiddenPosts = []\r\n    ;['posts', 'threads'].forEach(kind => {\r\n      this.lists[kind].forEach(id => {\r\n        if (kind==\"posts\") {\r\n          let node = `#postnode${id}`\r\n          hiddenPosts.push(node)\r\n          if (this.hideCompletely)\r\n            hide.push(node)\r\n          else\r\n            hide.push(`#postbody${id}`)\r\n        }\r\n        else if(ispage) {\r\n          hide.push(`#thread${id}`)\r\n          if (this.hideCompletely) {\r\n            hide.push(`#unhidethread${id}`)\r\n            hide.push(`#thread${id} + br`)\r\n            hide.push(`#thread${id} + br + hr`)\r\n          }\r\n          else {\r\n            unhide.push(`#unhidethread${id}`)\r\n          }\r\n        }\r\n      })\r\n    })\r\n    if (hiddenPosts.length) {\r\n      onReady.pushTask(() => {\r\n        $(hiddenPosts.join(',')).addClass('post-hidden')\r\n      })\r\n    }\r\n    return (hide.length ? hide.join(',') + '{ display: none }' : '') +\r\n      (unhide.length ? unhide.join(',') + '{ display: inline-block }' : '')\r\n  },\r\n  updateCSS: function() {\r\n    injector.inject('hideitems', this.buildCSS())\r\n  },\r\n  hideCompletely: false,\r\n  lists: {},\r\n  isHidden: function(kind, id) {\r\n    return this.lists[kind+'s'].indexOf(id.toString()) != -1 \r\n  },\r\n  hideItem: function(kind, id) {\r\n    if (this.isHidden(kind, id)) return;\r\n    this.lists[kind+'s'].push(id)\r\n    this.saveList(kind)\r\n  },\r\n  unhideItem: function(kind, id) {\r\n    if (!this.isHidden(kind, id)) return;\r\n    this.lists[kind+'s'] = this.lists[kind+'s'].filter(a => a!=id)\r\n    this.saveList(kind)\r\n  },\r\n  hideThread: function(id, inCatalog=false) {\r\n    this.hideItem('thread', id)\r\n    $('#unhidethread' + id).slideDown()\r\n    let $thread = $('#thread' + id)\r\n    , $form = $thread.find('.qrf-floating')\r\n    $thread.slideUp().promise().done(updateActiveForm)\r\n    if ($form.length)\r\n      toggleFormFloating($form[0], false /*  float=off*/, false /*  no focus*/)\r\n  },\r\n  unhideThread: function(id, inCatalog=false) {\r\n    this.unhideItem('thread', id)\r\n    $('#thread' + id).slideDown()\r\n    $('#unhidethread' + id).slideUp()\r\n  },\r\n  hidePost: function(id) {\r\n    this.hideItem('post', id)\r\n    $('#postbody' + id).slideUp('fast')\r\n  },\r\n  unhidePost: function(id) {\r\n    this.unhideItem('post', id)\r\n    $('#postbody' + id).slideDown('fast')\r\n  },\r\n  togglePost: function(id) {\r\n    let $body = $('#postbody' + id)\r\n    , $btn = $body.parent().find('.hide-post-btn')\r\n    if ($body.css('display') == 'none') {\r\n      this.unhidePost(id)\r\n      $btn.attr('title', _l.hidePost)\r\n      .find('use').attr('xlink:href', '#i-hide')\r\n    }\r\n    else {\r\n      this.hidePost(id)\r\n      $btn.attr('title', _l.unhidePost)\r\n      .find('use').attr('xlink:href', '#i-unhide')\r\n    }\r\n  },\r\n  saveList: function(kind) {\r\n    localStorage[`hidden${_.capitalize(kind)}s`] = this.lists[kind+'s'].join(',')\r\n  }\r\n}\r\nHiddenItems.init()\r\n\r\nfunction expandthread(threadid, board, ev) {\r\n  ev.preventDefault()\r\n  let $thread = $(`#thread${threadid}-${board}`)\r\n  if ($thread.length) {\r\n    let expandFrom = + $thread.find('.postnode.op').data('id')\r\n    , expandTo = + $thread.find('.postnode:not(.op):first').data('id')\r\n    , $omitted = $thread.find('.omittedposts')\r\n    $omitted.find('a').hide()\r\n    if (! $omitted.find('span').length) {\r\n      $(`<div class=\"spinner\"></div><span>${_l.loading}...</span>`).prependTo($omitted)\r\n    }\r\n    else {\r\n      $omitted.find('.spinner').show()\r\n    }\r\n    HTMLoader.getThread(board, +threadid, [expandFrom, expandTo], (err, posts) => {\r\n      if (posts) {\r\n        $thread.find('.omittedposts').replaceWith(posts)\r\n        replyMap.showReplies()\r\n      }\r\n      else {\r\n        setTimeout(() => $omitted.find('.spinner').hide(), 1000)\r\n        $omitted.find('span').text(_l.oops + (err !== false ? ` (${err})` : ''))\r\n        $omitted.find('a').text(_l.tryAgain).show()\r\n      }\r\n    })\r\n  }\r\n  return false;\r\n}\r\n\r\nvar newposts = {\r\n  busy: false,\r\n  get: function(options={}) {\r\n    options = _.defaults(options, {\r\n      threadid: null,\r\n      expectedPost: null,\r\n      silent: false,\r\n      onError: err => pups.err(`Error geting new posts (${err})`),\r\n      onSuccess: null,\r\n      timestamp: null\r\n    })\r\n    if (!options.threadid) {\r\n      if (ispage)\r\n        return options.onError()\r\n      options.threadid = +$('input[name=replythread]').val()\r\n    }\r\n    this.pushTask(options)\r\n    return false\r\n  },\r\n  execute: function(task) {\r\n    this.busy = true\r\n    let threadid = ''+task.threadid\r\n    , expectedPost = task.expectedPost\r\n    , onError = err => {\r\n      this.next()\r\n      task.onError(err)\r\n    }\r\n    if (!threadid.split('-')[1])\r\n      threadid += '-'+this_board_dir\r\n    let replies_container, $newposts_get\r\n    if (!ispage) {\r\n      $newposts_get = $('#newposts_get')\r\n      $newposts_get.removeClass('upd-counting').addClass('upd-updating')\r\n      replies_container = document.querySelector('.replies')\r\n    }\r\n    else {\r\n      replies_container = document.querySelector(`#thread${threadid} .replies`)\r\n      if (!replies_container) return onError('No replies container!');\r\n    }\r\n    // If post is already there, skip the entire thing\r\n    if (expectedPost && highlight(expectedPost)) {\r\n      $newposts_get.removeClass('upd-updating')\r\n      this.next()\r\n      return\r\n    }\r\n    let $lastQrl = $(`.qrl[data-parent=\"${threadid}\"]`).last()\r\n    , lastpost = ($lastQrl.data('postnum') || $lastQrl.data('parent'))+''\r\n    if (! lastpost) return onError();\r\n    let idb = threadid.split('-')\r\n    , id = idb[0], bd = idb[1]\r\n    HTMLoader.getThread(bd, id, [+(lastpost.split('-')[0]),Infinity], (err, posts) => {\r\n      if (!ispage) {\r\n        $newposts_get.removeClass('upd-updating')\r\n      }\r\n      if (posts) {\r\n        replies_container.insertAdjacentHTML('beforeend', posts)\r\n        replyMap.showReplies()\r\n        unreadCounter.refreshTimestamp(task.timestamp || null, bd)\r\n        if (task.onSuccess)\r\n          task.onSuccess()\r\n      }\r\n      else {\r\n        if (!task.silent) {\r\n          pups.info(posts === '' ? _l.noNewPosts : _l.oops + (err !== false ? ` (${err})` : ''), {time: 1})\r\n        }\r\n      }\r\n      if (expectedPost && !highlight(expectedPost)) {\r\n        return onError('No target reply!');\r\n      }\r\n      this.next()\r\n    }, false, true)\r\n  },\r\n  pushTask: function(task) {\r\n    if (this.busy)\r\n      this.stack.push(task)\r\n    else\r\n      this.execute(task)\r\n  },\r\n  next: function() {\r\n    let next = this.stack.shift()\r\n    if (next)\r\n      this.execute(next)\r\n    else\r\n      this.busy = false\r\n  }, \r\n  stack: []\r\n}\r\n\r\n// Hiding animation\r\nfunction flyTo(el, dest) {\r\n  let destBox = dest.getBoundingClientRect()\r\n  , destX = destBox.x + (destBox.width / 2)\r\n  , destY = destBox.y + (destBox.height / 2)\r\n  , elBox = el.getBoundingClientRect()\r\n  el.style.transformOrigin = `${(destX - elBox.x) + 'px'} ${(destY - elBox.y) + 'px'}`\r\n  el.classList.add('fly-to-zero')\r\n  return new Promise((resolve, reject) => {\r\n    setTimeout(() => {\r\n      el.classList.remove('fly-to-zero')\r\n      el.style.transformOrigin = null\r\n      resolve(el)\r\n    }, (+getComputedStyle(el).transition.match(/transform ([0-9\\.]+)/)[1] * 1000) + 100 )\r\n  })\r\n}\r\n\r\nfunction toggleFormCollapse(form, collapse = !form.classList.contains('collapsed'), focus = !collapse) {\r\n  let oldBox = form.getBoundingClientRect()\r\n  , offRight = oldBox.right - (window.innerWidth - 32)\r\n  form.classList.toggle('collapsed', collapse)\r\n  let box = form.getBoundingClientRect()\r\n  , newWidth = box.width\r\n  form.style.left = \r\n    box.left \r\n    + (oldBox.width - newWidth) \r\n    - (offRight > 0 ? offRight : 0) \r\n    + 'px'\r\n  form.querySelector('.collapser').classList.toggle('collapsed', collapse)\r\n  if (focus) {\r\n    form.querySelector('textarea').focus()\r\n  }\r\n}\r\n\r\nfunction toggleFormRow(form, btn) {\r\n  let id = btn.dataset.toggle\r\n  , row = form.querySelector(`.${btn.dataset.toggle}-row`)\r\n  if (! row) return;\r\n  let show = row.classList.toggle('row-shown')\r\n  btn.querySelector('svg').classList.toggle('pressed', show)\r\n  let rem = show ? 0 : isRowEmpty(row, id)\r\n  btn.classList.toggle('button-with-reminder', rem)\r\n  if (rem) {\r\n    if (! btn._originalTitle)\r\n      btn._originalTitle = btn.title\r\n    btn.title = `${btn._originalTitle} (${_l.notEmpty})`\r\n  }\r\n  else if (btn._originalTitle)\r\n    btn.title = btn._originalTitle\r\n  if (show) { // focus on field\r\n    let focal = null\r\n    if (id == 'subject-send') {\r\n      let i = form.querySelector('input[name=subject]')\r\n      if (!i.value)\r\n        focal = i\r\n    }\r\n    if (id == 'name') {\r\n      let i = form.querySelector('input[name=name]')\r\n      if (!i.value && !i.disabled)\r\n        focal = i\r\n    }\r\n    if (id == 'embed') {\r\n      let inputs = [].filter.call(form.querySelectorAll('input[type=text][name^=embed]'), \r\n        el => el.getClientRects().length && !el.value)\r\n      if (inputs.length)\r\n        focal = inputs[0]\r\n    }\r\n    if (focal)\r\n      focal.focus()\r\n  }\r\n}\r\n\r\nfunction isRowEmpty(row, id) {\r\n  return !!(\r\n    (id == 'name' &&\r\n      row.querySelector('input[name=name]').value != ''\r\n      &&\r\n      !row.querySelector('input[name=disable_name]').checked\r\n    ) ||\r\n    (id == 'subject-send' &&\r\n      row.querySelector('input[name=subject]').value != ''\r\n    ) ||\r\n    (id == 'embed' &&\r\n      [].find.call(row.querySelectorAll('input[type=text]'), i => i.value.trim())\r\n    ) ||\r\n    (id == 'ttl' &&\r\n      row.querySelector('input[name=ttl-enable]').checked\r\n    )\r\n  )\r\n}\r\n\r\nfunction updateReminders(form) {\r\n  ['name', 'subject-send', 'embed', 'ttl'].forEach(id => {\r\n    let row = form.querySelector(`.${id}-row:not(.row-shown)`)\r\n    , btn = row && form.querySelector(`.simplified-toggle[data-toggle=\"${id}\"]`)\r\n    if (btn)\r\n      btn.classList.toggle('button-with-reminder', isRowEmpty(row, id))\r\n  })\r\n}\r\n\r\nfunction toggleFormFloating(form, float, focus=true) {\r\n  let pinner = form.querySelector('.pinner')\r\n  pinner.classList.toggle('pinned', !float)\r\n  pinner.classList.toggle('unpinned', float)\r\n  if (float) { // Make the form floating\r\n    // Pin other forms\r\n    scrollAnchor.save('toggleFormFloating', form.getParentPost())\r\n    document.querySelectorAll('.qrf-floating').forEach(f => toggleFormFloating(f, false))\r\n    scrollAnchor.restore('toggleFormFloating')\r\n    .then(() => { // When all scrolling is settled\r\n      let box = form.getBoundingClientRect()\r\n      form.classList.add('qrf-floating')\r\n      form.classList.remove('qrf-builtin', 'qrf-builtin-back')\r\n      form.style.top = box.top + 'px'\r\n      form.style.left = box.left + 'px'\r\n      $(form).drags()\r\n      .find('input, textarea, select, label, .fe-sort-wrapper, button, .b-icon').mousedown(function(e) {\r\n        e.stopPropagation()\r\n      })\r\n    })\r\n  }\r\n  else { // Build the form back in\r\n    form.classList.remove('qrf-floating', 'collapsed')\r\n    form.querySelector('.collapser').classList.remove('collapsed')\r\n    form.classList.add('qrf-builtin', 'qrf-builtin-back')\r\n    $(form).dragsOff()\r\n    ;['top', 'left', 'zIndex'].forEach(prop => form.style[prop] = null)\r\n  }\r\n  if (focus)\r\n    form.querySelector('textarea').focus()\r\n}\r\n\r\nfunction hidePostForm(form) {\r\n  form.classList.add('hidden')\r\n  toggleFormFloating(form, false)\r\n  toggleFormCollapse(form, false)\r\n  setTimeout(() => {\r\n    form.classList.remove('qrf-builtin-back')\r\n  }, 200)\r\n  if (form._preview) {\r\n    let pinner = form._preview.querySelector('.pinner')\r\n    if (pinner) {\r\n      pinner.classList.remove('pinned')\r\n      pinner.classList.add('unpinned')\r\n    }\r\n    form._preview._pinned = false\r\n  }\r\n  updateActiveForm()\r\n}\r\n\r\nfunction toggleFormSimplify(form, simplify) {\r\n  let simplified = form.classList.toggle('postform-simplified', simplify)\r\n  if (simplified)\r\n    updateReminders(form)\r\n}\r\n\r\nfunction clonePostForm(anchorID, preview, boardName=false) {\r\n  return new Promise((resolve, reject) => {\r\n    HTMLoader.getPostbox(boardName).then(oldForm => {\r\n      if (Captcha.enabled)\r\n        Captcha.state = 'init' // Destroy old captcha because it will be inevitably reloaded at form cloning\r\n      let newForm = oldForm.cloneNode(true)\r\n      newForm.id = anchorID + '_qrf'\r\n      newForm.dataset.anchorID = anchorID\r\n      newForm.classList.remove('main-reply-form')\r\n      newForm.querySelector('.simplified-send-row .primary span').innerText = _l.reply\r\n      newForm.querySelector('input[name=\"postpassword\"]').value = get_password('postpassword')\r\n      newForm.querySelector('input.primary').value = _l.reply\r\n      newForm.querySelector('.noko-row').remove()\r\n      let blotter = newForm.querySelector('.blotter-row')\r\n      if (preview)\r\n        newForm._preview = preview\r\n      blotter.insertAdjacentHTML('afterend', `\r\n        <span class=\"extrabtns simplified-extras\">\r\n          ${newForm.querySelector('.name-row') ? `\r\n            <a href=\"#\" class=\"simplified-toggle\" data-toggle=\"name\" title=\"${_l.showName}\">\r\n              <svg class=\"icon b-icon\"><use xlink:href=\"#i-name\"></use></svg>\r\n            </a>\r\n          ` : ''}\r\n          <a href=\"#\" class=\"simplified-toggle\" data-toggle=\"subject-send\" title=\"${_l.showSubject}\">\r\n            <svg class=\"icon b-icon\"><use xlink:href=\"#i-subject\"></use></svg>\r\n          </a>\r\n          <a href=\"#\" class=\"s-markup\" data-toggle=\"password\" title=\"${_l.showMarkup}\">\r\n            <svg class=\"icon b-icon\"><use xlink:href=\"#i-markup\"></use></svg>\r\n          </a>\r\n          ${newForm.querySelector('.embed-row') ? `\r\n            <a href=\"#\" class=\"simplified-toggle\" data-toggle=\"embed\" title=\"${_l.showEmbeds}\">\r\n              <svg class=\"icon b-icon\"><use xlink:href=\"#i-embed\"></use></svg>\r\n            </a>\r\n          ` : ''}\r\n          <a href=\"#\" class=\"simplified-toggle\" data-toggle=\"password\" title=\"${_l.showPassword}\">\r\n            <svg class=\"icon b-icon\"><use xlink:href=\"#i-password\"></use></svg>\r\n          </a>\r\n          ${newForm.querySelector('.ttl-row') ? `\r\n            <a href=\"#\" class=\"simplified-toggle\" data-toggle=\"ttl\" title=\"${_l.showTTL}\">\r\n              <svg class=\"icon b-icon\"><use xlink:href=\"#i-timer\"></use></svg>\r\n            </a>\r\n          ` : ''}\r\n        </span>`)\r\n      // Name reminder\r\n      updateReminders(newForm)\r\n      // Enabling extra inputs in simplified form\r\n      newForm.querySelectorAll('.simplified-toggle').forEach(a => {\r\n        a.onclick = ev => {\r\n          ev.preventDefault()\r\n          toggleFormRow(newForm, a)\r\n        }\r\n      })\r\n      newForm.querySelector('.s-markup').onclick = function(ev) {\r\n        ev.preventDefault()\r\n        this.querySelector('.icon').classList.toggle('pressed')\r\n        newForm.querySelector('.message-row').classList.toggle('markup-enabled')\r\n      }\r\n      blotter.remove()\r\n      // Rename label[for]s and corresponding inputs\r\n      let add = '_'+_.uniqueId()\r\n      // newForm.id = 'postform'+add\r\n      newForm.querySelectorAll('label').forEach(l => {\r\n        let id = l.getAttribute('for')\r\n        , newid = id + add\r\n        , input = newForm.querySelector('#'+id)\r\n        if (input)\r\n          input.id = newid\r\n        l.setAttribute('for', newid)\r\n      })\r\n      newForm.classList.add('quick-reply-form') // New general class to tell qr form apart from the main form\r\n      newForm.classList.add('postform-simplified')\r\n      // Clear fields\r\n      resetForm(newForm, true /*  isClone */)\r\n      // Init rich file input\r\n      richFileInput.initForm(newForm)\r\n      // Add extra buttons\r\n      newForm.insertAdjacentHTML('beforeend', `\r\n        <span class=\"extrabtns postboxcontrol\">\r\n          <svg class=\"icon form-handle-icon\"><use xlink:href=\"#i-handle\"></use></svg>\r\n          <a href=\"#\" title=\"${_l.classicSimplifiedForm}\" class=\"simplify-qr-form\">\r\n            <svg class=\"icon b-icon\">\r\n              <use class=\"use-simplify\" xlink:href=\"#i-simplify\"></use>\r\n              <use class=\"use-complicate\" xlink:href=\"#i-complicate\"></use>\r\n            </svg>\r\n          </a>\r\n          <a href=\"#\" title=\"${_l.collapseExpand}\" class=\"collapse-qr-form collapser\">\r\n            <svg class=\"icon b-icon\">\r\n              <use class=\"use-collapse\" xlink:href=\"#i-collapse\"></use>\r\n              <use class=\"use-uncollapse\" xlink:href=\"#i-uncollapse\"></use>\r\n            </svg>\r\n          </a>\r\n          <a href=\"#\" class=\"pinner\" title=\"${_l.pinUnpin}\">\r\n            <svg class=\"icon b-icon\">\r\n              <use class=\"use-pin\" xlink:href=\"#i-float\"></use>\r\n              <use class=\"use-unpin\" xlink:href=\"#i-unfloat\"></use>\r\n            </svg>\r\n          </a>\r\n          &nbsp;\r\n          <a href=\"#\" title=\"${_l.hideForm}\" class=\"hide-qr-form\">\r\n            <svg class=\"icon b-icon\"><use xlink:href=\"#i-x\"></use></svg>\r\n          </a>\r\n        </span>`)\r\n      // Form button actions\r\n      newForm.getParentPost = () => {\r\n        let maybePost = newForm._findPrevious('*:not(.i0svcel)')\r\n        return maybePost.matches('.postnode') ? maybePost : null\r\n      }\r\n      newForm.querySelector('.hide-qr-form').onclick = ev => {\r\n        ev.preventDefault()\r\n        let skip = false\r\n        if (newForm.classList.contains('qrf-floating')) {\r\n          let anchor = newForm.getParentPost()\r\n          if (anchor) {\r\n            flyTo(newForm, anchor.querySelector('a.qrl .b-icon')).then(hidePostForm)\r\n            skip = true\r\n          }\r\n        }\r\n        if (!skip) {\r\n          hidePostForm(newForm)\r\n        }\r\n      }\r\n      newForm.querySelector('.simplify-qr-form').onclick = ev => {\r\n        ev.preventDefault()\r\n        toggleFormSimplify(newForm)\r\n      }\r\n      newForm.querySelector('.pinner').onclick = function(ev) {\r\n        ev.preventDefault()\r\n        let pinned = newForm.classList.contains('qrf-builtin')\r\n        toggleFormFloating(newForm, pinned)\r\n      }\r\n      newForm.querySelector('.collapse-qr-form').onclick = ev => {\r\n        ev.preventDefault()\r\n        toggleFormCollapse(newForm)\r\n      }\r\n      // Prevent dragging of links\r\n      newForm.querySelectorAll('a').forEach(a => {\r\n        a.ondragstart = ev => false\r\n        a.ondrop = ev => false\r\n      })\r\n      // Extra hooks for the new form\r\n      initForm(newForm)\r\n\r\n      resolve(newForm)\r\n    })\r\n  })\r\n}\r\n\r\nfunction quickreply() {\r\n  let $this = $(this)\r\n  , threadID = $this.data('parent')\r\n  , postID = $(this).data('postnum') || threadID.split('-')[0]\r\n  , $post = $this.parents('.postnode')\r\n  , boardName = $post.data('board')\r\n  , fromExternalBoard = (!is_overboard && boardName != this_board_dir)\r\n  , post = $post[0]\r\n  , $preview = $post.parents('.reflinkpreview')\r\n  , isPreview = !!$preview\r\n  , needInsert = true\r\n  , form = post._findNext('*:not(.i0svcel)')\r\n  , formExists = form && form.getAttribute('name') == 'postform'\r\n  , formHidden = formExists && form.classList.contains('hidden')\r\n  , formFloating = formExists && form.classList.contains('qrf-floating')\r\n  , isOpen = true\r\n  , preview = post._findParent('.reflinkpreview')\r\n  , quotation = needInsert ? getPostQuotation(post.querySelector('.postbody')) : ''\r\n  \r\n  if (formExists) {\r\n    if (formFloating) {\r\n      toggleFormCollapse(form, false)\r\n      toggleFormFloating(form, false)\r\n    }\r\n    else {\r\n      if (!formHidden) {\r\n        hidePostForm(form)\r\n        formHidden = true\r\n      }\r\n      else {\r\n        form.classList.remove('hidden')\r\n      }\r\n      formHidden = !formHidden\r\n    }\r\n    needInsert = false\r\n  }\r\n  else {\r\n    $this.addClass('spin-around')\r\n    clonePostForm(post.id || post.parentElement.id, preview, (is_overboard ? boardName : false)).then(form => {\r\n      $this.removeClass('spin-around')\r\n      form.classList.add('qrf-builtin')\r\n      form.querySelector('.pinner').classList.toggle('pinned')\r\n      form.querySelector('input[name=replythread]').value = threadID\r\n      post.insertAdjacentElement('afterend', form)\r\n      document.querySelectorAll('.qrf-floating:not(.collapsed)')\r\n      .forEach(existingForm => toggleFormCollapse(existingForm))\r\n      form.querySelector('textarea').focus()\r\n      if (needInsert) {\r\n        insert(`>>${fromExternalBoard ? `/${boardName}/` : ''}${postID}\\n${quotation}`)\r\n      }\r\n      // Pin the post if it is in preview\r\n      if (preview && !preview._pinned) {\r\n        post.querySelector('.pinner').click()\r\n      }\r\n    })\r\n  }\r\n  // post.classList.toggle('reply-with-form-open', isOpen)\r\n  return false\r\n}\r\n\r\nfunction _getSelection() {\r\n  if (! window.getSelection) return null\r\n  let selection = window.getSelection()\r\n  if (selection.type !== \"Range\") return null\r\n  let selectedText = selection.toString()\r\n  if (! selectedText) return null\r\n  return {\r\n    text: selectedText,\r\n    node: selection.anchorNode\r\n  }\r\n}\r\n\r\n// get the selected text within the given element\r\nfunction getLocalSelection(parent) {\r\n  let sel = _getSelection()\r\n  return sel && sel.node._isChildOf(parent)  \r\n    ? sel.text \r\n    : null\r\n}\r\n\r\nfunction getPostQuotation(post) {\r\n  let text = getLocalSelection(post)\r\n  if (!text) return ''\r\n  text = text\r\n    .replace(/^\\s/, '').replace(/\\s$/, '') // remove leading and trailing whitespaces\r\n    .replace(/^>/gm, ' >').replace(/^/gm, '> ') // add quotation marks\r\n  return text/*+'\\n'*/ || ''\r\n}\r\n\r\nfunction popupMessage(content, delay=1000) {\r\n  pups.info(content, {time: delay/1000})\r\n  console.warn('popupMessage() is deprecated. Please use YOBA alerts instead.')\r\n}\r\n\r\nvar Captcha = {\r\n  init: function(forceEnable=false) {\r\n    let captchaImage = document.querySelector('.captchaimage')\r\n    this.enabled = forceEnable || !!captchaImage\r\n    if (!this.enabled) return;\r\n    injector.inject('captcha-rotting',\r\n    `.cw-running .rotting-indicator {\r\n      -webkit-animation-duration: ${captchaTimeout}s;\r\n              animation-duration: ${captchaTimeout}s;\r\n    }\r\n    .cw-running .captchaimage,\r\n    .cw-running .rotten-msg {\r\n      -webkit-animation-delay: ${captchaTimeout}s;\r\n              animation-delay: ${captchaTimeout}s;}`)\r\n    if (captchaImage) {\r\n      this.addImgLoadListener(captchaImage)\r\n    }\r\n  },\r\n  initForm: function(form) {\r\n    let cw = form.querySelector('.captchawrap')\r\n    if (!cw) return;\r\n    cw.onclick = this.onClick.bind(this)\r\n    ;['click', 'focus'].forEach(evt => {\r\n      form.querySelector('input[name=captcha]').addEventListener(evt, this.onFieldClick.bind(this))\r\n    })\r\n    let captchaImage = form.querySelector('.captchaimage')\r\n    if (captchaImage) {\r\n      this.addImgLoadListener(captchaImage)\r\n    }\r\n  },\r\n  addImgLoadListener: function(captchaImage) {\r\n    captchaImage.onload = this.onImageLoad.bind(this)\r\n    ;['animationend', 'webkitAnimationEnd', 'msAnimationEnd'].forEach(evType => {\r\n      captchaImage.addEventListener(evType, this.onAnimationEnd.bind(this))\r\n    })\r\n  },\r\n  _state: 'init',\r\n  get state() {\r\n    return this._state\r\n  },\r\n  set state(s) { // Capthca state machine\r\n    document.querySelectorAll('.captchawrap').forEach(c => {\r\n      if (s == 'init') {\r\n        c.classList.remove('cw-running')\r\n        c.classList.add('cw-initial')\r\n      }\r\n      if (s == 'init' || s == 'load') {\r\n        c.classList.add('captchaimage-invisible')\r\n      }\r\n      if (s == 'load') {\r\n        c.classList.remove('cw-initial', 'cw-running')\r\n        void c.offsetWidth //trigger a reflow\r\n        c.classList.add('cw-running', 'cw-loading')\r\n      }\r\n      else {\r\n        c.classList.remove('cw-loading')\r\n      }\r\n      if (s == 'run') {\r\n        c.classList.remove('captchaimage-invisible')\r\n      }\r\n    })\r\n    if (s !== 'run')\r\n      this.clear()\r\n    this._state = s\r\n  },\r\n  onClick: function(ev) {\r\n    this.refresh(ev.ctrlKey || ev.altKey)\r\n    ev.target._findParent('form').querySelector('input[name=captcha]').focus()\r\n  },\r\n  onFieldClick: function() {\r\n    if (this.state == 'init' || this.state == 'expired')\r\n      this.refresh()\r\n  },\r\n  onImageLoad: function() {\r\n    if (this.state == 'load')\r\n      this.state = 'run'\r\n  },\r\n  onAnimationEnd: function() {\r\n    this.state = 'expired'\r\n  },\r\n  clear: function() {\r\n    document.querySelectorAll('input[name=\"captcha\"]').forEach(i => i.value = '')\r\n  },\r\n  refresh: function(switch_lang=false) {\r\n    let cColor = $('.captchawrap').css('color').match(/([0-9]+(?:\\.[0-9]+)?)/g)\r\n    cColor = (cColor.length >= 3) ? '&color='+cColor.slice(0, 3).join(',') : ''\r\n    let url = ku_boardspath+'/captcha.php?'+Math.random()+cColor+(switch_lang ? '&switch' : '')\r\n    document.querySelectorAll('.captchaimage').forEach(img => img.src = url)\r\n    this.state = 'load'\r\n  }\r\n}\r\n\r\nfunction formatFileSize(bytes) {\r\n  if (bytes < 1000) {\r\n    return `${bytes}B`\r\n  }\r\n  else if (bytes < 1000000) {\r\n    return `${Math.round(bytes/1000)}KB`\r\n  }\r\n  else {\r\n    return `${Math.round(bytes/100000)/10}MB`\r\n  }\r\n}\r\n\r\nconst richFileInput = {\r\n  handleFiles: function(files, form, fromClipboard=false) {\r\n    let maxfiles = +form.dataset.maxfiles\r\n    , slotsLeft = maxfiles - $(form).find('.file-entry').length\r\n    , filesLeft = files.length\r\n    , i = 0\r\n    for (; slotsLeft && filesLeft; i++) {\r\n      let fileAttached = this.handleFile(files[i], form, fromClipboard)\r\n      slotsLeft -= fileAttached\r\n      filesLeft--\r\n    }\r\n    if (slotsLeft <= 0 && filesLeft)\r\n      pups.warn(_l.maxAttNumReached)\r\n  },\r\n  handleFile: function(file, form, fromClipboard=false) {\r\n    let fx = {}\r\n    // Determine the file extension\r\n    let ns = file.name.split('.')\r\n    fx.ext = (ns.length) > 1 ? ns.pop().toLowerCase() : \"\"\r\n    if (fx.ext == 'jpeg') \r\n      fx.ext = 'jpg'\r\n    if (!_.contains(form.dataset.allowedFiletypes.split(','), fx.ext)) {\r\n      pups.err(`${file.name}: ${_l.unsupportedFileType}.`)\r\n      return 0\r\n    }\r\n    fx.fname = ns.join('.')\r\n\r\n    fx.sizeFormatted = formatFileSize(file.size)\r\n    \r\n    if (file.type.indexOf(\"image\") != -1) {\r\n      let reader = new FileReader()\r\n      reader.onload = ev => {\r\n        fx.img = ev.target.result\r\n        this.addFile(file, fx, form, fromClipboard)\r\n      }\r\n      reader.readAsDataURL(file, fx, form)\r\n    }\r\n    else {\r\n      this.addFile(file, fx, form, fromClipboard)\r\n    }\r\n    return 1\r\n  },\r\n  addFile: function(file, extra, form, fromClipboard=false) {\r\n    let index = this.store.push(file)-1\r\n    form.querySelector('.fe-sort-wrapper').insertAdjacentHTML('beforeEnd', `\r\n      <div class=\"file-entry${fromClipboard ? ' fe-name-hidden' : ''}\" data-index=\"${index}\" title=\"${file.name}\">\r\n        <div class=\"fe-thumb\">\r\n          ${extra.img ? `<img src=${extra.img}>` :  `<div class=\"fe-noimg\">${extra.ext}</div>`}\r\n        </div>\r\n        <input type=\"text\" value=\"${extra.fname}\" class=\"fe-fn\" ${fromClipboard ? ' disabled' : ''}>\r\n        <button class=\"clear-filename fe-pop-button icon-wraping-button\" title=\"${_l.hideName}\"><svg class=\"icon b-icon\">\r\n          <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-hide-name\"></use>\r\n        </svg></button>\r\n        <button class=\"remove-file fe-pop-button icon-wraping-button\" title=\"${_l.removeFile}\"><svg class=\"icon b-icon\">\r\n          <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-x\"></use>\r\n        </svg></button>\r\n        <button class=\"spoiler-file fe-pop-button icon-wraping-button\" title=\"${_l.spoilerOnOff}\"><svg class=\"icon b-icon\">\r\n          <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-spoiler\"></use>\r\n        </svg></button>\r\n        <div class=\"fe-info\"></div>\r\n      </div>\r\n    `)\r\n    this.recalcForm(form)\r\n    let thisEl = form.querySelector(`.file-entry[data-index=\"${index}\"]`)\r\n    , img = false\r\n    , updateInfo = () => thisEl.querySelector(`.fe-info`).innerText = \r\n        `${extra.ext.toUpperCase()}${(img ? `, ${img.naturalWidth}${img.naturalHeight}`: '')}, ${extra.sizeFormatted}`\r\n    if (extra.img) {\r\n      img = thisEl.querySelector('img')\r\n      img.onload = updateInfo\r\n      img.onerror = updateInfo\r\n    }\r\n    else updateInfo()\r\n    thisEl._ext = extra.ext\r\n    this.updateTitle($(thisEl))\r\n  },\r\n  recalcForm: function(form) {\r\n    let count = form.querySelectorAll('.file-entry').length\r\n    , maxfiles = +form.dataset.maxfiles\r\n    form.classList.toggle('fda-non-empty', count > 0)\r\n    form.classList.toggle('fda-form-full', count >= maxfiles)\r\n    form.querySelector('.file-count').innerHTML = count > 0\r\n      ? `${_l.files}<br>(${count}/${maxfiles})`\r\n      : `${_l.file}`\r\n  },\r\n  updateTitle: function($el) {\r\n    let v = $el.find('.fe-fn').val()\r\n    , fname = !$el.hasClass('fe-name-hidden') && v ? v : '*****'\r\n    $el[0].title = `${fname}.${$el[0]._ext}`\r\n  },\r\n  serialize: function(form, fd) {\r\n    form.querySelectorAll('.file-entry').forEach((fe, i) => {\r\n      fd.append('imagefile[]', this.store[+fe.dataset.index])\r\n      if (fe.classList.contains('fe-spoiler'))\r\n        fd.append(`spoiler-${i}`, 1)\r\n      let fname = fe.querySelector('.fe-fn').value\r\n      if (fe.classList.contains('fe-name-hidden') || fname==='')\r\n        fd.append(`hidename-${i}`, 1)\r\n      else\r\n        fd.append(`filename-${i}`, fname)\r\n    } )\r\n  },\r\n  store: [],\r\n  initiated: false,\r\n  init: function(form) {\r\n    this.enabled = form.querySelector('.file-row') && 'FileReader' in window\r\n    if (this.enabled) {\r\n      let _this = this\r\n      $('body')\r\n      .on('click', '.remove-file', function(ev) {\r\n        ev.preventDefault()\r\n        ev.stopPropagation()\r\n        let $entry = $(this).parents('.file-entry')\r\n        _this.store[+$entry.data('index')] = null\r\n        let $form = $entry.parents('form[name=postform]')\r\n        $entry.remove()\r\n        _this.recalcForm($form[0])\r\n      })\r\n      .on('click', '.file-entry', function(ev) {\r\n        $(this).toggleClass('fe-expanded')\r\n        setTimeout(() => $(this).find('input').select(), 450)\r\n      })\r\n      .on('click', '.file-entry input', function(ev) {\r\n        ev.stopPropagation()\r\n      })\r\n      .on('click', '.spoiler-file', function(ev) {\r\n        ev.preventDefault()\r\n        ev.stopPropagation()\r\n        $(this).parents('.file-entry').toggleClass('fe-spoiler')\r\n      })\r\n      .on('click', '.clear-filename', function(ev) {\r\n        ev.preventDefault()\r\n        ev.stopPropagation()\r\n        let $entry = $(this).parents('.file-entry')\r\n        $entry.find('.fe-fn').prop('disabled', !$entry.hasClass('fe-name-hidden'))\r\n        $entry.toggleClass('fe-name-hidden')\r\n        _this.updateTitle($entry)\r\n      })\r\n      .on('change', '.fe-fn', function(ev) {\r\n        _this.updateTitle($(this).parents('.file-entry'))\r\n      })\r\n      .on('change', 'input[type=file]', function(ev) {\r\n        let form = $(this).parents('form[name=postform]')[0]\r\n        _this.handleFiles(ev.target.files, form)\r\n        this.value = null\r\n      })\r\n      .on('click', '.add-files', function(ev) {\r\n        ev.preventDefault()\r\n        $(this).parents('form[name=postform]').find('input[type=file]')[0].click()\r\n      })\r\n      .on('paste', 'form[name=postform]', function(ev) {\r\n        let items = (ev.clipboardData || ev.originalEvent.clipboardData).items\r\n        , arr = [];\r\n        for (var i = 0 ; i < items.length ; i++) {\r\n          var item = items[i];\r\n          if (item.kind == 'file') {\r\n            arr.push(item.getAsFile())\r\n          }\r\n        }\r\n        _this.handleFiles(arr, this, true)\r\n      })\r\n    }\r\n    else {\r\n      $('body')\r\n      .on('click', '.remove-file', function(ev) {\r\n        ev.preventDefault()\r\n        $(this).parent().find('input[type=file]')\r\n          .val(null)\r\n          .removeClass('non-empty-file-input')\r\n      })\r\n      .on('change', 'input[type=file]', function() {\r\n        $(this).toggleClass('non-empty-file-input', this.value)\r\n      })\r\n    }\r\n    this.initiated = true\r\n    /*if (!is_overboard)\r\n      this.initForm(postform)*/\r\n  },\r\n  initForm: function(form) {\r\n    if (!this.initiated)\r\n      this.init(form)\r\n    let _this = this\r\n    if (this.enabled) {\r\n      // Drag and drop events\r\n      $(form) // I tried using plain JS, doesn't work, sorry\r\n      .on('dragenter dragend dragover drop dragleave', function(ev) {\r\n        ev.originalEvent.stopPropagation()\r\n        if (!(ev.target.nodeName == 'TEXTAREA' || ev.target.nodeName == 'INPUT')) \r\n          ev.preventDefault()\r\n      })\r\n      .on('drop', function(ev) {\r\n        ev.originalEvent.stopPropagation()\r\n        if (ev.originalEvent.dataTransfer && ev.originalEvent.dataTransfer.files.length) {\r\n          ev.originalEvent.preventDefault() \r\n          _this.handleFiles(ev.originalEvent.dataTransfer.files, this)\r\n        }\r\n      })\r\n      // File entry sorting\r\n      if(form.querySelector('.fe-sort-wrapper')) {\r\n        Sortable.create(form.querySelector('.fe-sort-wrapper'), {\r\n          animation: 150,\r\n          handle: '.fe-thumb'\r\n        })\r\n      }\r\n      // Prevent legacy file inputs from being serialized\r\n      form.querySelectorAll('input[name^=imagefile]').forEach(i => i.removeAttribute('name'))\r\n    }\r\n    else {\r\n      let area = form.querySelector('.drop-area')\r\n      if (!area) return;\r\n      area.previousElementSibling.classList.remove('noscript')\r\n      area.remove()\r\n    }\r\n  },\r\n  clear: function(form, clearStore=false) {\r\n    if (this.enabled) {\r\n      form.querySelectorAll('.file-entry').forEach(fe => {\r\n        if (clearStore)\r\n          this.store[fe.dataset.index] = null\r\n        fe.remove()\r\n      })\r\n      this.recalcForm(form)\r\n    }\r\n  }\r\n}\r\n\r\nfunction handleCtrlEnter(ev) {\r\n  ev.preventDefault()\r\n  let area = document.activeElement\r\n  , form = area._findParent('form[name=postform]')\r\n  if (form) {\r\n    Ajax.submitPost(form)\r\n  }\r\n}\r\n\r\nfunction redirectTo(href) {\r\n  // console.warn('About to redirect to:', href)\r\n  document.location.href = href\r\n}\r\n\r\nconst Ajax = {\r\n  submitPost: function(form, sage) {\r\n    if (form.querySelector('script[src^=\"https://js.hcaptcha.com\"]')) {\r\n      hcaptcha.execute({ async: true })\r\n      .then(({ response, key }) => {\r\n        this.actuallySubmitPost(form, sage, response)\r\n      })\r\n      .catch(err => {\r\n        console.error('hcapthca:', err)\r\n        if (err == 'challenge-expired')\r\n          this.shownErrors.push(pups.warn(_l.captchaExpired))\r\n      });\r\n    }\r\n    else {\r\n      this.actuallySubmitPost(form, sage)\r\n    }\r\n  },\r\n  actuallySubmitPost: function(form, sage, hCaptchaResponse=false) {\r\n    let alertsToRemove = _.clone(this.shownErrors)\r\n    setTimeout(() => {\r\n      alertsToRemove.forEach(a => {\r\n        pups.closeByID(a)\r\n      })\r\n    }, 300)\r\n    this.shownErrors = []\r\n    let showError = (a, b={}) => this.shownErrors.push(pups.err(a, b))\r\n    let showWarning = (a, b={}) => this.shownErrors.push(pups.warn(a, b))\r\n\r\n    let captchafield = form.captcha\r\n    if (captchafield && !captchafield.value.length) {\r\n      captchafield.focus()\r\n      return showWarning(_l.enterCaptcha)\r\n    }\r\n    \r\n    form.classList.add('form-sending')\r\n    let fd = new FormData(form)\r\n\r\n    if (typeof sage !== 'undefined')\r\n      fd.append('sagebtn', sage)\r\n\r\n    if (hCaptchaResponse) {\r\n      fd.append('h-captcha-response', hCaptchaResponse)\r\n    }\r\n\r\n    if (richFileInput.enabled)\r\n      richFileInput.serialize(form, fd)\r\n    let xr = new XMLHttpRequest()\r\n    fd.append('AJAX', 1)\r\n\r\n    // Token for live updates\r\n    this.postToken = randomString()\r\n    fd.append('token', this.postToken)\r\n\r\n    xr.open('POST', form.action)\r\n    xr.onload = e => {\r\n      form.classList.remove('form-sending')\r\n      if (xr.status !== 200) {\r\n        showError(_l.xhrError)\r\n        return\r\n      }\r\n      ;[].forEach.call(form.querySelectorAll('.error-in-attachment'), el => el.classList.remove('error-in-attachment'))\r\n      if (Captcha.enabled)\r\n        Captcha.state = 'init'\r\n      let res = null\r\n      try {\r\n        res = JSON.parse(xr.response)\r\n      }\r\n      catch(e) {\r\n        showError(_l.xhrError)\r\n        console.error('Malformed response (JSON expected):', xr.response)\r\n        return\r\n      }\r\n      if (res.error) {\r\n        if (res.error_verbose)\r\n          res.error = `${res.error}<br>${res.error_verbose}`\r\n        if (res.error_type) {\r\n          if (res.error_type == 'ban') {\r\n            showError(`${res.error} (<a href=\"${ku_cgipath}/banned.php\" target=\"_blank\">${_l.details}</a>)`, {time: 0, save: true})\r\n          }\r\n          if (res.error_type == 'duplicate_file') {\r\n            showError(res.error, {time: 0})\r\n            form.querySelector('input[name=\"imagefile\"]').value = null\r\n          }\r\n          if (res.error_type == 'upload_error') {\r\n            showError(res.error, {time: 0})\r\n            let badatt = form.querySelector(`.multiembedwrap[data-pos=\"${res.error_data.attachmenttype}-${res.error_data.position+1}\"]`)\r\n            if (badatt) {\r\n              badatt.classList.add('error-in-attachment')\r\n            }\r\n          }\r\n        }\r\n        else {\r\n          showError(res.error, {time: 0})\r\n        }\r\n        return\r\n      }\r\n      else {\r\n        if (res.timings) {\r\n          console.log('timings:', res.timings)\r\n        }\r\n        resetForm(form)\r\n        if (form.classList.contains('quick-reply-form')) {\r\n          hidePostForm(form) // TODO: tumbach pinning?\r\n        }\r\n        /*else {\r\n        }*/\r\n        let nokoInput = form.querySelector('input[name=\"redirecttothread\"]')\r\n        , noko = nokoInput && nokoInput.checked\r\n        if (res.thread_replyto != 0) {\r\n          newposts.get({\r\n            threadid: ispage ? res.thread_replyto+'-'+res.board : null,\r\n            expectedPost: res.post_id+'-'+res.board,\r\n            onError: (err) => {\r\n              console.error(err)\r\n              redirectTo(`${ku_boardspath}/${res.board}/res/${res.thread_replyto}.html#${res.post_id}`)\r\n              if (! ispage)\r\n                document.location.reload()\r\n            },\r\n            onSuccess: () => $(`#delform div[id^=thread${res.thread_replyto}] .fresh-replies`).remove()\r\n          })\r\n        }\r\n        else {\r\n          if (noko) {\r\n            redirectTo(`${ku_boardspath}/${res.board}/res/${res.post_id}.html`)\r\n          }\r\n          else {\r\n            redirectTo(`${ku_boardspath}/${res.board}`)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    xr.send(fd)\r\n  },\r\n  shownErrors: [],\r\n  reportPost: function(fd, callback=null) {\r\n    let xr = new XMLHttpRequest()\r\n    fd.append('AJAX', 1)\r\n    fd.append('reportpost', 1)\r\n    xr.open('POST', document.forms.delform.action)\r\n    xr.onload = e => {\r\n      if (xr.status !== 200) {\r\n        pups.err(_l.xhrError)\r\n        return callback(false)\r\n      }\r\n      let res = null\r\n      try {\r\n        res = JSON.parse(xr.response)\r\n      }\r\n      catch(e) {\r\n        pups.err(_l.xhrError)\r\n        console.error('Malformed response (JSON expected):', xr.response)\r\n        return callback(false)\r\n      }\r\n      if (callback)\r\n        callback(res.data)\r\n      if (res.error) {\r\n        if (res.error_verbose)\r\n          res.error = `${res.error}<br>${res.error_verbose}`\r\n        pups.err(res.error, {time: 0})\r\n        return\r\n      }\r\n      else {\r\n        $('body').removeClass('select-multiple')\r\n        $('.userdelete').removeClass('ud-active')\r\n        let postsReported = []\r\n        , postErrors = []\r\n        res.data.forEach(item => {\r\n          if (!item.success) {\r\n            postErrors.push(item)\r\n            return\r\n          }\r\n          postsReported.push(item.id)\r\n          if (! $('input[name=\"post[]\"]:checked').length)\r\n            $('.userdelete').removeClass('ud-active');\r\n        })\r\n        let msg = ''\r\n        if (postsReported.length) {\r\n          postsReported = postsReported.map(post => '#'+post)\r\n          msg += postsReported.length > 1 ?\r\n            `${_l.posts} ${postsReported.join(', ')} ${_l.reportedMulti}.`\r\n           :`${_l.post} ${postsReported[0]} ${_l.reported}.`\r\n          pups.succ(msg, {time: 2 + postsReported.length})\r\n        }\r\n        postErrors.forEach(err => {\r\n          pups.err(`${_l.post} #${err.id}: ${err.message}`)\r\n        })\r\n      }\r\n    }\r\n    xr.send(fd)\r\n  },\r\n  cancelTimer: function(fd, callback=null) {\r\n    let xr = new XMLHttpRequest()\r\n    fd.append('AJAX', 1)\r\n    fd.append('cancel_timer', 1)\r\n\r\n    // Token for live updates\r\n    this.timerToken = randomString()\r\n    fd.append('token', this.timerToken)\r\n\r\n    xr.open('POST', document.forms.delform.action)\r\n    xr.onload = e => {\r\n      if (xr.status !== 200) {\r\n        pups.err(_l.xhrError)\r\n        return callback(false)\r\n      }\r\n      let res = null\r\n      try {\r\n        res = JSON.parse(xr.response)\r\n      }\r\n      catch(e) {\r\n        pups.err(_l.xhrError)\r\n        console.error('Malformed response (JSON expected):', xr.response)\r\n        return callback(false)\r\n      }\r\n      if (res.error) {\r\n        if (res.error_verbose)\r\n          res.error = `${res.error}<br>${res.error_verbose}`\r\n        pups.err(res.error, {time: 0})\r\n        return callback(false)\r\n      }\r\n      else {\r\n        $('body').removeClass('select-multiple')\r\n        $('.userdelete').removeClass('ud-active')\r\n        let postsSaved = []\r\n        , postErrors = []\r\n        res.data.forEach(item => {\r\n          if (!item.success) {\r\n            postErrors.push(item)\r\n            return\r\n          }\r\n          postsSaved.push(item.id)\r\n          if (! $('input[name=\"post[]\"]:checked').length)\r\n            $('.userdelete').removeClass('ud-active');\r\n        })\r\n        let msg = ''\r\n        if (postsSaved.length) {\r\n          postsSaved.forEach(id => {\r\n            let $reply = $(`.postnode[data-id=${id}]`)\r\n            $reply.find('.post-ttl').remove()\r\n            $reply.find('.post-menu').hide()\r\n          } )\r\n          msg += postsSaved.length > 1 ?\r\n            `${_l.posts} #${postsSaved.join(', #')} ${_l.savedMulti}.`\r\n           :`${_l.post} #${postsSaved[0]} ${_l.saved}.`\r\n          pups.succ(msg, {time: 2 + postsSaved.length})\r\n        }\r\n        postErrors.forEach(err => {\r\n          pups.err(`${_l.post} #${err.id}: ${err.message}`)\r\n        })\r\n        callback(postErrors)\r\n      }\r\n    }\r\n    xr.send(fd)\r\n  },\r\n  modThread: function(a, action) {\r\n    let $a = $(a)\r\n    , fd = new FormData()\r\n    , xr = new XMLHttpRequest()\r\n    , $li = $a.find('li')\r\n    $li.addClass('spin-around')\r\n    fd.append('AJAX', 1)\r\n    xr.open('POST', a.getAttribute('href'))\r\n    xr.onload = e => {\r\n      $li.removeClass('spin-around')\r\n      if (xr.status !== 200) {\r\n        pups.err(_l.xhrError)\r\n        return\r\n      }\r\n      let res = null\r\n      try {\r\n        res = JSON.parse(xr.response)\r\n      }\r\n      catch(e) {\r\n        pups.err(_l.xhrError)\r\n        console.error('Malformed response (JSON expected):', xr.response)\r\n        return\r\n      }\r\n      if (res.error) {\r\n        if (res.error_verbose)\r\n          res.error = `${res.error}<br>${res.error_verbose}`\r\n        pups.err(res.error, {time: 0})\r\n        return\r\n      }\r\n      else {\r\n        let $posthead = $a.parents('.posthead')\r\n        , $extrabtns = $posthead.find('.extrabtns')\r\n        if (action == 'stickypost') {\r\n          $extrabtns.prepend(makeIcon('pin', 'i-icon i-pin'));\r\n          $posthead.addClass('thread-stickied')\r\n        }\r\n        if (action == 'unstickypost') {\r\n          $extrabtns.find('svg.i-icon.i-pin').remove()\r\n          $posthead.removeClass('thread-stickied')\r\n        }\r\n        if (action == 'lockpost') {\r\n          $extrabtns.prepend(makeIcon('lock', 'i-icon i-lock'));\r\n          $posthead.addClass('thread-locked')\r\n        }\r\n        if (action == 'unlockpost') {\r\n          $extrabtns.find('svg.i-icon.i-lock').remove()\r\n          $posthead.removeClass('thread-locked')\r\n        }\r\n        pups.succ(res.message)\r\n      }\r\n    }\r\n    xr.send(fd)\r\n  },\r\n  deleteItems: function(fd, callback=null, asMod=false) {\r\n    let kind = 'Items'\r\n    if (asMod) {\r\n      console.log('yes')\r\n      fd.append('moddelete', 1)\r\n    }\r\n    if (fd.has) {\r\n      if (fd.has('post[]')) {\r\n        if (!fd.has('delete-file[]'))\r\n          kind = 'Posts'\r\n        fd.append('deletepost', 1)\r\n      }\r\n      else if (fd.has('delete-file[]'))\r\n        kind = 'Files'\r\n      else return;\r\n    }\r\n    else { // FormData.has() is not supported\r\n      fd.append('deletepost', 1)\r\n    }\r\n    \r\n    let xr = new XMLHttpRequest()\r\n    fd.append('AJAX', 1)\r\n\r\n    // Token for live updates\r\n    this.delToken = randomString()\r\n    fd.append('token', this.delToken)\r\n\r\n    xr.open('POST', document.forms.delform.action)\r\n    xr.onload = e => {\r\n      if (xr.status !== 200) {\r\n        pups.err(_l.xhrError)\r\n        return callback ? callback(null) : null\r\n      }\r\n      let res = null\r\n      try {\r\n        res = JSON.parse(xr.response)\r\n      }\r\n      catch(e) {\r\n        pups.err(_l.xhrError)\r\n        console.error('Malformed response (JSON expected):', xr.response)\r\n        return callback(null)\r\n      }\r\n      if (callback)\r\n        callback(res.data)\r\n      if (res.error) {\r\n        if (res.error_verbose)\r\n          res.error = `${res.error}<br>${res.error_verbose}`\r\n        pups.err(res.error, {time: 0})\r\n        return\r\n      }\r\n      else {\r\n        deleteItems(res.data)\r\n      }\r\n    }\r\n    xr.send(fd)\r\n  }\r\n}\r\n\r\nfunction inspectFormData(formData) {\r\n  for (var pair of formData.entries()) {\r\n    console.log(pair[0]+ ', ' + pair[1]);\r\n  }\r\n}\r\n\r\nfunction makeIcon(i, classes=\"\", bare=false) {\r\n  return `${bare ? '' : `<svg class=\"icon ${classes}\">`}\r\n    <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-${i}\"></use>\r\n  ${bare ? '' : '</svg>'}`\r\n}\r\n\r\nfunction addCaptchaToMenu($menu) {\r\n  if ($menu.find('.captchawrap').length) {\r\n    Captcha.state = 'init';\r\n    return;\r\n  }\r\n  if (!Captcha.enabled) {\r\n    Captcha.init('only-access')\r\n  }\r\n  $menu.prepend(`<li class=\"menu-captcha\">\r\n    <div class=\"captchawrap cw-initial captchaimage-invisible\" title=\"${_l.refreshCaptcha}\">\r\n      <div class=\"captcha-show msg\">${_l.showCaptcha}</div>\r\n      <img class=\"captchaimage\" valign=\"middle\" border=\"0\" alt=\"${_l.captchaImage}\">\r\n      <div class=\"rotting-indicator\"></div>\r\n      <div class=\"rotten-msg msg\">${_l.captchaExpired}</div>\r\n    </div>\r\n    <input type=\"text\" name=\"captcha\" placeholder=\"${_l.captcha}\" autocomplete=\"off\">\r\n  </li>`)\r\n  Captcha.initForm($menu[0])\r\n  $menu.find('input[name=captcha]').keydown(ev => {\r\n    if (ev.key == 'Enter') {\r\n      ev.preventDefault()\r\n      ev.stopPropagation()\r\n    }\r\n  })\r\n}\r\n\r\n// YOBA media previews\r\nclass MediaViewer {\r\n  static parseVideo(link) {\r\n    let postnum = link.dataset.id\r\n    , imgurl = link.href\r\n    , thumburl = link.dataset.thumb\r\n    , imgw = link.dataset.width\r\n    , imgh = link.dataset.height\r\n    , thumb = link.querySelector('img')\r\n    , thumbw = thumb.width\r\n    , thumbh = thumb.height\r\n    return [postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh]\r\n  }\r\n  static parseImg(link) {\r\n    return link.getAttribute('onclick')\r\n    .match(/expandimg\\('(.+?)', ?'(.+?)', ?'(.+?)', ?'(.+?)', ?'(.+?)', ?'(.+?)', ?'(.+?)'/)\r\n    .slice(1)\r\n  }\r\n  constructor(postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh, isVideo=false) {\r\n    let thumb = document.querySelector(`#thumb${postnum} img`)\r\n    if (thumb == null) return false;\r\n    this.post = thumb._findParent('.postbody')\r\n    this.initZoom()\r\n    this.createContainer()\r\n    this.resetTransform()\r\n    let pre = thumb._findParent('.reflinkpreview')\r\n    if (pre)\r\n      PostPreviews.pinPreview(pre, true, true)\r\n    let thBCR = thumb.getBoundingClientRect()\r\n    , thumb_x = thBCR.x, thumb_y = thBCR.y, thumb_w = thBCR.width, thumb_h = thBCR.height\r\n    , win_w = this.viewer.clientWidth, win_h = this.viewer.clientHeight\r\n    , scaleDownFactor = Math.min(win_w / imgw, win_h / imgh, 1)\r\n    , pre_w = imgw * scaleDownFactor, pre_h = imgh * scaleDownFactor\r\n    , visibleMarginX = (win_w-pre_w)/2, visibleMarginY = (win_h-pre_h)/2\r\n    , mi_w = Math.min(win_w, imgw), mi_h = Math.min(win_h, imgh)\r\n    , screenScaleDownFactor = thumb_w/pre_w\r\n    , transX = (thumb_x + thumb_w/2) - win_w/2, transY = (thumb_y + thumb_h/2) - win_h/2\r\n    , trans = `style=\"transform: translate(${transX}px, ${transY}px) scale(${screenScaleDownFactor})\"`\r\n    , me = this.viewer._ins('afterBegin', this.createMediaElement(thumb.src, imgw, imgh, imgurl, trans, isVideo))\r\n    this.refreshList()\r\n    this.currentThumb = thumb\r\n    thumb.style.visibility = 'hidden'\r\n    this.updateCounter()\r\n    this.showPercentage(scaleDownFactor)\r\n    me._isVideo = isVideo\r\n    this.setVolume(me)\r\n    me._scaleDownFactor = scaleDownFactor\r\n    this.currentMediaItem = me\r\n    me._realWidth = imgw\r\n    this.imgw = imgw\r\n    this.imgh = imgh\r\n    document.body.style.overflow = 'hidden'\r\n    requestAnimationFrame(() => {\r\n      this.container.classList.remove('mvc-collapsed')\r\n      me.style.transform = null\r\n    })\r\n  }\r\n  refreshList() {\r\n    this.list = document.querySelectorAll('img.thumb')\r\n  }\r\n  findIndex(thumb) {\r\n    return Array.prototype.findIndex.call(this.list, e => e==thumb)\r\n  }\r\n  // Container\r\n  createContainer() {\r\n    this.container = document.body._ins('beforeend', `<div class=\"mv-container mvc-collapsed\">\r\n    <div class=\"media-viewer\">\r\n      <div class=\"mv-label\">\r\n        <span class=\"item-counter\"></span>\r\n        <span class=\"scale-indicator\"></span>\r\n      </div>\r\n      <div class=\"mv-button mv-prev-next mv-prev\"></div>\r\n      <div class=\"mv-button mv-prev-next mv-next\"></div>\r\n      <div class=\"mv-button mv-restore\"></div>\r\n      <div class=\"mv-button mv-close\"></div>\r\n    </div></div>`)\r\n    this.viewer = this.container.querySelector('.media-viewer')\r\n    this.viewer.addEventListener('wheel', this.handleZoom.bind(this))\r\n    this.viewer.addEventListener('mousemove', ev => {\r\n      this.mouseX = ev.clientX\r\n      this.mouseY = ev.clientY\r\n      if (this.isMouseDown) {\r\n        this.handleDrag()\r\n      }\r\n    })\r\n    this.viewer.addEventListener('mousedown', ev => {\r\n      if (ev.button==2 && this.currentMediaItem._isVideo) {\r\n        let ov = this.currentMediaItem.querySelector('.video-event-overlay')\r\n        ov.style.pointerEvents='none'\r\n        setTimeout(() => ov.style.pointerEvents='all', 100)\r\n      }\r\n      this.gripX = ev.clientX\r\n      this.gripY = ev.clientY\r\n      this.isMouseDown = true\r\n      if (ev.target.classList.contains('media-viewer') || ev.target.classList.contains('mv-under'))\r\n        this.emptyClick = true\r\n    })\r\n    this.viewer.addEventListener('contextmenu', ev => {\r\n      if (this.currentMediaItem._isVideo) {\r\n        let ov = this.currentMediaItem.querySelector('.video-event-overlay')\r\n        ov.style.pointerEvents='none'\r\n        setTimeout(() => ov.style.pointerEvents='all', 100)\r\n      }\r\n    })\r\n    this.viewer.addEventListener('click', ev=> {\r\n      if (this.isDragged) {\r\n        this.isDragged = false\r\n        ev.preventDefault()\r\n      }\r\n    })\r\n    this.viewer.addEventListener('mouseup', ev => {\r\n      this.isMouseDown = false\r\n      this.currentMediaItem.classList.remove('no-transition')\r\n      if (this.isDragged) {\r\n        ev.preventDefault()\r\n      }\r\n      else if (ev.button == 0) {\r\n        this.collapse()\r\n      }\r\n      this.emptyClick = false\r\n    })\r\n    this.viewer.addEventListener('dragstart', ev => {\r\n      ev.preventDefault()\r\n      ev.stopPropagation()\r\n    })\r\n    this.viewer.querySelectorAll('.mv-button').forEach(pnb => {\r\n      pnb.addEventListener('click', ev => {\r\n        ev.stopPropagation()\r\n        this.refreshList()\r\n        let index = this.findIndex(this.currentThumb)\r\n        if (pnb.classList.contains('mv-prev') || pnb.classList.contains('mv-next')) {\r\n          if (pnb.classList.contains('mv-prev')) {\r\n            index -= 1\r\n            if (index < 0)\r\n              index = this.list.length-1\r\n          }\r\n          else  {\r\n            index += 1\r\n            if (index >= this.list.length)\r\n              index = 0\r\n          }\r\n          this.switchItem(this.list[index])\r\n        }\r\n        else if (pnb.classList.contains('mv-close')) {\r\n          this.collapse()\r\n        }\r\n        else if (pnb.classList.contains('mv-restore')) {\r\n          this.toggleFullSize(0)\r\n        }\r\n      })\r\n      ;['mouseup', 'mousedown'].forEach(evt => pnb.addEventListener(evt, ev => ev.stopPropagation()))\r\n    })\r\n    this.viewer.addEventListener('mouseleave', ev => {\r\n      this.isMouseDown = false\r\n      this.isDragged = false\r\n    })\r\n  }\r\n  // Managing transforms\r\n  applyTransform() {\r\n    let me = this.currentMediaItem\r\n    if (!me) return;\r\n    me.style.transform = `translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`\r\n  }\r\n  resetTransform() {\r\n    this.translateX = 0\r\n    this.translateY = 0\r\n    this.scale = 1\r\n  }\r\n  // Zooming\r\n  initZoom() {\r\n    this.zoomAmount = 0.5\r\n    this.minScale = 0.1\r\n    this.zoomSteps = [0.1, 0.25, 0.33, 0.5, 0.75, 1, 1.5, 2, 2.5, 3, 4, 5, 6, 8, 10]\r\n  }\r\n  handleZoom(ev) {\r\n    let me = this.currentMediaItem\r\n    if (!me) return;\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n    let dir = -Math.sign(ev.deltaY)\r\n    , initialScale = 1/me._scaleDownFactor\r\n    , zSteps = Array.from(this.zoomSteps)\r\n      .filter(z => Math.abs((z-initialScale)/initialScale) > 0.1) // Remove zoom steps that are close to (real) 100%\r\n      .concat([initialScale]) // Add a (real) 100% step\r\n    , centerX = this.viewer.clientWidth / 2 + this.translateX\r\n    , centerY = this.viewer.clientHeight / 2 + this.translateY\r\n    , newScale = zSteps.map(z => z - this.scale).filter(z => z*dir > 0) // Pick only the steps in the needed direction\r\n      .sort((a,b) => (a-b)*dir)[0] + this.scale // Find the closest step\r\n    if (!isNaN(newScale)) { // It may be NaN in case when minimum or maximum zoom amount is achieved\r\n      this.showPercentage(me._scaleDownFactor * newScale)\r\n      this.translateX += (centerX - this.mouseX)/this.scale * (newScale-this.scale)\r\n      this.translateY += (centerY - this.mouseY)/this.scale * (newScale-this.scale)\r\n      this.scale = newScale\r\n      this.applyTransform()\r\n      this.flashLabel()\r\n    }\r\n  }\r\n  showPercentage(scale) {\r\n    this.viewer.querySelector('.scale-indicator').innerText = `| ${Math.round(scale * 100)}%`\r\n  }\r\n  // Dragging\r\n  handleDrag(ev) {\r\n    let me = this.currentMediaItem\r\n    if (!me) return;\r\n    let dx = this.mouseX - this.gripX\r\n    , dy = this.mouseY - this.gripY\r\n    if (dx != 0 || dy != 0) {\r\n      if (!this.isDragged) {\r\n        this.currentMediaItem.classList.add('no-transition')\r\n        this.isDragged = true\r\n        this.initialTransX = this.translateX\r\n        this.initialTransY = this.translateY\r\n      }\r\n      this.translateX = this.initialTransX+dx\r\n      this.translateY = this.initialTransY+dy\r\n      this.applyTransform()\r\n    }\r\n  }\r\n  // Switching\r\n  switchItem(thumb) {\r\n    let link = thumb._findParent('a')\r\n    , isVideo = link.classList.contains('movie')\r\n    let [postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh] = isVideo\r\n      ? MediaViewer.parseVideo(link)\r\n      : MediaViewer.parseImg(link)\r\n    let win_w = this.viewer.clientWidth, win_h = this.viewer.clientHeight\r\n    , scaleDownFactor = Math.min(win_w / imgw, win_h / imgh, 1)\r\n    this.showPercentage(scaleDownFactor)\r\n    this.resetTransform()\r\n    this.applyTransform()\r\n    this.currentMediaItem._isVideo = isVideo\r\n    this.currentMediaItem._scaleDownFactor = scaleDownFactor\r\n    this.currentMediaItem.classList.remove('no-transition')\r\n    this.currentMediaItem.innerHTML = this.createMediaElement(thumb.src, imgw, imgh, imgurl, null, isVideo)\r\n    this.setVolume(this.currentMediaItem)\r\n    this.currentThumb.style.visibility = 'visible'\r\n    thumb.style.visibility = 'hidden'\r\n    this.post = thumb._findParent('.postbody')\r\n    this.currentThumb = thumb\r\n    this.updateCounter()\r\n    this.refreshList()\r\n  }\r\n  setVolume(me) {\r\n    if (!me._isVideo) return;\r\n    let vid = me.querySelector('video')\r\n    vid.volume = localStorage['mediaVolume'] || 1\r\n    vid.onvolumechange = function() {\r\n      localStorage['mediaVolume'] = this.muted ? 0 : this.volume\r\n    }\r\n  }\r\n  updateCounter() {\r\n    let index = this.findIndex(this.currentThumb)\r\n    this.viewer.querySelector('.item-counter').innerText = `${index+1}/${this.list.length}`\r\n    this.flashLabel()\r\n  }\r\n  flashLabel() {\r\n    clearTimeout(this.flashLabelTimeout)\r\n    this.viewer.querySelector('.mv-label').classList.add('mvl-visible')\r\n    this.flashLabelTimeout = setTimeout(() => this.viewer.querySelector('.mv-label').classList.remove('mvl-visible'), 1000)\r\n  }\r\n  // Closing\r\n  collapse() {\r\n    document.body.style.overflow = ''\r\n    let me = this.currentMediaItem\r\n    , mi_w = me.clientWidth, mi_h = me.clientHeight\r\n    , svg = me.querySelector('.placeholder-svg')\r\n    , resizeFactor = Math.min(this.viewer.clientHeight/svg.naturalHeight, this.viewer.clientWidth/svg.naturalWidth)\r\n    if (me._isVideo) {\r\n      me.querySelector('video').remove()\r\n    }\r\n    this.isDragged = false\r\n    if (resizeFactor < 1) {\r\n      mi_w = svg.naturalWidth * resizeFactor\r\n      mi_h = svg.naturalHeight * resizeFactor\r\n    }\r\n    let offScreen = true, transform = ''\r\n    if (document.body.contains(this.currentThumb)) {\r\n      let thumbBCR = this.currentThumb.getBoundingClientRect()\r\n      offScreen = !(\r\n        thumbBCR.y < window.innerHeight\r\n        &&\r\n        (thumbBCR.y + thumbBCR.height) > 0\r\n        &&\r\n        thumbBCR.x < window.innerWidth\r\n        &&\r\n        (thumbBCR.x + thumbBCR.width) > 0\r\n      )\r\n      if (!offScreen) {\r\n        let transX = (thumbBCR.x + thumbBCR.width/2) - this.viewer.clientWidth/2\r\n        , transY = (thumbBCR.y + thumbBCR.height/2) - this.viewer.clientHeight/2\r\n        me.style.transform = `translate(${transX}px, ${transY}px) scale(${thumbBCR.width/mi_w})`\r\n      }\r\n    }\r\n    if (offScreen) {\r\n      me.style.transform = 'translate(0px, 0px) scale(0)'\r\n    }\r\n    me.classList.remove('no-transition')\r\n    this.container.classList.add('mvc-collapsed')\r\n    setTimeout(() => {\r\n      this.container.remove()\r\n      this.currentThumb.style.visibility = 'visible'\r\n      if (this.onCollapse) this.onCollapse()\r\n    }, 250)\r\n  }\r\n  // Full screen on and off\r\n  toggleFullSize(on) {\r\n    document.body.style.overflow = on ? 'hidden' : ''\r\n    if (on)\r\n      this.viewer.classList.remove('mv-transparent')\r\n    else\r\n      this.viewer.classList.add('mv-transparent')\r\n  }\r\n  // Media element within container\r\n  createMediaElement(underImageSrc, imgw, imgh, imgurl, trans='', isVideo=false) {\r\n    return `<div class=\"media-item ${isVideo ? 'loaded' : ''}\" ${trans}>\r\n      <div style=\"background-image: url(${underImageSrc}); max-width: ${imgw}px\" class=\"mv-under\"></div>\r\n      <${isVideo ? 'video controls autoplay loop' : 'img'} src=\"${imgurl}\" class=\"mv-over\" ${isVideo \r\n        ? `></video><img class=\"video-event-overlay\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' width='${imgw}' height='${Math.min(imgh, window.innerHeight)-50}'%2F%3E\">`\r\n        : `onload=\"this.parentElement.classList.add('loaded')\">`}\r\n      <img class=\"placeholder-svg\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' width='${imgw}' height='${imgh}'%2F%3E\">\r\n    </div>`\r\n  }\r\n}\r\n\r\n// Insert adjacent HTML and immediately return the inserted element\r\nElement.prototype._ins = function(position='beforeend', html) {\r\n  this.insertAdjacentHTML(position, html)\r\n  position = position.toLowerCase()\r\n  if (position == 'afterbegin') \r\n    return this.firstElementChild\r\n  else if (position == 'beforeend')\r\n    return this.lastElementChild\r\n  else if (position == 'beforebegin')\r\n    return this.previousElementSibling\r\n  else\r\n    return this.nextElementSibling\r\n}\r\n\r\nfunction expandimg_old(postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh) {\r\n  let element = document.getElementById(\"thumb\" + postnum);\r\n  if (element == null) return false;\r\n  let $element = $(element)\r\n  , $postbody = $element.parents('.postbody')\r\n  , $fc_filename = $element.parents('figure').find('.fc-filename')\r\n  , fc_width\r\n  if(typeof event !== 'undefined' && event.which === 2) return true;\r\n  if (element.getElementsByTagName('img')[0].getAttribute('alt').substring(0,4)!='full') {\r\n    $element.html('<img src=\"'+imgurl+'\" alt=\"full'+postnum+'\" class=\"thumb\" height=\"'+imgh+'\" width=\"'+imgw+'\">');\r\n    if (! Settings.expandImgFull()) {\r\n      let img = element.getElementsByTagName('img')[0]\r\n      , max_w = document.documentElement?document.documentElement.clientWidth : document.body.clientWidth\r\n      , offset = 50\r\n      , offset_el = img\r\n\r\n      while (offset_el != null) {\r\n        offset += offset_el.offsetLeft;\r\n        offset_el = offset_el.offsetParent;\r\n      }\r\n      var new_w = max_w - offset;\r\n      if (img.width > new_w) {\r\n        var ratio = img.width / img.height;\r\n        var zoom = 1 - new_w / img.width;\r\n        var new_h = new_w / ratio;\r\n        var notice = document.createElement('div');\r\n        notice.setAttribute('class', 'filesize');\r\n        notice.style.textDecoration = 'underline';\r\n        var textNode = document.createTextNode(_l.imageDownscaledBy + \" \" + Math.round(zoom*100) + \"% \"+_l.toFit);\r\n        notice.appendChild(textNode);\r\n        element.insertBefore(notice, img);\r\n        $(img).width(new_w);\r\n        $(img).height(new_h);\r\n      }\r\n      fc_width = new_w\r\n    }\r\n    else\r\n      fc_width = imgw\r\n    if ($postbody) $postbody.addClass('postbody-expanded')\r\n  }\r\n  else {\r\n    element.innerHTML = '<img src=\"' + thumburl + '\" alt=\"' + postnum + '\" class=\"thumb\" height=\"' + thumbh + '\" width=\"' + thumbw + '\">';\r\n    fc_width = thumbw\r\n    if ($postbody) $postbody.removeClass('postbody-expanded')\r\n  }\r\n  $fc_filename[0].style.maxWidth = `${fc_width - 50}px`\r\n  return false;\r\n}\r\n\r\nfunction expandimg(postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh) {\r\n  if (Settings.newMediaViewer()) {\r\n    let mv = new MediaViewer(postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh)\r\n    mv.onCollapse = () => mv = null //gc\r\n  }\r\n  else {\r\n    expandimg_old(postnum, imgurl, thumburl, imgw, imgh, thumbw, thumbh)\r\n  }\r\n  return false\r\n}\r\n\r\n// YOBA previews\r\nvar PostPreviews = {\r\n  zindex:  3,\r\n  parent: {},\r\n\r\n  _parseLink: function(el) {\r\n    let url = el.getAttribute(\"href\")\r\n    if (url) {\r\n      let matches = url.match(/\\/(.+)\\/res\\/([0-9]+)\\.html#([0-9]+)|postbynumber\\.php\\?b=(.+)&p=([0-9]+)/i)\r\n      if (matches) return {\r\n        board: matches[1] || matches[4],\r\n        parent: matches[2] || '?',\r\n        post: matches[3] || matches[5],\r\n      }\r\n    }\r\n    let cl = [].find.call(el.classList, c => c.match(/ref\\|.+?\\|([0-9]+|\\?)\\|[0-9]+/))\r\n    if (cl) {\r\n      cl = cl.split('|')\r\n      return {\r\n        board: cl[1],\r\n        parent: cl[2],\r\n        post: cl[3],\r\n      }\r\n    }\r\n    return null\r\n  },\r\n\r\n  _mouseover: function(e) {\r\n    e.stopPropagation();\r\n    var isCatalog = $(this).hasClass('catalog-entry')\r\n    , parsedURL = PostPreviews._parseLink(this)\r\n    if (!parsedURL) return false;\r\n    let board = parsedURL['board']\r\n    , parentid = parsedURL['parent']\r\n    , postid = parsedURL['post']\r\n    , previewid = 'preview_'+board+'_'+postid\r\n    , $preview = $('#' + previewid)\r\n    if ($preview.length == 0) {\r\n      $('body').children().first().before('<div id=\"'+previewid+'\"></div>');\r\n      $preview = $('#' + previewid);\r\n      $preview.addClass('reflinkpreview content-background pre-hidden actual-reflinkpreview');\r\n      $preview.mouseleave(PostPreviews._mouseout);\r\n      $preview.mouseover(PostPreviews.mouseOverPreview);\r\n    }\r\n    else {\r\n      if ($preview[0]._pinned)\r\n        return false // No need to recreate a preview in this case\r\n    }\r\n    var parent = $(this).parents('div[id^=preview]');\r\n    if (parent.length > 0) {\r\n      if (previewid == parent.attr('id')) return; // anti-recursion\r\n      for (var id in PostPreviews.parent) { \r\n        if (id == previewid || PostPreviews.parent[id] == previewid) \r\n          return\r\n      }\r\n      PostPreviews.parent[previewid] = parent.attr('id');\r\n    }\r\n    let transformOrigin;\r\n    if(e.clientY < ($(window).height() / 1.5)) {\r\n      $preview.css({top:e.pageY+5});\r\n      transformOrigin = \"top \"\r\n    } else {\r\n      $preview.css({bottom:$(window).height()-e.pageY+5});\r\n      transformOrigin = \"bottom \"\r\n    }\r\n    if(e.clientX < ($(window).width() / 1.5)) {\r\n      $preview.css({left:e.pageX+15});\r\n      transformOrigin += \"left\"\r\n    } else {\r\n      $preview.css({right:$(window).width()-e.pageX+15});\r\n      transformOrigin += \"right\"\r\n    }\r\n    $preview.css({zIndex: PostPreviews.zindex++, \"transform-origin\": transformOrigin});\r\n    this.style.cursor = \"progress\"\r\n    let preview = $preview[0]\r\n    HTMLoader.getPost(board, parentid, postid, (err, post) => {\r\n      window.setTimeout(() => {\r\n        preview.getBoundingClientRect() // force reflow or how is this thing called\r\n        $preview.html(post ? post : (_l.oops + (err !== false ? ` (${err})` : '')))\r\n        .removeClass('pre-hidden')\r\n        this.style.cursor = \"pointer\"\r\n        // Add pin button\r\n        let ebtns = preview.querySelector('.extrabtns')\r\n        if (!ebtns) return;\r\n        ebtns.insertAdjacentHTML('beforeEnd', `\r\n        <a href=\"#\" class=\"pin-preview pinner unpinned\" title=\"${_l.pinUnpin}\">\r\n          <svg class=\"icon b-icon\">\r\n            <use class=\"use-pin\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-pin\"></use>\r\n            <use class=\"use-unpin\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#i-unpin\"></use>\r\n          </svg>\r\n        </a>`)\r\n        let pinner = ebtns.querySelector('.pinner')\r\n        pinner.onclick = (ev) => {\r\n          ev.preventDefault()\r\n          ev.stopPropagation()\r\n          PostPreviews.pinPreview($preview[0])\r\n        }\r\n      }, 0)\r\n    })\r\n    e.preventDefault();\r\n  },\r\n\r\n  mouseOverPreview: function() {\r\n    var preview = $(this);\r\n    if ($(this).is('a')) {\r\n      let parsedURL = PostPreviews._parseLink(this)\r\n      if (!parsedURL) return;\r\n      let board = parsedURL['board']\r\n      , postid = parsedURL['post']\r\n      preview = $('#preview_'+board+\"_\"+postid).first();\r\n    }\r\n    while (preview.length > 0) {\r\n      clearTimeout(preview[0].fadeout)\r\n      preview = $('#' + PostPreviews.parent[preview.attr('id')])\r\n    }\r\n  },\r\n\r\n  _mouseout: function(ev, nodelay=false) {\r\n    var preview = $(this);\r\n    if ($(this).is('a')) {\r\n      if (this.predelay) {\r\n        clearTimeout(this.predelay)\r\n      }\r\n      let parsedURL = PostPreviews._parseLink(this)\r\n      if (!parsedURL) return;\r\n      let board = parsedURL['board']\r\n      , postid = parsedURL['post']\r\n      preview = $('#preview_'+board+\"_\"+postid).first();\r\n    }\r\n    while (preview.length > 0) {\r\n      clearTimeout(preview[0].fadeout)\r\n      let pre = preview\r\n      if (pre[0]._pinned) return;\r\n\r\n      preview[0].fadeout = setTimeout(() => {\r\n        pre.addClass('pre-hidden')\r\n        setTimeout(() => {\r\n          delete PostPreviews.parent[pre.attr('id')];\r\n          pre.remove();\r\n        }, PostPreviews._timings.transition)\r\n      }, nodelay ? 0 : PostPreviews._timings.fade)\r\n      preview = $('#' + PostPreviews.parent[preview.attr('id')]);\r\n    }\r\n  },\r\n\r\n  pinPreview: function(pre, pin, temporary=false) {\r\n    let pinner = pre.querySelector('.pinner')\r\n    if (typeof pin == 'undefined')\r\n      pin = !pinner.classList.contains('pinned')\r\n    pinner.classList.toggle('pinned', pin)\r\n    pinner.classList.toggle('unpinned', !pin)\r\n    if (temporary) {\r\n      let o = pre\r\n      o.addEventListener('mouseenter', () => PostPreviews.pinPreview(o, false))\r\n      o.classList.add('temporarily-pinned')\r\n    }\r\n    while (pre) {\r\n      pre._pinned = pin\r\n      pre = document.querySelector(`#${PostPreviews.parent[pre.id]}`)\r\n    }\r\n  },\r\n\r\n  _timings: {\r\n    predelay: 50,\r\n    transition: 200,\r\n    fade: 400\r\n  }\r\n}\r\n\r\nfunction set_inputs(id) {\r\n  let form = document.getElementById(id)\r\n  if (form) {\r\n    let name = form.querySelector('input[name=name]')\r\n    if(name && !name.value) {\r\n      let savedName = getCookie(\"name\")\r\n      if (~savedName.indexOf('#'))\r\n        name.type = 'password'\r\n      name.value = savedName\r\n    }\r\n    if(!form.em.value) form.em.value = getCookie(\"email\");\r\n    if(!form.postpassword.value) form.postpassword.value = get_password(\"postpassword\");\r\n  }\r\n}\r\n\r\nfunction set_delpass(id) {\r\n  let form = document.getElementById(id)\r\n  if (! form) return;\r\n  let postpassword = form.postpassword\r\n  if (postpassword && !postpassword.value) {\r\n    postpassword.value = get_password(\"postpassword\");\r\n  }\r\n}\r\n\r\n(function ($) { // [!] What the fuck is this?\r\n  $.event.special.load = {\r\n    add: function (callback) {\r\n      if ( this.nodeType === 1 && this.tagName.toLowerCase() === 'img' && this.src !== '' ) {\r\n        if ( this.complete || this.readyState === 4 ) {\r\n          callback.handler.apply(this);\r\n        }\r\n        else if ( this.readyState === 'uninitialized' && this.src.indexOf('data:') === 0 ) {\r\n          $(this).trigger('error');\r\n        }\r\n\r\n        else {\r\n          $(this).bind('load', callback.handler);\r\n        }\r\n      }\r\n    }\r\n  };\r\n}(jQuery));\r\n\r\nvar Settings = {\r\n  _checkbox: function(clicked, settingName, defaultValue, perBoard=false) {\r\n    let settingNameGeneral = settingName\r\n    if (perBoard)\r\n      settingName = settingName+'.'+this_board_dir\r\n    if (localStorage == null) {\r\n      pups.err(_l.noLocalStorage);\r\n      return;\r\n    }\r\n    if (localStorage[settingName] == null) {\r\n      localStorage[settingName] = defaultValue;\r\n    }\r\n    if (clicked == true) {\r\n      // save it\r\n      localStorage[settingName] = $('#settings_' + settingNameGeneral).is(\":checked\");\r\n    } else {\r\n      // update checkbox (called on load)\r\n      if (localStorage[settingName] == 'true')\r\n        $('#settings_' + settingNameGeneral).attr(\"checked\",\"checked\");\r\n      else\r\n        $('#settings_' + settingNameGeneral).removeAttr(\"checked\");\r\n    }\r\n    return (localStorage[settingName] == 'true') || (localStorage[settingName] == true) ;\r\n  },\r\n\r\n  fxEnabled: function(changed) {\r\n    var enabled = Settings._checkbox(changed, 'fxEnabled', true);\r\n    if (changed != null) {\r\n      $.fx.off = !enabled;\r\n    }\r\n    return enabled;\r\n  },\r\n\r\n  showReplies: function(changed) {\r\n    var enabled = Settings._checkbox(changed, 'showReplies', true);\r\n    if (changed != null && (typeof is_catalog === 'undefined' || !is_catalog)) {\r\n      scrollAnchor.save('replymap', '.postnode')\r\n      if (enabled) {\r\n        replyMap.showReplies()\r\n        injector.remove('hide-replies')\r\n      }\r\n      else {\r\n        injector.inject('hide-replies', '.replieslist {display: none}')\r\n      }\r\n      scrollAnchor.restore('replymap')\r\n    }\r\n    return enabled;\r\n  },\r\n\r\n  sfwMode: function(changed) {\r\n    var enabled = Settings._checkbox(changed, 'sfwMode', false);\r\n    if (enabled) {\r\n      injector.inject('sfwMode', 'figure > *, .emoji { opacity: 0.05;} figure:hover > *, .postbody:hover .emoji { opacity: 1;}');\r\n    }\r\n    else {\r\n      injector.remove('sfwMode');\r\n    }\r\n    return enabled;\r\n  },\r\n\r\n  hideCompletely: function(changed) {\r\n    var enabled = Settings._checkbox(changed, 'hideCompletely', false, true);\r\n    if (changed) {\r\n      HiddenItems.hideCompletely = enabled\r\n      HiddenItems.updateCSS()\r\n    }\r\n    return enabled;\r\n  },\r\n\r\n  expandImgFull: function(changed) {\r\n    return Settings._checkbox(changed, 'expandImgFull', false);\r\n  },\r\n\r\n  constrainWidth: function(changed) {\r\n    var enabled = Settings._checkbox(changed, 'constrainWidth', false);\r\n    if (enabled) {\r\n      injector.inject('constrainWidth', `body {\r\n        max-width: 960px;\r\n        margin: 0px auto;\r\n      }`)\r\n    }\r\n    else {\r\n      injector.remove('constrainWidth')\r\n    }\r\n  },\r\n\r\n  newMediaViewer: function(changed) {\r\n    return Settings._checkbox(changed, 'newMediaViewer', true);\r\n  },\r\n\r\n  hidePostBtn: function(changed) {\r\n    let enabled = Settings._checkbox(changed, 'hidePostBtn', true)\r\n    if (!enabled) {\r\n      injector.inject('hidePostBtn', `.hide-post-btn {display: none}`)\r\n    }\r\n    else {\r\n      injector.remove('hidePostBtn')\r\n    }\r\n    if (!changed) {\r\n      HiddenItems.lists.posts.forEach(id => {\r\n        $(`#postnode${id}`).find('.hide-post-btn').attr('title', _l.unhidePost)\r\n        .find('use').attr('xlink:href', '#i-unhide')\r\n      })\r\n    }\r\n    return enabled\r\n  }\r\n}\r\n\r\nvar rswap = {\r\n  i: true,\r\n  swap: function() {\r\n    if(this.i) $('#delform').before($('#rswapper')).after($('.postarea'));\r\n    else $('#delform').before($('.postarea')).after($('#rswapper'));\r\n    this.i = !this.i;\r\n  }\r\n}\r\n\r\nvar captchalang = getCookie('captchalang') || 'ru';\r\nfunction setCaptchaLang(lang) {\r\n  if(!in_array(lang, ['ru', 'en', 'num'])) return;\r\n  captchalang = lang;\r\n  set_cookie('captchalang', lang, 365);\r\n  pups.succ(_l.captchaLangChanged)\r\n}\r\n\r\nconst offClick = []\r\n\r\nfunction readyset() {\r\n  $('.make-me-readonly').each(function() {\r\n    $(this).attr('readonly', true)\r\n    .on('focus', function() {\r\n      $(this).removeAttr('readonly')\r\n    })\r\n  })\r\n\r\n  if(!ispage) $('.mgoback').show();\r\n  if(isTouch)\r\n    $('#js_settings').prepend('<a href=\"javascript: localStorage.setItem(\\'interfaceType\\', \\'desktop\\'); location.reload();\">'+_l.returnDesktop+'</a><br>');\r\n  else\r\n    $('#js_settings').prepend('<a href=\"javascript: localStorage.setItem(\\'interfaceType\\', \\'touch\\'); location.reload();\">'+_l.returnTouch+'</a><br>');\r\n\r\n  $('#js_settings').prepend(_l.captchalang+': <a href=\"javascript:setCaptchaLang(\\'ru\\');\">Cyrillic</a> | <a href=\"javascript:setCaptchaLang(\\'en\\');\">Latin</a> | <a href=\"javascript:setCaptchaLang(\\'num\\');\">Numeral</a><br />');\r\n\r\n  if(Styles.$cancelLink)\r\n    $('#js_settings').prepend(Styles.$cancelLink)\r\n\r\n  let pf = document.querySelector('#postform')\r\n  if (pf)\r\n    richFileInput.initForm(pf)\r\n\r\n  pups.init();\r\n  chpok.init(true)\r\n\r\n  LatexIT.init();\r\n  checkhighlight();\r\n  checkgotothread();\r\n  checknamesave();\r\n\r\n  bnrs.init();\r\n\r\n  if(getCookie('ku_menutype')) {\r\n    var c = Cookie('ku_menutype');\r\n    if(c != 'default' && c != '')\r\n      document.getElementById('overlay_menu').style.position = c;\r\n  }\r\n\r\n  //initial post-process\r\n  processNodeInsertion()\r\n\r\n  if(!isTouch) {\r\n    cloud20.init();\r\n    $('.sect-exr').mouseenter(function() { menu_show('ms-'+$(this).data('toexpand')); });\r\n    $('#overlay_menu').mouseleave(function() { menu_show('_off_'); });\r\n    $('body').on('mouseenter', \"a[class^='ref']\", function(ev) {\r\n      this.predelay = setTimeout(() => PostPreviews._mouseover.bind(this)(ev), PostPreviews._timings.predelay)\r\n    })\r\n    .on('mouseleave', \"a[class^='ref']\", PostPreviews._mouseout)\r\n    .on('click', \"a[class^='ref']\", function(e) {\r\n      e.preventDefault()\r\n      let href = this.getAttribute('href')\r\n      if (!highlight(href.split('#')[1], 0)) {\r\n        redirectTo(href)\r\n      }\r\n    })\r\n  }\r\n  else {\r\n    add_mob_menu();\r\n    $('body').addClass('touch-mode');\r\n    $('.sect-exr:not([data-toexpand=\"_options\"])').parent().hide();\r\n    $('.sect-exr').click(function() {\r\n      if($('#js_settings').is(':visible')) {\r\n        menu_show('_off_');\r\n      }\r\n      else {\r\n        menu_show('ms-_options');\r\n      }\r\n      return false;\r\n    });\r\n    offClick.push(ev => {\r\n      menu_show('_off_');\r\n      document.querySelectorAll('[id^=preview]').forEach(pre => PostPreviews._mouseout.bind(pre)(null, true))\r\n    })\r\n    $('body').on('click', \"a[class^='ref']\", PostPreviews._mouseover)\r\n    .on('doubletap', '.postnode', function(ev) {\r\n      ev.stopPropagation()\r\n      ev.preventDefault()\r\n      this.querySelector('.qrl').click()\r\n    })\r\n  }\r\n\r\n  $('html').click(ev => offClick.forEach(fn => fn(ev)))\r\n\r\n  /* ---------- All delegated events on body ---------- */\r\n  $('body')\r\n  .on('click', '.uib-mup', function() {\r\n    markup($(this).parents('form'), $(this).data('mups'), $(this).data('mupe'), $(this).data('imups'), $(this).data('imupe'));\r\n    return false;\r\n  })\r\n  .on('click', '.uib-bul', function() {\r\n    bullets($(this).parents('form'), $(this).data('bul'), $(this).data('imups'), $(this).data('imupe'));\r\n    return false;\r\n  })\r\n  .on('click', '.uib-tx', function() {\r\n    var target = $(this).data('target');\r\n    head.js('http://latex.codecogs.com/editor3.js', function() {\r\n      OpenLatexEditor(target,'phpBB','en-us', false, '','full');\r\n    });\r\n    return false;\r\n  })\r\n  //Video expanding\r\n  .on('click', '.movie', function(event) {expandVideo($(this), event)})\r\n  //new quick reply\r\n  .on('click', '.qrl', quickreply)\r\n  // ID highlighting\r\n  .on('click', '.hashpic', function() {\r\n    $('.highlight').removeClass('highlight')\r\n    let found = $(`.hashpic[alt=${$(this).attr('alt')}]`).each(function() {\r\n      $(this).parents('.posthead').parent().addClass('highlight')\r\n    }).length\r\n    pups.info(_l.found+': '+found, {time: 1.5})\r\n  })\r\n  .on('click', '.posttypeindicator a', function() { // TODO: what is this?\r\n    var xl = $(this);\r\n    var offset = $('[name=\"' + xl.attr('href').substr(1) + '\"]').offset() || $('[name=\"' + xl.text().split('>>')[1] + '\"]').offset() || false;\r\n    if(offset) {\r\n      $('html, body').animate({\r\n        scrollTop: offset.top - ( $('#overlay_menu').height() + 10 )\r\n      }, 250);\r\n    }\r\n    return false;\r\n  })\r\n  .on('click', '.dice', function() {\r\n    if(typeof $(this).data('html') === 'undefined') $(this).data('html', $(this).html());\r\n    var htm = stripHTML($(this).html());\r\n    $(this).html($(this).attr('title'));\r\n    $(this).attr('title', htm);\r\n  })\r\n  .on('click', '.reflink a', function(ev) {\r\n    ev.preventDefault()\r\n    let ref = this.parentElement\r\n    , postnode = ref._findParent('.postnode')\r\n    if (!lastActiveForm) {\r\n      quickreply.bind(postnode.querySelector('.qrl'))()\r\n    }\r\n    else {\r\n      let formBoard = is_overboard\r\n        ? lastActiveForm.getAttribute('id').match(/[0-9]+\\-(.+?)_qrf/)[1]\r\n        : this_board_dir\r\n      let postBody = postnode.querySelector('.postbody')\r\n      , qoutation = getPostQuotation(postBody)\r\n      insert(`>>${ref.dataset.b == formBoard ? '' : `/${ref.dataset.b}/`}${ref.dataset.id}\\n${qoutation}`)\r\n    }\r\n  })\r\n  //Ultimate YOBA Youtube embeds\r\n  .on('click','.embed-play-button', function(ev) {\r\n    ev.preventDefault()\r\n    unwrapEmbed($(this).parents('figure'))\r\n  })\r\n  .on('click','.collapse-video', function(ev) {\r\n    ev.preventDefault()\r\n    wrapEmbed($(this).parents('figure'))\r\n  })\r\n  .on('mouseenter', '._country_', function() {\r\n    if(typeof $(this).attr('title') === \"undefined\") {\r\n      $(this).attr('title', countries[$(this).attr('src').split('flags/')[1].split('.png')[0].toUpperCase()]);\r\n    }\r\n  })\r\n  .on('click', '.audiowrap', function(ev) {\r\n    ev.preventDefault();\r\n    let $this = $(this)\r\n    var src = $this.attr('href');\r\n    let $fig = $this.parents('figure')\r\n    if (! $fig.hasClass('unwrapped')) {\r\n      $fig.addClass('unwrapped unwrapped-audio')\r\n    }\r\n    let $fsz = $fig.find('.filesize');\r\n    if (! $fsz.find('.collapse-btn').length)\r\n      $fsz.append(`\r\n        <button title=\"${_l.collapse}\" class=\"emb-button collapse-video\">\r\n          ${makeIcon('shrink', 'b-icon')}\r\n        </button>`);\r\n    if (! $this.find('audio').length)\r\n      $this.append('<audio src=\"'+src+'\" controls autoplay=\"true\"></audio>')\r\n    $fsz.find('.collapse-video').click(function() {\r\n      $fig.removeClass('unwrapped unwrapped-audio')\r\n      .find('audio')[0].pause()\r\n    })\r\n  })\r\n  .on('change', '.multidel', function() {\r\n    let itemCount = $('.multidel:checked').length\r\n\r\n    if (! $('.item-count').length) {\r\n      $('.userdelete tbody').prepend(`<tr><td>\r\n        ${_l.selected}:&nbsp;<span class=\"item-count\"></span>\r\n        <button class=\"close-multisel icon-wraping-button\" title=\"${_l.cancel}\">${makeIcon('x', 'b-icon ', false)}</button>\r\n      </td></tr>`)\r\n      $('.close-multisel').click(function(ev) {\r\n        ev.preventDefault()\r\n        $('.multidel').prop('checked', false)\r\n        $('body').removeClass('select-multiple')\r\n        $('.userdelete').removeClass('ud-active')\r\n      })\r\n    }\r\n\r\n    if (itemCount > 0) {\r\n      $('.item-count').text(itemCount)\r\n    }\r\n    else {\r\n      $('.userdelete').removeClass('ud-active')\r\n      $('body').removeClass('select-multiple')\r\n    }\r\n  })\r\n  /* Post menu */ \r\n  .on('click', 'label.postinfo', function(ev) {\r\n    if (! $(this).find('.multidel').is(':visible')) {\r\n      ev.stopPropagation()\r\n      ev.preventDefault()\r\n      let $this = $(this)\r\n      , $menu = $this.parent().find('.post-menu')\r\n      let on = !$menu.is(':visible')\r\n      $('.post-menu').hide()\r\n      if (! $menu.length) {\r\n        let $postnode = $(this).parents('.postnode')\r\n        , board = $postnode.data('board')\r\n        , id = $postnode.data('id')\r\n        , isOP = $postnode.hasClass('op')\r\n        /*if (!isOP)\r\n          $postnode.toggleClass('post-hidden', HiddenItems.isHidden('post', id))*/\r\n        this.insertAdjacentHTML('afterend', `<div class=\"content-background post-menu\" style=\"display: none\"> \r\n          <ul>\r\n            <li class=\"menu-delete\">${makeIcon('x')}<span>${_l.del}</span></li>\r\n            ${!isOP ? `\r\n              ${typeof opmod !== 'undefined' && +opmod || 0 ? `<li class=\"menu-delete menu-delete-op\">${makeIcon('x')}<span>${_l.del} ${_l.asOP}</span></li>`: ''}\r\n              <li class=\"menu-hide\">${makeIcon('hide')}<span>${_l.hidePost}</span></li>\r\n              <li class=\"menu-unhide\">${makeIcon('unhide')}<span>${_l.unhidePost}</span></li>\r\n            `: ''}\r\n            <li class=\"menu-report\">${makeIcon('warning')}<span>${_l.report}</span></li>\r\n            <li class=\"menu-link-share\">${makeIcon('link')}<span>${_l.links}</span></li>\r\n            ${$postnode.find('.post-ttl').length ? `\r\n              <li class=\"menu-cancel-timer\">${makeIcon('untimer')}<span>${_l.cancelTimer}</span></li>\r\n            `: ''}\r\n            <li class=\"menu-select-multiple\">${makeIcon('select-multiple')}<span>${_l.selectMultiple}</span></li>\r\n            ${kumod_set ? `\r\n              <li class=\"menu-delete menu-delete-mod\">${makeIcon('x')}<span>${_l.del} ${_l.asMod}</span></li>\r\n              <a href=\"${ku_cgipath}/manage_page.php?action=bans&amp;banboard=${board}&amp;banpost=${id}\">\r\n                <li class=\"menu-ban\">${makeIcon('ban')}<span>${_l.ban}...<span></li>\r\n              </a>\r\n              ${isOP ? `\r\n                <a class=\"stickypost-btn\" onclick=\"Ajax.modThread(this, 'stickypost'); return false\"\r\n                href=\"${ku_cgipath}/manage_page.php?action=stickypost&amp;board=${board}&amp;postid=${id}\">\r\n                  <li>${makeIcon('pin')}<span>${_l.stickthread}<span></li>\r\n                </a>\r\n                <a class=\"unstickypost-btn\" onclick=\"Ajax.modThread(this, 'unstickypost'); return false\"\r\n                href=\"${ku_cgipath}/manage_page.php?action=unstickypost&amp;board=${board}&amp;postid=${id}\">\r\n                  <li>${makeIcon('unpin')}<span>${_l.unstickthread}<span></li>\r\n                </a>\r\n                <a class=\"lockpost-btn\" onclick=\"Ajax.modThread(this, 'lockpost'); return false\"\r\n                href=\"${ku_cgipath}/manage_page.php?action=lockpost&amp;board=${board}&amp;postid=${id}\">\r\n                  <li>${makeIcon('lock')}<span>${_l.lockthread}<span></li>\r\n                </a>\r\n                <a class=\"unlockpost-btn\" onclick=\"Ajax.modThread(this, 'unlockpost'); return false\"\r\n                href=\"${ku_cgipath}/manage_page.php?action=unlockpost&amp;board=${board}&amp;postid=${id}\">\r\n                  <li>${makeIcon('unlock')}<span>${_l.unlockthread}<span></li>\r\n                </a>`\r\n              : ''}`\r\n            : ''}\r\n          </ul>\r\n        </div>`)\r\n        $menu = $this.parent().find('.post-menu')\r\n      }\r\n      $menu.toggle(on)\r\n    }\r\n  })\r\n  // Figure menu is global because of FUCKING overflow\r\n  .on('click', '.file-menu-toggle', function(ev) {\r\n    ev.stopPropagation()\r\n    ev.preventDefault()\r\n    let $menu = $('.file-menu')\r\n    , $this = $(this)\r\n    , $fsz = $this.parent()\r\n    , visible = $menu.is(':visible')\r\n    $('.post-menu').hide()\r\n    if (visible && $menu[0].$boundTo[0] == $fsz[0]) return;\r\n    let ofs = $fsz.offset()\r\n    , offsetTop = $fsz.hasClass('embed-wrap') ? 22 : $fsz.outerHeight()\r\n    $menu.css({\r\n      'left': `${ofs.left}px`,\r\n      'top': `${ofs.top + offsetTop}px`,\r\n      'min-width': `${$fsz.outerWidth()}px`\r\n    }).show()\r\n    let fileid = $fsz.parents('figure').data('fileid')\r\n    , $pn = $fsz.parents('.postnode')\r\n    , board = $pn.data('board')\r\n    , pid = $pn.data('id')\r\n    $menu[0].__menuProps = {\r\n      fileid: fileid,\r\n      board: board\r\n    }\r\n    $menu[0].$boundTo = $fsz\r\n    // Set the proper link for file banning\r\n    $menu.find('.menu-banfile').attr('href', `${ku_cgipath}/manage_page.php?action=bans&banboard=${board}&banpost=${pid}&banfile=${fileid}`)\r\n  })\r\n  .on('click', '.post-menu li', ev => ev.stopPropagation())\r\n  .on('click', '.menu-select-multiple', function(ev) {\r\n    $('.post-menu').hide()\r\n    let $menu = $(this).parents('.post-menu')\r\n    , isFile = $menu.hasClass('file-menu')\r\n    , $md = (isFile ? $menu[0].$boundTo : $(this).parents('.posthead'))\r\n    .find('.multidel')\r\n    if (! $md.length) return;\r\n    $md.prop('checked', true).trigger('change')\r\n    $('.userdelete').addClass('ud-active')\r\n    $('body').addClass('select-multiple')\r\n  })\r\n  .on('click', '.menu-link-share', function(ev) {\r\n    let $this = $(this)\r\n    , isShown = $this.find('input').length\r\n    if (! isShown) {\r\n      let $postnode = $this.parents('.postnode')\r\n      , board = $postnode.data('board')\r\n      , id = $postnode.data('id')\r\n      , directLink = ku_boardspath + $postnode.find('.shl').attr('href')\r\n      $this.find('span').html(`<input class=\"pm-direct-link pm-link\" type=\"text\" value=\"${directLink}\" title=\"${_l.directLink}\">&nbsp;\r\n        <input class=\"pm-quote-link pm-link\" type=\"text\" value=\"&gt;&gt;/${board}/${id}\" title=\"${_l.quoteLink}\">`)\r\n      .css({'font-size': 0})\r\n      .find('.pm-direct-link').click()\r\n    }\r\n    else\r\n      $this.toggleClass('direct-or-quote')\r\n  })\r\n  .on('click', '.pm-link', function(ev) {\r\n    ev.stopPropagation()\r\n    let $this = $(this)\r\n    $('.pm-link').removeClass('selected')\r\n    $this.focus().select().addClass('selected')\r\n  })\r\n  .on('click', '.menu-delete', function() {\r\n    let $this = $(this)\r\n    , $menu = $this.parents('.post-menu')\r\n    , menu = $menu[0]\r\n    , isFile = $menu.hasClass('file-menu')\r\n    , $item = isFile ? $menu[0].$boundTo : $this.parents('.posthead')\r\n    , $pass = $menu.find('.menu-password')\r\n    $this.addClass('spin-around')\r\n    let fd = new FormData()\r\n    if ($menu.find('.menu-captcha').length) {\r\n      let $c = $menu.find('input[name=captcha]')\r\n      if (!$c.val()) {\r\n        $c.focus()\r\n        pups.warn(_l.enterCaptcha)\r\n        $this.removeClass('spin-around')\r\n        return;\r\n      }\r\n      fd.append('captcha', $c.val())\r\n    }\r\n    if (isFile)\r\n      fd.append('delete-file[]', menu.__menuProps.fileid)\r\n    else\r\n      fd.append('post[]', $item.parents('.postnode').data('id'))\r\n    let asMod = $this.hasClass('menu-delete-mod')\r\n    fd.append('moddelete', asMod)\r\n    fd.append('opdelete', +$this.hasClass('menu-delete-op'))\r\n    fd.append('board', isFile \r\n      ? menu.__menuProps.board\r\n      : $item.parents('.postnode').data('board'))\r\n    fd.append('postpassword', $pass.length\r\n      ? $pass.find('input').val()\r\n      : $(`#delform input[name=\"postpassword\"]`).val())\r\n    Ajax.deleteItems(fd, data => {\r\n      $this.removeClass('spin-around')\r\n      if (!data) return;\r\n      let result = data[0]\r\n      if(!result.success && $item.is(':visible')) {\r\n        if (asMod) return;\r\n        if (!$pass.length) {\r\n          $menu.prepend(`<li class=\"menu-password\">${makeIcon('password')}\r\n            <input value=\"${get_password(\"postpassword\")}\" class=\"make-me-readonly\" type=\"password\" placeholder=\"${_l.password}\" readonly onfocus=\"this.readOnly=false\"></li>`)\r\n        }\r\n        if (result.special_error && result.special_error == 'captchalocked') {\r\n          addCaptchaToMenu($menu)\r\n        }\r\n        else {\r\n          $menu.find('.menu-password input').select()\r\n          .keydown(ev => {\r\n            if (ev.key == 'Enter') {\r\n              ev.preventDefault()\r\n              ev.stopPropagation()\r\n            }\r\n          })\r\n        }\r\n      }\r\n      else if (isFile)\r\n        $('.file-menu').hide()\r\n    })\r\n  })\r\n  .on('click', '.menu-report', function() {\r\n    let $this = $(this)\r\n    , $postnode = $this.parents('.postnode')\r\n    $this.addClass('spin-around')\r\n    let fd = new FormData()\r\n    fd.append('post[]', $postnode.data('id'))\r\n    fd.append('board', $postnode.data('board'))\r\n    Ajax.reportPost(fd, data => {\r\n      $this.removeClass('spin-around')\r\n    })\r\n  })\r\n  .on('click', '.menu-hide', function() {\r\n    let $postnode = $(this).parents('.postnode')\r\n    HiddenItems.hidePost($postnode.data('id')+'-'+$postnode.data('board'))\r\n    $postnode.addClass('post-hidden')\r\n    .find('.post-menu').hide()\r\n  })\r\n  .on('click', '.menu-unhide', function() {\r\n    let $postnode = $(this).parents('.postnode')\r\n    HiddenItems.unhidePost($postnode.data('id')+'-'+$postnode.data('board'))\r\n    $postnode.removeClass('post-hidden')\r\n  })\r\n  .on('click', '.menu-cancel-timer', function() {\r\n    let $this = $(this)\r\n    , $menu = $this.parents('.post-menu')\r\n    , menu = $menu[0]\r\n    , $pass = $menu.find('.menu-password')\r\n    , $postnode = $this.parents('.postnode')\r\n    $this.addClass('spin-around')\r\n    let fd = new FormData()\r\n    if ($menu.find('.menu-captcha').length) {\r\n      let $c = $menu.find('input[name=captcha]')\r\n      if (!$c.val()) {\r\n        $c.focus()\r\n        pups.warn(_l.enterCaptcha)\r\n        $this.removeClass('spin-around')\r\n        return;\r\n      }\r\n      fd.append('captcha', $c.val())\r\n    }\r\n    fd.append('post[]', $postnode.data('id'))\r\n    fd.append('board', $postnode.data('board'))\r\n    fd.append('modsave', $this.hasClass('menu-delete-mod'))\r\n    fd.append('opsave', $this.hasClass('menu-delete-op'))\r\n    fd.append('postpassword', $pass.length\r\n      ? $pass.find('input').val()\r\n      : $(`#delform input[name=\"postpassword\"]`).val())\r\n    Ajax.cancelTimer(fd, errors => {\r\n      $this.removeClass('spin-around')\r\n      if (errors.length) {\r\n        let result = errors[0]\r\n        if (!$pass.length) {\r\n          $menu.prepend(`<li class=\"menu-password\">${makeIcon('password')}\r\n            <input value=\"${get_password(\"postpassword\")}\" class=\"make-me-readonly\" type=\"password\" placeholder=\"${_l.password}\" readonly onfocus=\"this.readOnly=false\"></li>`)\r\n        }\r\n        if (result.special_error && result.special_error == 'captchalocked') {\r\n          addCaptchaToMenu($menu)\r\n        }\r\n        else {\r\n          $menu.find('.menu-password input').select()\r\n          .keydown(ev => {\r\n            if (ev.key == 'Enter') {\r\n              ev.preventDefault()\r\n              ev.stopPropagation()\r\n            }\r\n          })\r\n        }\r\n      }\r\n      else {\r\n        $menu.find('.menu-password, .menu-captcha').remove()\r\n      }\r\n    })\r\n  })\r\n  .on('click', '.csswrap', function(ev) {\r\n    ev.preventDefault()\r\n    let cssLink = $(this).attr('href')\r\n    , styleName = $(this).parent().find('.fc-filename').text()\r\n    Styles.testStyle(cssLink, styleName)\r\n  })\r\n  .on('blur', 'input[name=\"name\"]', function() {\r\n    let isTrip = ~this.value.indexOf('#')\r\n    this.type = isTrip ? 'password' : 'text'\r\n  })\r\n  .on('focus', 'input[name=\"name\"]', function() {\r\n    this.type ='text'\r\n  })\r\n\r\n  offClick.push(ev => {\r\n    $('.post-menu').hide()\r\n  })\r\n\r\n  $(window).resize(() => {\r\n    let $fileMenu = $('.file-menu')\r\n    if (! $fileMenu.is(':visible')) return;\r\n    let $fsz = $fileMenu[0].$boundTo\r\n    , ofs = $fsz.offset()\r\n    , offsetTop = $fsz.hasClass('embed-wrap') ? 22 : $fsz.outerHeight()\r\n    $fileMenu.css({\r\n      'left': `${ofs.left}px`,\r\n      'top': `${ofs.top + offsetTop}px`,\r\n      'min-width': `${$fsz.outerWidth()}px`\r\n    })\r\n  })\r\n\r\n  $('.userdelete').addClass('content-background reflinkpreview')\r\n  .find('tbody').append(`<tr><td><input name=\"moddelete\" value=\"${_l.del} (${_l.mod_})\" type=\"submit\" class=\"styled-button bad-button\" /></td></tr>`)\r\n\r\n  $('#delform').on('submit', function(e) {\r\n    e.preventDefault()\r\n    Ajax.deleteItems(new FormData(this))\r\n    return false\r\n  })\r\n\r\n  $('.userdelete input[type=submit]').click(function(e) {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    let fd = new FormData($(this).parents('form')[0])\r\n    if (this.name == 'deletepost' || this.name == 'moddelete') {\r\n      Ajax.deleteItems(fd, null, this.name == 'moddelete')\r\n    }\r\n    if (this.name == 'cancel_timer') {\r\n      Ajax.cancelTimer(fd)\r\n    }\r\n    if (this.name == 'reportpost') {\r\n      Ajax.reportPost(fd)\r\n    }\r\n  })\r\n\r\n  /*$('input[name=reportpost]').click(function(e) {\r\n    e.preventDefault()\r\n    Ajax.reportPost(new FormData($(this).parents('form')[0]))\r\n  })*/\r\n  if (!is_overboard)\r\n    $('#delform').after('<div id=\"rswapper\">[<a onclick=\"javascript:rswap.swap();return false;\" href=\"#\">'+(ispage ? _l.NewThread : _l.reply)+'</a>]<hr /></div>');\r\n\r\n  Settings.sfwMode(false);\r\n  if (localStorage) {\r\n    for(var s in Settings) {\r\n      if (s.substring(0,1) == \"_\") continue;\r\n      $(\"#js_settings\").append('<label><input type=\"checkbox\" onchange=\"javascript:Settings.'+s+'(true)\" name=\"settings_'+s+'\" id=\"settings_'+s+'\" value=\"true\"> '+_l['settings_'+s]+'</label><br />');\r\n      Settings[s](false);\r\n    }\r\n  } else {\r\n    $(\"#js_settings\").append(\"<span style=\\\"color:#F00\\\">\"+_l.noLocalStorage+\"</span><br />   .  <a href=\\\"/web/20110329072959/http://google.com/chrome\\\" target=\\\"_blank\\\">Chome</a>, .\");\r\n  }\r\n\r\n  var textbox = document.getElementById('message');\r\n  if(textbox) {\r\n    textbox.onfocus=function(){is_entering = true;}\r\n    textbox.onblur=function(){is_entering = false;}\r\n  }\r\n\r\n  // Figure menu is global because of FUCKING overflow\r\n  $('body').append(`\r\n    <div class=\"content-background post-menu file-menu\" style=\"display: none\"> \r\n      <ul>\r\n        <li class=\"menu-delete\">${makeIcon('x')}<span>${_l.del}</span></li>\r\n        <li class=\"menu-select-multiple\">${makeIcon('select-multiple')}<span>${_l.selectMultiple}</span></li>\r\n        ${kumod_set ? `\r\n          <li class=\"menu-delete menu-delete-mod\">${makeIcon('x')}<span>${_l.del} ${_l.asMod}</span></li>\r\n          <a href=\"${ku_cgipath}/manage_page.php?action=bans\" class=\"menu-banfile\">\r\n            <li>${makeIcon('ban')}<span>${_l.ban} ${_l.file.toLowerCase()}...</span></li>\r\n          </a>` \r\n        : ''}\r\n      </ul>\r\n    </div>\r\n  `)\r\n  \r\n  //animation hooks  \r\n  $(document).on('animationstart webkitAnimationStart MSAnimationStart oanimationstart', function(event) {\r\n    var $target = $(event.target)\r\n    //detect node insertions and process them\r\n    if (event.originalEvent.animationName == \"nodeInserted\" && !$target.hasClass('_inserted_'))\r\n      processNodeInsertion($target)\r\n    //detect window resize\r\n    if (event.originalEvent.animationName == \"windowSmall\") {\r\n      document.querySelectorAll('.quick-reply-form').forEach(f => {\r\n        toggleFormFloating(f, false)\r\n        toggleFormSimplify(f, true)\r\n      })\r\n    }\r\n  });\r\n\r\n  Captcha.init(is_overboard)\r\n\r\n  initForm(document.querySelector('#postform'))\r\n\r\n  if(typeof is_catalog !== 'undefined' && is_catalog) catalog.init();\r\n\r\n  $('<div id=\"tripinfo\"></div>').addClass('content-background reflinkpreview qreplyform').hide().appendTo('body');\r\n\r\n  $('#delform').on('click', '.postertrip', function(ev) {\r\n    ev.preventDefault()\r\n    ev.stopPropagation()\r\n    var trip = $(this).text().split('!')[1]\r\n    , offset = $(this).offset(), height = $(this).height()\r\n    $.getJSON('/tripinfo.php', { trip: trip })\r\n    .done(function(data) {\r\n      var active_on = [];\r\n      _.each(data.active_on, function(board) {\r\n        active_on.push('<a target=\"_blank\" href=\"'+ku_boardspath+'/'+board+'/\">'+'/'+board+'/</a>');\r\n      })\r\n      $('#tripinfo')\r\n      .html(\r\n        '<div><b class=\"postertrip\">!'+trip+'</b> ['+'<a href=\"https://www.google.com/search?q=!'+trip+'\" target=\"_blank\">G</a>]</div>'+\r\n        '<a style=\"float:left;\" href=\"#\" onclick=\"javascript:$(\\'#tripinfo\\').hide();return false;\"><svg style=\"position: absolute; top: 3px; right: 3px;\" class=\"icon b-icon\"><use xlink:href=\"#i-x\"></use></svg></a>'+\r\n        '<div class=\"trip-info-line\">'+_l.threads+': '+data.threads+', '+_l.comments+': '+data.comments+'</div>'+\r\n        '<div class=\"trip-info-line\">'+_l.active_since+': '+catalog.formatDate(data.active_since, true)+'</div>'+\r\n        '<div class=\"trip-info-line\">'+_l.last_active+': '+catalog.formatDate(data.last_active, true)+'</div>'+\r\n        (active_on.length ? '<div class=\"trip-info-line\">'+_l.active_on+': '+active_on.join(', ')+'</div>' : '')\r\n      )\r\n      .css({\r\n         top: offset.top + height,\r\n         left: offset.left\r\n       })\r\n      .fadeIn('fast');\r\n    })\r\n    .fail(function(error) {\r\n      console.error(error)\r\n    })\r\n  })\r\n\r\n  unreadCounter.update()\r\n\r\n  if(liveupd_ena && typeof io !== 'undefined')\r\n    updater.init()\r\n\r\n  onReady.ready()\r\n}\r\n\r\n/*\r\n * jQuery Double Tap https://gist.github.com/attenzione/7098476\r\n * Developer: Sergey Margaritov (github.com/attenzione)\r\n * License: MIT\r\n * Date: 22.10.2013\r\n * Based on jquery documentation http://learn.jquery.com/events/event-extensions/\r\n */\r\n(function($){\r\n  $.event.special.doubletap = {\r\n    bindType: 'touchend',\r\n    delegateType: 'touchend',\r\n\r\n    handle: function(event) {\r\n      var handleObj   = event.handleObj,\r\n          targetData  = jQuery.data(event.target),\r\n          now         = new Date().getTime(),\r\n          delta       = targetData.lastTouch ? now - targetData.lastTouch : 0,\r\n          delay       = delay == null ? 300 : delay,\r\n          e           = event.originalEvent\r\n\r\n      if (delta < delay && delta > 30 && !(e.touches && e.touches.length > 1)) {\r\n        targetData.lastTouch = null;\r\n        event.type = handleObj.origType;\r\n        ['clientX', 'clientY', 'pageX', 'pageY'].forEach(function(property) {\r\n          event[property] = event.originalEvent.changedTouches[0][property];\r\n        })\r\n\r\n        // let jQuery handle the triggering of \"doubletap\" event handlers\r\n        handleObj.handler.apply(this, arguments);\r\n      } else {\r\n        targetData.lastTouch = now;\r\n      }\r\n    }\r\n  };\r\n})(jQuery)\r\n\r\nconst NTP = {\r\n  calc: (t0, t1, t2, t3) => ((t1 - t0) + (t2 - t3)) / 2,\r\n  sync: function(force) {\r\n    this.pending = true\r\n    let _this = this\r\n    , t0 = (new Date()).valueOf()\r\n    $.ajax({\r\n      url: '/ntp.php',\r\n      success: function(servertime) {\r\n        let t1 = servertime,\r\n            t2 = servertime,\r\n            t3 = (new Date()).valueOf()\r\n\r\n        _this.offset = _this.calc(t0, t1, t2, t3)\r\n      },\r\n      error: function() {\r\n        pups.err('Failed to synchronize time with the server')\r\n      },\r\n      complete: function() {\r\n        _this.synced = true\r\n\r\n        while (_this.stack.length) {\r\n          _this.stack.shift().resolve(_this.timeWithOffset)\r\n        }\r\n      }\r\n    });\r\n  },\r\n  offset: 0,\r\n  stack: [],\r\n  get timeWithOffset() {\r\n    return new Date(new Date().getTime() + this.offset).getTime()\r\n  },\r\n  getServerTime: function() {\r\n    if (this.synced)\r\n      return Promise.resolve(this.timeWithOffset)\r\n\r\n    let promise = externallyResolvingPromise()\r\n    if (! this.pending)\r\n      this.sync()\r\n    this.stack.push(promise)\r\n    return promise.promise\r\n  }\r\n}\r\n\r\nfunction externallyResolvingPromise() {\r\n  let promiseResolve, promiseReject\r\n  , promise = new Promise((resolve, reject) => {\r\n    promiseResolve = resolve\r\n    promiseReject = reject\r\n  });\r\n\r\n  return {\r\n    promise: promise,\r\n    resolve: promiseResolve,\r\n    reject: promiseReject\r\n  }\r\n}\r\n\r\n// this will be applied to every new inserted node (post)\r\nfunction processNodeInsertion($node) {\r\n  if(typeof $node === 'undefined')\r\n    $node = $('body');\r\n  else {\r\n    $node.addClass('_inserted_');\r\n    $node = $node.parents(\":eq(1)\");\r\n  }\r\n  if($node.find('.prettyprint').length)\r\n    prettyPrint.apply(window);\r\n  LatexIT.render($node);\r\n\r\n  // Post time-to-live updating\r\n  $node.find('.post-ttl:not(._inserted_)').each(function() {\r\n    let $this = $(this)\r\n    $this.addClass('_inserted_')\r\n    let iv\r\n    , updateTTL = () => {\r\n      if ($this.length) {\r\n        NTP.getServerTime().then(srvTime => {\r\n          let ms_left = $this.data('deleted-timestamp')*1000 - srvTime\r\n          if (ms_left >= 0) {\r\n            let min_left = Math.round(ms_left / 60000)\r\n            , h_left = Math.floor(min_left / 60)\r\n            min_left -= h_left * 60\r\n            $this.text(`${_.padLeft(h_left, 2, '0')}:${_.padLeft(min_left, 2, '0')}`)\r\n          }\r\n          else {\r\n            $.get(document.forms.delform.action) // call board.php to force delete posts\r\n            deleteItems([{action: 'delete_post', id: $this.parents('.postnode').data('id')}], false, updater.markOnly)\r\n            clearInterval(iv)\r\n          }\r\n        })\r\n      }\r\n      else\r\n        clearInterval(iv)\r\n    }\r\n    iv = setInterval(updateTTL, 30 * 1000)\r\n    updateTTL()\r\n  })\r\n}\r\n\r\nconst chpok = {\r\n  init: function(atLoad = false) {\r\n    document.body.insertAdjacentHTML('beforeend', `<audio id=\"chpok-audio\" style=\"display:none\">\r\n      <source src=\"${ku_boardspath}/images/chpok.mp3\">\r\n      <source src=\"${ku_boardspath}/images/chpok.ogg\">\r\n    </audio>`)\r\n    this.initiated = true\r\n    this.audio = document.querySelector('#chpok-audio')\r\n  },\r\n  play: function() {\r\n    if (! this.initiated)\r\n      this.init()\r\n    // In chrome the sound won't play, causing a DOM exception, if a user hasn't clicked a page at least once (and it's unfixable)\r\n    this.audio.play().catch(e => _.noop)\r\n  }\r\n}\r\n\r\nconst updater = {\r\n  newThreads: [],\r\n  init: function () {\r\n    this.socket = io.connect(liveupd_api);\r\n    let subscribeTo\r\n    if(ispage) {\r\n      subscribeTo = [liveupd_sitename+this_board_dir+':threads']\r\n      document.querySelectorAll('.postnode.op').forEach(thr => subscribeTo.push(liveupd_sitename+thr.dataset.board+':'+thr.dataset.id))\r\n    }\r\n    else {\r\n      subscribeTo = [liveupd_sitename+this_board_dir+':'+$('input[name=replythread]').val()];\r\n      _l.noNewPosts += (\"<br>\" + _l.threadUpdationAutomatically)\r\n    }\r\n    this.socket\r\n    .on('update', this.dispatch.bind(this))\r\n    .emit('subscribe', subscribeTo)\r\n    Object.defineProperty(this, 'markOnly', {\r\n      value: true,\r\n      writable: false,\r\n      configurable: false\r\n    })\r\n  },\r\n  dispatch: function(data) {\r\n    if (! data.action) {\r\n      pups.warn('Event with unspecified action, see console')\r\n      console.warn(data)\r\n      return\r\n    }\r\n    if (data.action == 'new_thread') {\r\n      // Do nothing if it is my post\r\n      if (data.token && Ajax.postToken && data.token==Ajax.postToken) return;\r\n      this.notifyAboutNewThreads(data)\r\n    }\r\n    if (data.action == 'new_reply') {\r\n      // Do nothing if it is my post\r\n      if (data.token && Ajax.postToken && data.token==Ajax.postToken) return;\r\n      if (ispage) {\r\n        this.notifyAboutNewRepliesOnBoardPage(data)\r\n      }\r\n      else {\r\n        this.showNewReplies(data)\r\n      }\r\n    }\r\n    if (data.action == 'delete') {\r\n      // Do nothing if it is my post\r\n      if (data.token && Ajax.delToken && data.token==Ajax.delToken) return;\r\n      deleteItems(data.items, false, this.markOnly)\r\n    }\r\n    if (data.action == 'cancel_timer') {\r\n      // Do nothing if it is my post\r\n      if (data.token && Ajax.timerToken && data.token==Ajax.timerToken) return;\r\n      let postsSaved = [], msg = ''\r\n      data.items.forEach(item => {\r\n        $(`.postnode[data-id=${item.id}] .post-ttl`).remove()\r\n        postsSaved.push(item.id)\r\n      })\r\n      if(postsSaved.length) {\r\n        msg = postsSaved.length > 1 ?\r\n          `${_l.posts} #${postsSaved.join(', #')} ${_l.savedMulti}.`\r\n         :`${_l.post} #${postsSaved[0]} ${_l.saved}.`\r\n        pups.info(msg, {time: 2 + postsSaved.length})\r\n      }\r\n    }\r\n  },\r\n  showNewReplies: function(data) {\r\n    newposts.get({\r\n      silent: true,\r\n      timestamp: data.timestamp,\r\n      onSuccess: () => {\r\n        if (! document.hasFocus())\r\n          chpok.play()\r\n      }\r\n    })\r\n  },\r\n  notifyAboutNewThreads: function(data) {\r\n    this.newThreads.push({\r\n      board: data.board,\r\n      board_desc: data.board_desc || false,\r\n      thread: data.new_thread_id\r\n    });\r\n    if (! document.hasFocus()) {\r\n      scrollAnchor.save('autoload', '.postnode')\r\n      this.showNewThreads(() => scrollAnchor.restore('autoload'))\r\n      chpok.play()\r\n    }\r\n    else if(!$('#wild_thread_appeared').length) {\r\n      $('#delform').before('<a class=\"xlink\" onclick=\"updater.showNewThreads();return false\" id=\"wild_thread_appeared\"><span class=\"salient\">'+_l.newThreadsAvailable+'</span><hr /></a>')\r\n    }\r\n  },\r\n  notifyAboutNewRepliesOnBoardPage: function(data) {\r\n    let room = data.room + '-' + data.board\r\n    if (! this.repliesOnBoardPage[room])\r\n      this.repliesOnBoardPage[room] = [data.reply_id]\r\n    else\r\n      this.repliesOnBoardPage[room].push(data.reply_id)\r\n    this.refreshNewRepliesCount(data.board, data.room, data.timestamp)\r\n  },\r\n  refreshNewRepliesCount(board, threadID, timestamp=null) {\r\n    let thread = threadID + '-' + board\r\n    , count = (this.repliesOnBoardPage[thread] || []).length\r\n    , $target = $('[id^=replies'+thread+']')\r\n    , $counter = $target.find('.fresh-replies')\r\n    let clearCounter = () => this.repliesOnBoardPage[thread] = []\r\n    if (count) {\r\n      if (! $counter.length) {\r\n        function loadNewReplies(callback) {\r\n          newposts.get({\r\n            threadid: thread,\r\n            onSuccess: () => {\r\n              clearCounter()\r\n              if (callback)\r\n                callback()\r\n            },\r\n            onError: (e) => {\r\n              console.error(e)\r\n              pups.err(_l.oops)\r\n            },\r\n            silent: true,\r\n            timestamp: timestamp\r\n          })\r\n        }\r\n        if (! document.hasFocus()) {\r\n          scrollAnchor.save('autoload', '.postnode')\r\n          loadNewReplies(() => scrollAnchor.restore('autoload'))\r\n          chpok.play()\r\n        }\r\n        else {\r\n          let $freshReplies = $target.append('<br class=\"fresh-replies-breaker\"><a href=\"/'+ board +'/res/'+threadID+'.html\" class=\"salient fresh-replies\">'+_l.newReplies+': <span class=\"fresh-replies-number\"></span></a>')\r\n          .find('.fresh-replies')\r\n          , freshReplies = $freshReplies[0]\r\n          $freshReplies.click(function(e) {\r\n            e.preventDefault()\r\n            if ($freshReplies.__alreadyLoading)\r\n              return;\r\n            freshReplies.__alreadyLoading = true\r\n            freshReplies.insertAdjacentHTML('afterBegin', '<div class=\"spinner\"></div>')\r\n            loadNewReplies(() => $(freshReplies).remove())\r\n          })\r\n        }\r\n      }\r\n      $target.find('.fresh-replies-number').text(count)\r\n    }\r\n    else if($counter.length) {\r\n      $counter.remove()\r\n      clearCounter()\r\n    }\r\n  },\r\n  repliesOnBoardPage: {},\r\n  showNewThreads: function(callback) {\r\n    let $wta = $('#wild_thread_appeared')\r\n    if ($wta.length)\r\n    $wta.find('span')[0].insertAdjacentHTML('afterBegin', '<div class=\"spinner\"></div>')\r\n    this.newThreads.forEach(thr => {\r\n      HTMLoader.getThread(thr.board, thr.thread, null, (err, posts) => {\r\n        if (err)\r\n          return pups.err(_l.noDataLoaded)\r\n        $wta.remove()\r\n        document.querySelector('#delform').insertAdjacentHTML('afterBegin', `\r\n            ${posts}\r\n            <div id=\"replies${thr.thread}-${thr.board}\" class=\"replies\"></div>\r\n          </div>\r\n          <br clear=\"left\" />\r\n          <hr>`);\r\n        if (is_overboard && thr.board_desc) {\r\n          document.querySelector('#delform .posthead').insertAdjacentHTML('afterbegin', \r\n            `<a href=\"/${thr.board}\" target=\"_blank\" class=\"over-boardlabel\">/${thr.board}/  ${thr.board_desc}</a>`)\r\n        }\r\n        this.socket.emit('subscribe', liveupd_sitename+thr.board+':'+thr.thread)\r\n        if (callback) \r\n          callback()\r\n      })\r\n    })\r\n    this.newThreads = [];\r\n  }\r\n}\r\n\r\nfunction deleteItems(items, bySelf=true, markOnly=false) {\r\n  let postsDeleted = []\r\n  , postErrors = []\r\n  , insideDeletedThread\r\n  , filesDeleted = []\r\n  , fileErrors = []\r\n\r\n  items.forEach(item => {\r\n    let deletedClasses = 'deleted'\r\n      + (item.by_op ? ' op-deleted' : '')\r\n      + (item.by_mod ? ' mod-deleted' : '')\r\n\r\n    if (item.action == 'delete_post' || item.itemtype == 'post') {\r\n      if (bySelf && !item.success) {\r\n        postErrors.push(item)\r\n        return\r\n      }\r\n      insideDeletedThread = false\r\n      let $thread = $(`#delform [id^=thread${item.id}]`)\r\n      , $reply = $(`#delform [id^=reply${item.id}]`)\r\n      if ($thread.length) {\r\n        if (markOnly || !ispage) {\r\n          $thread.addClass('deleted')\r\n          .find('.reply, figure').addClass(deletedClasses)\r\n          if (!ispage) {\r\n            insideDeletedThread = true\r\n            $('form[name=postform], .qrl, #rswapper').remove()\r\n            pups.warn(`${_l.thread} ${_l.deleted}!`, {time: 0})\r\n          }\r\n        }\r\n        else {\r\n          $thread.prev().remove() //unhidethread\r\n          $thread.next().remove() //br\r\n          $thread.next().remove() //hr\r\n          $thread.remove()\r\n        }\r\n      }\r\n      else if ($reply.length) {\r\n        if (markOnly)\r\n          $reply.addClass(deletedClasses)\r\n        else {\r\n          let $reply = $(`#delform [id^=reply${item.id}]`)\r\n          if ($reply.length) {\r\n            $reply.parents('.postnode').remove()\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        if (updater.repliesOnBoardPage[item.thread_id])\r\n          updater.repliesOnBoardPage[item.thread_id] = updater.repliesOnBoardPage[item.thread_id].filter(i => i!=item.id)\r\n        updater.refreshNewRepliesCount(item.thread_id)\r\n      }\r\n      if (!insideDeletedThread)\r\n        postsDeleted.push('#'+item.id)\r\n    }\r\n\r\n    if (item.action == 'delete_file'  || item.itemtype == 'file') {\r\n      if (bySelf && !item.success) {\r\n        fileErrors.push(item)\r\n        return\r\n      }\r\n      let $fig = $(`figure[data-fileid=${item.id}]`)\r\n      if (markOnly)\r\n        $fig.addClass(deletedClasses)\r\n      else\r\n        $fig.replaceWith(`<div class=\"nothumb\">${_l.fileRemoved}</div>`)\r\n      filesDeleted.push('#'+item.id)\r\n    }\r\n\r\n    if (item.action == 'delete_thread') { // A notification about deleted\r\n      updater.newThreads = updater.newThreads.filter(i => i!=item.id)\r\n      if (! updater.newThreads.length)\r\n        $('#wild_thread_appeared').remove();\r\n      pups.info(`${_l.thread} ${item.id} ${_l.deleted}.`)\r\n    }\r\n  })\r\n\r\n  if (! $('.multidel').is(\":checked\") && ! $('.multidel.delete-file').is(\":checked\")) {\r\n    $('.userdelete').removeClass('ud-active')\r\n    $('body').removeClass('select-multiple')\r\n  }\r\n    \r\n  if (postsDeleted.length) {\r\n    let msg = postsDeleted.length > 1\r\n      ? `${_l.posts} ${postsDeleted.join(', ')} ${_l.deletedMulti}.`\r\n      : `${_l.post} ${postsDeleted[0]} ${_l.deleted}.`\r\n    pups[bySelf ? 'succ' : 'info'](msg, {time: 2 + postsDeleted.length})\r\n  }\r\n  if (filesDeleted.length) {\r\n    let msg = filesDeleted.length > 1\r\n      ? `${_l.files} ${filesDeleted.join(', ')} ${_l.deletedMulti}.`\r\n      : `${_l.file} ${filesDeleted[0]} ${_l.deleted}.`\r\n    pups[bySelf ? 'succ' : 'info'](msg, {time: 2 + filesDeleted.length})\r\n  }\r\n  if (postErrors.length)\r\n    pups.err(postErrors.map(err => `${_l.post} #${err.id}: ${err.message}`).join('<br>'), \r\n      {time: 2 + postErrors.length})\r\n  if (fileErrors.length) {\r\n    pups.err(fileErrors.map(err => `${_l.file} #${err.id}: ${err.message}`).join('<br>'), \r\n      {time: 2 + fileErrors.length})\r\n  }\r\n}\r\n\r\nif (+localStorage['localmod']) {\r\n  kumod_set = true\r\n}\r\nelse {\r\n  let kumod = getCookie('kumod');\r\n  if (kumod !== '') {\r\n    if (kumod === 'allboards')\r\n      kumod_set = true\r\n    else\r\n      kumod_set = in_array(this_board_dir, kumod.split('|'));\r\n  }\r\n}\r\n\r\nfunction expandVideo_old($mov, ev) {\r\n  //good luck understanding this shitcode :^)\r\n  let $reply = $mov.parents('.reply')\r\n  if($mov.data('expanded') !== '1') {\r\n    ev.preventDefault();\r\n    var movieurl = $mov.attr('href'), imgh = $mov.data('height'), imgw = $mov.data('width'), dt = $mov.data('thumb'), postnum = $mov.data('id');\r\n    var uid = '_vframe_'+randomString(5)+(new Date().getTime());\r\n    $mov.replaceWith(function() {\r\n      return '<span id=\"'+uid+'\" data-thumb=\"'+dt+'\" data-width=\"'+imgw+'\"\" data-height=\"'+imgh+'\" data-href=\"'+movieurl+'\">'+this.innerHTML + '</span>';\r\n    });\r\n    $mov = $(\"#\"+uid);\r\n    $mov.find('img').hide();\r\n    var video = $mov.find('video').show(), notice = '';\r\n    if(!video.length) {\r\n      $mov.find('.playable-thumb').append('<video class=\"thumb\" src=\"'+movieurl+'\" controls loop autoplay height=\"'+imgh+'\" width=\"'+imgw+'\"></video>').promise().done(function() {\r\n        video = $mov.find('video');\r\n      });\r\n      video[0].volume = localStorage['mediaVolume'] || 1\r\n      video[0].onvolumechange = function() {\r\n        localStorage['mediaVolume'] = this.muted ? 0 : this.volume\r\n      }\r\n    }\r\n    else video.get(0).play();\r\n    if(!Settings.expandImgFull()) {\r\n      var offset = 50, offset_el = video[0];\r\n      var max_w = document.documentElement?document.documentElement.clientWidth : document.body.clientWidth;\r\n      while (offset_el != null) {\r\n        offset += offset_el.offsetLeft;\r\n        offset_el = offset_el.offsetParent;\r\n      }\r\n      var new_w = max_w - offset;\r\n      if(imgw > new_w) {\r\n        var ratio = imgw / imgh;\r\n        var zoom = 1 - new_w / imgw;\r\n        var new_h = new_w / ratio;\r\n        video.width(new_w);\r\n        video.height(new_h);\r\n        notice = _l.videoDownscaledBy + \" \" + Math.round(zoom*100) + \"% \"+_l.toFit;\r\n      }\r\n    }\r\n    let $fig = $mov.parents('figure');\r\n    if (! $fig.hasClass('unwrapped')) {\r\n      $fig.addClass('unwrapped')\r\n    }\r\n    let $fsz = $mov.parent().find('.filesize');\r\n    if (! $fsz.find('.collapse-btn').length) {\r\n      $fsz.append(`\r\n        <button title=\"${_l.collapse}\" class=\"emb-button collapse-video\">\r\n          ${makeIcon('shrink', 'b-icon')}\r\n        </button>`);\r\n      $mov.parent().find('.collapse-video').click(function() {\r\n        $fig.removeClass('unwrapped')\r\n        var uid = '_vframe_'+randomString(5)+(new Date().getTime());\r\n        $mov.replaceWith(function() {\r\n          return '<a class=\"movie\" id=\"'+uid+'\" data-thumb=\"'+dt+'\" data-width=\"'+imgw+'\"\" data-height=\"'+imgh+'\" href=\"'+movieurl+'\">'+this.innerHTML + '</a>';\r\n        }).data('expanded', '0');\r\n        $mov = $(\"#\"+uid);\r\n        $mov.find('video').hide()[0].pause();\r\n        $mov.find('img').show();\r\n        $(this).remove();\r\n        $mov.parents('.reply').removeClass('reply-expanded')\r\n        return false;\r\n      });\r\n    }\r\n    $mov.parents('.reply').addClass('reply-expanded')\r\n  }\r\n}\r\n\r\nfunction expandVideo($mov, ev) {\r\n  ev.preventDefault()\r\n  if (Settings.newMediaViewer()) {\r\n    let mv = new MediaViewer(...MediaViewer.parseVideo($mov[0]), true)\r\n    mv.onCollapse = () => mv = null\r\n  }\r\n  else {\r\n    expandVideo_old($mov, ev)\r\n  }\r\n  return false\r\n}\r\n\r\nfunction checknamesave() {\r\n  var checkd;\r\n  if(getCookie('name') != '') {\r\n    checkd = true;\r\n  } else {\r\n    checkd = false;\r\n  }\r\n  var doc = document.getElementById('save');\r\n  if (doc != null) doc.checked = checkd;\r\n}\r\nfunction checkgotothread() {\r\n  var checkd;\r\n  if(getCookie('tothread') == 'off') {\r\n    checkd = false;\r\n  } else {\r\n    checkd = true;\r\n  }\r\n  $(\"#gotothread\").attr('checked', checkd);\r\n}\r\n\r\nfunction navigatepages (event) {\r\n  if (!document.getElementById) return;\r\n    if (is_entering) return;\r\n  if (window.event) event = window.event;\r\n  if (event.ctrlKey) {\r\n    var link = null;\r\n    var href = null;\r\n    var docloc = document.location.toString();\r\n    if (docloc.indexOf('/res/') != -1) {\r\n      if(event.key=='Enter') {\r\n        handleCtrlEnter(event)\r\n      }\r\n    }\r\n    else {\r\n      if (docloc.indexOf('.html') == -1 || docloc.indexOf('board.html') != -1) {\r\n        var page = 0;\r\n        var docloc_trimmed = docloc.substr(0, docloc.lastIndexOf('/') + 1);\r\n      } else {\r\n        var page = docloc.substr((docloc.lastIndexOf('/') + 1));\r\n        page = (+page.substr(0, page.indexOf('.html')));\r\n        var docloc_trimmed = docloc.substr(0, docloc.lastIndexOf('/') + 1);\r\n      }\r\n      if (page == 0) {\r\n        var docloc_valid = docloc_trimmed;\r\n      } else {\r\n        var docloc_valid  = docloc_trimmed + page + '.html';\r\n      }\r\n      let match;\r\n      if(match=/#s([0-9]+)/.exec(docloc)) {\r\n        var relativepost = (+match[1]);\r\n      } else {\r\n        var relativepost = -1;\r\n      }\r\n      var maxthreads = 0;\r\n      while(document.getElementsByName('s'+(++maxthreads)).length>0){}\r\n      switch (event.key)\r\n      {\r\n        case 'Enter':\r\n          handleCtrlEnter(event)\r\n          break;\r\n\r\n        case 'ArrowLeft':\r\n          link = document.getElementById('prevPage');\r\n          break;\r\n        case 'ArrowRight':\r\n          link = document.getElementById('nextPage');\r\n          break;\r\n\r\n        case 'ArrowDown':\r\n          if (relativepost == maxthreads - 1) {\r\n            break; //var newrelativepost = 0;\r\n          } else {\r\n            var newrelativepost = relativepost + 1;\r\n          }\r\n          href = docloc_valid + '#s' + newrelativepost;\r\n          break;\r\n\r\n        case 'ArrowUp':\r\n          if (relativepost == -1 || relativepost == 0) {\r\n            break; //var newrelativepost = maxthreads - 1;\r\n          } else {\r\n            var newrelativepost = relativepost - 1;\r\n          }\r\n          href = docloc_valid + '#s' + newrelativepost;\r\n          break;\r\n\r\n        case 'Home': // ctrl+home\r\n          document.location = docloc_trimmed;\r\n          break;\r\n      }\r\n\r\n      if (link && link.action) document.location = link.action;\r\n      if (href) redirectTo(href);\r\n    }\r\n  }\r\n  else {\r\n    let mv = document.querySelector('.media-viewer:not(.mv-transparent)')\r\n    if (mv) {\r\n      if (event.key == 'ArrowLeft')\r\n        mv.querySelector('.mv-prev').click()\r\n      if (event.key == 'ArrowRight')\r\n        mv.querySelector('.mv-next').click()\r\n      if (event.key == 'Escape')\r\n        mv.querySelector('.mv-close').click()\r\n    }\r\n  }\r\n}\r\nif (window.document.addEventListener) { // how fucking old is this jeez\r\n   window.document.addEventListener(\"keydown\", navigatepages, false);\r\n} else {\r\n   window.document.attachEvent(\"onkeydown\", navigatepages);\r\n}\r\n\r\nNodeList.prototype.forEach = Array.prototype.forEach;\r\nNodeList.prototype.map = Array.prototype.map;\r\n\r\n// More efficient parent finder\r\nElement.prototype._findParent = function(selector) {\r\n  let node = this\r\n  while(node && !node.matches(selector)) {\r\n    node = node.parentNode\r\n    if (! node.matches) return null;\r\n  }\r\n  return node\r\n}\r\nElement.prototype._findNext = function(selector) {\r\n  let node = this.nextElementSibling\r\n  while(node && !node.matches(selector)) {\r\n    node = node.nextElementSibling\r\n    if (! node) return null\r\n  }\r\n  return node\r\n}\r\nElement.prototype._findPrevious = function(selector) {\r\n  let node = this.previousElementSibling\r\n  while(node && !node.matches(selector)) {\r\n    node = node.previousElementSibling\r\n    if (! node) return null\r\n  }\r\n  return node\r\n}\r\nNode.prototype._isChildOf = function(parent) {\r\n  let node = this.parentNode\r\n  while (node) {\r\n    if (node == parent) {\r\n      return true\r\n    }\r\n    node = node.parentNode\r\n  }\r\n  return false\r\n}\r\n\r\nvar replyMap = {\r\n  showReplies: function(root=document) {\r\n    root.querySelectorAll('.postnode').forEach(post => {\r\n      let postNum = post.dataset.id\r\n      , board = post.dataset.board\r\n      , thread = post._findParent('div[id^=thread]')\r\n      , threadID = thread && thread.dataset['threadid']\r\n      , msg = post.querySelector('.postmessage')\r\n      , repliesContainer = post.querySelector('.replieslist')\r\n      if (!this.posts[board])\r\n        this.posts[board] = {}\r\n      if (this.posts[board][postNum]) {\r\n        this.posts[board][postNum].container = repliesContainer\r\n      }\r\n      else {\r\n        this.posts[board][postNum] = {\r\n          container: repliesContainer,\r\n          replies: []\r\n        }\r\n      }\r\n      let links = msg.querySelectorAll(`a[class^=ref\\\\|]`)\r\n      if (links.length) links.forEach(link => {\r\n        let linkData = link.className.split(' ')[0].split('|')\r\n        , linkDestBoard = linkData[1]\r\n        , linkPostNum = linkData[3]\r\n        , href = `/${board}/res/${threadID}.html#${postNum}`\r\n        , htm = `<a class=\"ref-reply\" href=\"${href}\">&gt;&gt;${board == linkDestBoard ? '' : `/${board}/`}${postNum}</a>`\r\n        if (this.posts[linkDestBoard] && this.posts[linkDestBoard][linkPostNum]) {\r\n          if (! _.includes(this.posts[linkDestBoard][linkPostNum].replies, htm)) {\r\n            this.posts[linkDestBoard][linkPostNum].replies.push(htm)\r\n          }\r\n        }\r\n        else {\r\n          if (!this.posts[linkDestBoard])\r\n            this.posts[linkDestBoard] = {}\r\n          this.posts[linkDestBoard][linkPostNum] = {\r\n            replies: [htm]\r\n          }\r\n        }\r\n        this.posts[linkDestBoard][linkPostNum].skip = false\r\n      })\r\n    })\r\n    _.each(this.posts, board => _.each(board, post => {\r\n      if (!post.skip && post.replies.length && post.container) {\r\n        post.container.innerHTML = `${_l.replies}: ${post.replies.join(', ')}`\r\n        post.skip = true\r\n      }\r\n    }))\r\n  },\r\n  posts: {}\r\n}\r\n\r\nvar scrollAnchor = {\r\n  save: function(id, elements, parent=window, dimensions='v') {\r\n    if (!window.scrollY) {\r\n      this.saved[id] = {_top: true}\r\n      return\r\n    }\r\n    let mid = [window.innerWidth / 2, window.innerHeight / 2]\r\n    , elMap = []\r\n    , parentBCR = (parent != window)\r\n      ? parent.getBoundingClientRect()\r\n      : {\r\n        left: 0,\r\n        top: 0,\r\n        right: window.innerWidth,\r\n        bottom: window.innerHeight\r\n      }\r\n    if (\r\n      parent != window\r\n      &&\r\n      (\r\n        (parentBCR.left <= 0 && parentBCR.right <= 0)\r\n        ||\r\n        (parentBCR.top <= 0 && parentBCR.bottom <= 0)\r\n        ||\r\n        parentBCR.left >= window.innerWidth\r\n        ||\r\n        parentBCR.top >= window.innerHeight\r\n      )\r\n    ) {\r\n      mid = [parentBCR.left + parentBCR.width/2, parentBCR.top + parentBCR.height/2]\r\n    }\r\n    let elems = elements instanceof Node\r\n      ? [elements]\r\n      : elements instanceof NodeList\r\n        ? elements\r\n        : ((parent == window ? document : parent).querySelectorAll(elements))\r\n    if (! elems.length) return;\r\n    elems.forEach(function (el) {\r\n      let bcr = el.getBoundingClientRect()\r\n      , relativeVisibleWidth = Math.pos(bcr.width - (Math.pos(parentBCR.left - bcr.left) + Math.pos(bcr.right - parentBCR.right))) / bcr.width\r\n      , relativeVisibleHeight = Math.pos(bcr.height - (Math.pos(parentBCR.top - bcr.top) + Math.pos(bcr.bottom - parentBCR.bottom))) / bcr.height\r\n      , dx = Math.abs(mid[0] - (bcr.left + bcr.width/2))\r\n      , dy = Math.abs(mid[1] - (bcr.top + bcr.height/2))\r\n      elMap.push({\r\n        el: el,\r\n        primaryVisibility: dimensions[0] == 'h' ? relativeVisibleWidth : relativeVisibleHeight,\r\n        secondaryVisibility: dimensions[0] == 'v' ? relativeVisibleWidth : relativeVisibleHeight,\r\n        primaryOffset: dimensions[0] == 'h' ? dx : dy,\r\n        secondaryOffset: dimensions[0] == 'v' ? dx : dy\r\n      })\r\n    })\r\n    elMap.sort((a, b) => {\r\n      if (b.primaryVisibility !== a.primaryVisibility) {\r\n        return b.primaryVisibility - a.primaryVisibility\r\n      }\r\n      else if (dimensions.length > 1 && b.secondaryVisibility !== a.secondaryVisibility) {\r\n        return b.secondaryVisibility - a.secondaryVisibility\r\n      }\r\n      else if (a.primaryOffset !== b.primaryOffset) {\r\n        return a.primaryOffset - b.primaryOffset\r\n      }\r\n      else if (dimensions.length > 1) {\r\n        return a.secondaryOffset - b.secondaryOffset\r\n      }\r\n    })\r\n    let anchor = elMap[0].el\r\n    , bcrBefore = anchor.getBoundingClientRect()\r\n    this.saved[id] = {\r\n      anchor: anchor,\r\n      left: bcrBefore.left,\r\n      top: bcrBefore.top,\r\n      parent: parent,\r\n      dimensions: dimensions\r\n    }\r\n  },\r\n  restore: function(id) {\r\n    return new Promise((resolve, reject) => {\r\n      let loaded = this.saved[id]\r\n      if (loaded) window.requestAnimationFrame(() => {\r\n        if (loaded._top) {\r\n          window.scrollTo(0,0)\r\n          resolve()\r\n          return\r\n        }\r\n        let bcrAfter = loaded.anchor.getBoundingClientRect()\r\n        loaded.parent.scrollBy(\r\n          loaded.dimensions.indexOf('h') !== (-1) \r\n            ? bcrAfter.left - loaded.left \r\n            : 0, \r\n          loaded.dimensions.indexOf('v') !== (-1) \r\n            ? bcrAfter.top - loaded.top \r\n            : 0\r\n        )\r\n        resolve()\r\n      })\r\n      else reject()\r\n    })\r\n  },\r\n  saved: {}\r\n}\r\nMath.pos = x => x >= 0 ? x : 0;\r\n\r\n// requestAnimationFrame polyfill https://gist.github.com/paulirish/1579671\r\n(function() {\r\n  var lastTime = 0;\r\n  var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n  for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n    window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\r\n    window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];\r\n  }\r\n\r\n  if (!window.requestAnimationFrame)\r\n    window.requestAnimationFrame = function(callback, element) {\r\n      var currTime = new Date().getTime();\r\n      var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n      var id = window.setTimeout(function() { callback(currTime + timeToCall); }, timeToCall);\r\n      lastTime = currTime + timeToCall;\r\n      return id;\r\n    };\r\n\r\n  if (!window.cancelAnimationFrame)\r\n    window.cancelAnimationFrame = function(id) {\r\n      clearTimeout(id);\r\n    };\r\n}());\r\n\r\n/// overlay menu\r\nvar menu_current = '';\r\nvar menu_last = '';\r\nfunction menu_show(id)\r\n{\r\n  if(menu_current != '')\r\n  {\r\n    var dl = (id == '_off_') ? 125 : 0;\r\n    $('#'+menu_current).delay(dl).slideUp(100);\r\n    menu_last = menu_current;\r\n  }\r\n  if (id != '') {\r\n    if (menu_last == id && typeof $('#' + id).queue() !== 'undefined' && $('#' + id).queue().length > 0) {\r\n      $('#' + id).clearQueue();\r\n    } else {\r\n      $('#' + id).slideDown(150);\r\n    }\r\n  }\r\n  menu_current = id;\r\n}\r\nfunction menu_pin() {\r\n  if(document.getElementById('overlay_menu').style.position == 'absolute') {\r\n    document.getElementById('overlay_menu').style.position = 'fixed';\r\n    Cookie('ku_menutype', 'fixed', 365);\r\n  } else {\r\n    document.getElementById('overlay_menu').style.position = 'absolute';\r\n    Cookie('ku_menutype', 'absolute', 365);\r\n  }\r\n}\r\n\r\nfunction toggle_oldmenu(on=null) {\r\n  if (on===null)\r\n    on = getCookie('ku_oldmenu') != 'yes'\r\n  injector.inject('oldmenu', `#${on ? 'overlay_menu' : 'head_oldmenu'} { display: none }`)\r\n  if (on && !document.getElementById('head_oldmenu')) {\r\n    document.getElementById('boardlist_header').insertAdjacentHTML('afterBegin', `<div id=\"head_oldmenu\" class=\"boardlist\">\r\n      ${document.getElementById('ns_oldmenu').innerText}\r\n      <a href=\\\"#\\\" onclick=\\\"javascript:toggle_oldmenu();\\\" class=\"bl-sect\" style=\"order:1\">[overlay]</a>\r\n    </div>`)\r\n  }\r\n  Cookie('ku_oldmenu', on ? 'yes' : 'no', 90); \r\n}\r\n\r\nvar LatexIT = {\r\n  mode : 'gif',\r\n  init : function() {\r\n  if(document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\"))\r\n    this.mode='svg';\r\n  },\r\n  odc: \"javascript:LatexIT.replaceWithSrc(this);\",\r\n  dcls: \"Double click to show source\",\r\n\r\n  pre : function(eqn) {\r\n    var txt=eqn.innerHTML;\r\n    if ( !txt.match(/<img.*?>/i) && !txt.match(/<object.*?>/i))\r\n    {\r\n      //Clean code\r\n      txt=txt.replace(/<br>/gi,\"\").replace(/<br \\/>/gi,\"\").replace(/&amp;/mg,'&');\r\n      var atxt = \"[tex]\"+txt+\"[/tex]\";\r\n      txt=escape(txt.replace(/\\\\/mg,'\\\\'));\r\n      // Add coloring according to style of text\r\n      var c = eval(\"LatexIT.normalize\"+$(eqn).parent().css('color'));\r\n      var extxt = \"{\\\\color[rgb]{\"+c.r+','+c.g+','+c.b+\"}\"+txt+\"}\";\r\n      txt = \" <img src=\\\"http://latex.codecogs.com/\"+this.mode+\".latex?\"+ extxt +\"\\\" title=\\\"\"+this.dcls+\"\\\" alt=\\\"\"+atxt+\"\\\" ondblclick=\\\"\"+this.odc+\"\\\" border=\\\"0\\\" class=\\\"latex\\\" /> \";\r\n    }\r\n    return txt;\r\n  },\r\n\r\n  replaceWithSrc: function(eqn) {\r\n    var txt = $(eqn).attr('alt');\r\n    $(eqn).parent().html(txt);\r\n  },\r\n\r\n  render : function($scope) {\r\n    var scope = (typeof $scope === 'undefined') ? window.document : $scope[0];\r\n    var eqn = scope.getElementsByTagName(\"*\");\r\n    for (var i=0; i<eqn.length; i++) {\r\n      if(eqn[i].getAttribute(\"lang\") == \"latex\" || eqn[i].getAttribute(\"xml:lang\") == \"latex\")\r\n      eqn[i].innerHTML = this.pre(eqn[i]);\r\n    }\r\n  },\r\n\r\n  normalizergb : function(r, g, b) {\r\n    return {r: (r/255).toFixed(3), g: (g/255).toFixed(2), b: (b/255).toFixed(2) }\r\n  },\r\n  normalizergba : function(r, g, b, a) {\r\n    return this.normalizergb(r, g, b);\r\n  }\r\n};\r\n\r\nfunction in_array(needle, haystack) {\r\n  return (typeof haystack !== 'object') ? (needle === haystack) : _.includes(haystack, needle)\r\n}\r\n\r\n(function($) {\r\n  $.fn.drags = function(opt) {\r\n    opt = $.extend({handle:\"\",cursor:\"move\"}, opt);\r\n\r\n    if(opt.handle === \"\") {\r\n      var $el = this;\r\n    } else {\r\n      var $el = this.find(opt.handle);\r\n    }\r\n\r\n    return $el.css('cursor', opt.cursor).on(\"mousedown\", function(e) {\r\n      if(opt.handle === \"\") {\r\n        var $drag = $(this).addClass('draggable');\r\n      } else {\r\n        var $drag = $(this).addClass('active-handle').parent().addClass('draggable');\r\n      }\r\n      var z_idx = $drag.css('z-index'),\r\n        drg_h = $drag.outerHeight(),\r\n        drg_w = $drag.outerWidth(),\r\n        pos_y = $drag.offset().top + drg_h - e.pageY,\r\n        pos_x = $drag.offset().left + drg_w - e.pageX;\r\n      $drag.css('z-index', 1000).parents().on(\"mousemove\", function(e) {\r\n        if (opt.onMove)\r\n          opt.onMove()\r\n        $('.draggable').offset({\r\n          top:e.pageY + pos_y - drg_h,\r\n          left:e.pageX + pos_x - drg_w\r\n        }).on(\"mouseup\", function() {\r\n          $(this).removeClass('draggable').css('z-index', z_idx);\r\n        });\r\n      });\r\n      e.preventDefault(); // disable selection\r\n    }).on(\"mouseup\", function() {\r\n      if(opt.handle === \"\") {\r\n        $(this).removeClass('draggable');\r\n      } else {\r\n        $(this).removeClass('active-handle').parent().removeClass('draggable');\r\n      }\r\n    });\r\n  }\r\n  $.fn.dragsOff = function(opt) {\r\n    opt = $.extend({handle:\"\",cursor:\"default\"}, opt);\r\n\r\n    if(opt.handle === \"\") {\r\n     var $el = this;\r\n     $(this).removeClass('draggable');\r\n    } else {\r\n     var $el = this.find(opt.handle);\r\n     $(this).removeClass('active-handle')\r\n        .parent()\r\n        .removeClass('draggable');\r\n    }\r\n    return $el.css('cursor', \"default\")\r\n      .off(\"mousedown\")\r\n      .off(\"mouseup\")\r\n      .off(\"mousemove\");\r\n  }\r\n  /*$.fn.pin = function() {\r\n    if(this.css('position') !== 'fixed') {\r\n      var abs = {\r\n        top: this.position().top - $(document).scrollTop(),\r\n        left: this.position().left - $(document).scrollLeft()\r\n      }\r\n      this.css({\r\n        position: 'fixed',\r\n        left: abs.left,\r\n        top: abs.top\r\n      });\r\n      this.find('.pinner').removeClass('pinned').addClass('unpinned');\r\n      localStorage['pinForm'] = 0;\r\n    }\r\n    else {\r\n      var abs = {\r\n        top: this.position().top + $(document).scrollTop(),\r\n        left: this.position().left + $(document).scrollLeft()\r\n      }\r\n      this.css({\r\n        position: 'absolute',\r\n        left: abs.left,\r\n        top: abs.top\r\n      });\r\n      this.find('.pinner').removeClass('unpinned').addClass('pinned');\r\n      localStorage['pinForm'] = 1;\r\n    }\r\n  }*/\r\n})(jQuery);\r\n\r\nfunction unwrapEmbed($fig) {\r\n  $fig.addClass('unwrapped')\r\n  let $iw = $fig.find('.emb-iframe-wrapper')\r\n  if ($iw.data('h') > $iw.data('w'))\r\n    $iw.addClass('vertical-video')\r\n  if ($iw.data('site') == \"Soundcloud\")\r\n    $iw.addClass('soundcloud-embed')\r\n  $iw.css({\r\n    paddingBottom: `${($iw.data('h')/$iw.data('w'))*100}%`\r\n  })\r\n  let code = $iw.data('code')\r\n  , iframeOptions = `frameborder=\"0\" scrolling=\"no\" webkitallowfullscreen=\"\" mozallowfullscreen=\"\" allowfullscreen=\"\"`\r\n  if ($iw.data('site') == \"Youtube\") {\r\n    let start = $iw.data('startraw')\r\n    $iw.append(`<iframe src=\"https://www.youtube-nocookie.com/embed/${code}?autoplay=1${start ? `&start=${start}` : ''}\" ${iframeOptions}></iframe>`)\r\n  }\r\n  if ($iw.data('site') == \"Vimeo\") {\r\n    let start = $iw.data('start')\r\n    $iw.append(`<iframe src=\"//player.vimeo.com/video/${code}?badge=0&autoplay=1${start ? `#t=${start}` : ''}\" ${iframeOptions}></iframe>`)\r\n  }\r\n  if ($iw.data('site') == \"Soundcloud\") {\r\n    let enccode = encodeURI(code)\r\n    let start = $iw.data('start')\r\n    $iw.append(`<iframe src=\"https://w.soundcloud.com/player/?url=https%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F${enccode}\" ${iframeOptions}></iframe>`)\r\n  }\r\n  if ($iw.data('site') == \"Coub\")\r\n    $iw.append(`<iframe src=\"http://coub.com/embed/${code}?muted=false&autostart=true&originalSize=false&hideTopBar=false&noSiteButtons=false&startWithHD=false\" ${iframeOptions}></iframe>`)\r\n  let $ew = $fig.find('.embed-wrap')\r\n  if (! $ew.find('.collapse-video').length)\r\n    $fig.find('.embed-wrap').append(`\r\n      <button title=\"${_l.collapse}\" class=\"emb-button collapse-video\">\r\n        ${makeIcon('shrink')}\r\n      </button>`)\r\n}\r\n\r\nfunction wrapEmbed($fig) {\r\n  $fig.removeClass('unwrapped')\r\n  $fig.find('.emb-iframe-wrapper').empty()\r\n}\r\n\r\nfunction resetForm(form, isClone=false) {\r\n  let fields = form.querySelectorAll('input[type=text]:not([name=name]), input[type=file], textarea')\r\n  fields.forEach(field => field.value = null)\r\n  form.querySelectorAll('.site-indicator').forEach(i => i.remove())\r\n  richFileInput.clear(form, !isClone)\r\n  // Remove extra inputs\r\n  form.querySelectorAll('input[name^=addembed], input[name^=addfile], input[name=ttl-enable]').forEach(i => {\r\n    i.checked = false\r\n    if (i.name == 'ttl-enable' && i.onchange)\r\n      i.onchange()\r\n  })\r\n}\r\n\r\nfunction initForm(form) {\r\n  if (!form)\r\n    return\r\n  let $form = $(form)\r\n  form.querySelectorAll('input[name^=embed]').forEach(i => {\r\n    i.addEventListener('input', function() {\r\n      let indicator = this.parentElement.querySelector('.site-indicator')\r\n      if (indicator) \r\n        indicator.remove()\r\n      let match = embedLinks.process(this.value)\r\n      if(match)\r\n        this.insertAdjacentHTML('afterend', `<img src=\"${ku_boardspath}/images/site-logos/${match.site}.png\" class=\"site-indicator\">`)\r\n    })\r\n  })\r\n  form.querySelectorAll('input[name^=imagefile]').forEach(i => {\r\n    i.addEventListener('change', function() {\r\n      if (this.value) {\r\n        let nextCheckbox = this.parentElement.nextElementSibling\r\n        if (nextCheckbox)\r\n          nextCheckbox.checked = true\r\n      }\r\n    })\r\n  })\r\n  // Markup\r\n  form.querySelectorAll('.opt-exp').forEach(exp => {\r\n    exp.onclick = function(ev) {\r\n      ev.preventDefault()\r\n      this.querySelector('.expandee').classList.toggle('expanded')\r\n    }\r\n    exp.onmouseleave = function(ev) {\r\n      this.hideTimeout = setTimeout(() => this.querySelector('.expandee').classList.remove('expanded'), 250)\r\n    }\r\n    exp.onmouseenter = function() {\r\n      clearTimeout(this.hideTimeout)\r\n    }\r\n  })\r\n  let cms = form.querySelector('.code_markup_select')\r\n  if (cms) {\r\n    cms.onchange = function() {\r\n      markup($form, `[code=${this.value}]`, '[/code]')\r\n    }\r\n  }\r\n  form.querySelector('.quote_select').onchange = function() {\r\n    quotes($form, this.value)\r\n  }\r\n  // for TeX\r\n  let areaID = form.id + '_textarea'\r\n  form.querySelector('textarea').id = areaID\r\n  form.querySelector('.uib-tx').dataset.target = areaID\r\n  // captcha\r\n  if (Captcha.enabled && Captcha.enabled!=='only-access')\r\n    Captcha.initForm(form)\r\n  // readonly stuff\r\n  form.querySelectorAll('.make-me-readonly').forEach(ro => {\r\n    ro.readOnly = true\r\n    ro.addEventListener('focus', () => ro.readOnly = false)\r\n  })\r\n  // Name disabling\r\n  let name = form.querySelector('input[name=disable_name]')\r\n  if (name) {\r\n    name.onchange = function() {\r\n      let off = this.checked\r\n      form.querySelector('input[name=name]').disabled = off\r\n      localStorage.setItem('post_anonymously', +off)\r\n    }\r\n    name.checked = !!+localStorage['post_anonymously']\r\n    name.onchange()\r\n  }\r\n  // Submitting\r\n  form.addEventListener('submit', function(ev) {\r\n    ev.preventDefault()\r\n    ev.stopPropagation()\r\n    Ajax.submitPost(this)\r\n  })\r\n  form.querySelectorAll('.simplified-send-row button[type=\"submit\"]').forEach(sub => {\r\n    sub.onclick = function(ev) {\r\n      ev.preventDefault()\r\n      ev.stopPropagation()\r\n      let sage = +(this.name == 'sagebtn')\r\n      Ajax.submitPost(form, sage)\r\n    }\r\n  })\r\n  // TTL\r\n  let ttl = form.querySelector('input[name=\"ttl-enable\"]')\r\n  if (ttl) {\r\n    ttl.onchange = function() {\r\n      let on = this.checked\r\n      , input = form.ttl\r\n      input.disabled = !on\r\n      input.min = on ? 1 : 0\r\n      if (on && input.value == 0) {\r\n        input.value = 1\r\n      }\r\n    }\r\n    ttl.onchange()\r\n  }\r\n  // Detecting last active textarea\r\n  form.querySelectorAll('textarea, input[type=text]').forEach(el => {\r\n    el.onfocus = () => {\r\n      lastActiveForm = form\r\n    }\r\n  })\r\n  // Add file button\r\n  let fileButton = form.querySelector('.s-file')\r\n  if (fileButton) {\r\n    fileButton.onclick = ev => {\r\n      ev.preventDefault()\r\n      form.querySelector('input[type=file]').click()\r\n    }\r\n  }\r\n}\r\n\r\nvar injector = {\r\n  inject: function(alias, css) {\r\n    var id = `injector:${alias}`\r\n    var existing = document.getElementById(id)\r\n    if (existing) {\r\n      existing.innerHTML = css\r\n      return\r\n    }\r\n    var head = document.head || document.getElementsByTagName('head')[0]\r\n    , style = document.createElement('style')\r\n    style.type = 'text/css'\r\n    style.id = id\r\n    if (style.styleSheet) {\r\n      style.styleSheet.cssText = css\r\n    } else {\r\n      style.appendChild(document.createTextNode(css))\r\n    }\r\n    head.appendChild(style)\r\n  },\r\n  remove: function(alias) {\r\n    var id = `injector:${alias}`\r\n    var style = document.getElementById(id)\r\n    if (style) {\r\n      var head = document.head || document.getElementsByTagName('head')[0]\r\n      if (head)\r\n        head.removeChild(document.getElementById(id))\r\n    }\r\n  }\r\n}\r\n\r\nfunction randomString(length=10, chars='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ') {\r\n  let result = ''\r\n  for (let i = length; i > 0; --i) \r\n    result += chars[Math.round(Math.random() * (chars.length - 1))]\r\n  return result\r\n}\r\n\r\nfunction add_mob_menu() {\r\n  let r = 20\r\n  , pos = 10\r\n  , delay = 300\r\n  $('#overlay_menu').hide()\r\n  document.body.insertAdjacentHTML('afterbegin', `<div id=\"mobile-menu\"><div id=\"mobile-menu-contents\"></div></div>`)\r\n  let mm = document.querySelector('#mobile-menu-contents')\r\n  , $mmw = $('#mobile-menu')\r\n  , htm = ''\r\n  if (overboard_dir) {\r\n    htm += `<a href=\"/${overboard_dir}\" class=\"mm-item mm-brd\">${overboard_desc}</a>`\r\n  }\r\n  $('<div id=\"mmb-_options\" style=\"display: none\"></div>').append($('#ms-_options')).appendTo($(mm))\r\n  $mmw.append(`<div id=\"mm-toggle\">\r\n    <div class=\"mm-bars\"></div>\r\n    <div id=\"mm-circle\"></div>\r\n  </div>`)\r\n  let cats = boards10.list\r\n  cloud20.getBoards().then(b20 => {\r\n    cats.sort((a,b) => +a.order > +b.order)\r\n    .push({\r\n      id: '20',\r\n      name: '2.0',\r\n      boards: b20\r\n    })\r\n    cats.forEach((cat, ix) => {\r\n      if (cat.boards) {\r\n        htm += `<a href=\"#\" class=\"mm-item mm-cat\" data-mmbx=\"${ix}\">${cat.name}</a>\r\n          <span class=\"mm-boards\" id=\"mmb-${ix}\">`\r\n        cat.boards.forEach(b => {\r\n          b.dir = b.dir || b.name\r\n          htm += `<a class=\"mm-item mm-brd\" href=\"/${b.dir}\">/${b.dir}/  ${b.desc}</a>`\r\n        })\r\n        htm += '</span>'\r\n      }\r\n    })\r\n    htm += `<a href=\"#\" class=\"mm-item mm-toggle-options\" onclick=\"\r\n      $('.mm-boards').toggle(false); \r\n      $('#mmb-_options').slideToggle('fast');\r\n      $('.mmc-expanded').removeClass('mmc-expanded')\r\n      return false\r\n    \">Options</a>`\r\n    mm.insertAdjacentHTML('afterBegin', `${htm}`)\r\n    $('#mm-toggle').click(function() {\r\n      if ($mmw.hasClass('mm-expanded')) return;\r\n      $mmw.addClass('mm-expanded')\r\n      let bcr = $mmw[0].getBoundingClientRect()\r\n      , x = bcr.width - r - pos  // - radius/2, -position\r\n      , y = bcr.height - r - pos // - radius/2, -position\r\n      , R = Math.sqrt(x*x + y*y) // See, math is not useless after all\r\n      , scale = Math.ceil(R / r)\r\n      $('#mm-circle').css({'transform': `scale(${scale})`})\r\n      $(mm).css({\r\n        'visibility': 'visible',\r\n        'opacity': 1\r\n      })\r\n      $mmw.addClass('bars-away')\r\n      setTimeout(() => {\r\n        $mmw.addClass('mm-expanded-full')\r\n      }, delay)\r\n    })\r\n\r\n    offClick.push(() => {\r\n      if (! $mmw.hasClass('mm-expanded-full')) return;\r\n      $mmw.removeClass('mm-expanded-full bars-away')\r\n      setTimeout(() => {\r\n        $(mm).css({'visibility': 'hidden'})\r\n        $mmw.removeClass('mm-expanded')\r\n      }, delay)\r\n      $(mm).css({\r\n        'visibility': 'visible',\r\n        'opacity': 0\r\n      })\r\n      $('#mm-circle').css({'transform': `scale(1)`})\r\n    })\r\n  })\r\n  $mmw.click(function(ev) {\r\n    ev.stopPropagation()\r\n  })\r\n  .on('click', '.mm-cat[data-mmbx]', function() {\r\n    let $target = $(`#mmb-${$(this).data('mmbx')}`)\r\n    if ($target.is(':visible')) {\r\n      $target.toggle(false)\r\n      $(this).removeClass('mmc-expanded')\r\n    }\r\n    else {\r\n      $('.mm-boards').toggle(false)\r\n      $('#mmb-_options').slideUp('fast');\r\n      $target.toggle(true)\r\n      $('.mmc-expanded').removeClass('mmc-expanded')\r\n      $(this).addClass('mmc-expanded')\r\n    }\r\n    return false\r\n  })\r\n}\r\n\r\nvar boards10 = {\r\n  get list() {\r\n    if (!this.allboards) {\r\n      this.allboards = []\r\n      document.querySelectorAll('.olm-link').forEach(o => {\r\n        o = o.querySelector('a')\r\n        if (!o) return;\r\n        let s = o.dataset.toexpand\r\n        , sd = o.innerText\r\n        , sect = document.querySelector(`#ms-${s}`)\r\n        if (!s || s=='20' || s=='_options') return;\r\n        let section = {\r\n          id: s,\r\n          name: sd,\r\n          boards: []\r\n        }\r\n        sect.querySelectorAll('a').forEach(a => {\r\n          let m = a.innerText.match(/\\/(.+?)\\/ - (.+)/)\r\n          if (m) \r\n            section.boards.push({\r\n              dir: m[1],\r\n              desc: m[2]\r\n            })\r\n        })\r\n        this.allboards.push(section)\r\n      })\r\n    }\r\n    return this.allboards\r\n  }\r\n}\r\n\r\nvar cloud20 = {\r\n  init: function() {\r\n    this.getBoards().then(() => this.filter('')).catch(_.noop)\r\n    $('#boardselect').on('input', function() {\r\n      cloud20.filter($(this).val());\r\n    });\r\n  },\r\n  getBoards: function() {\r\n    return new Promise((rs, rj) => {\r\n      if (this.allboards)\r\n        rs(this.allboards)\r\n      else {\r\n        $.getJSON(ku_cgipath + '/boards20.json', data => {\r\n          this.allboards = data\r\n          rs(data)\r\n        })\r\n        .fail(e => {\r\n          pups.err(_l.unable_load_20)\r\n          rj(e)\r\n        })\r\n      }\r\n    })\r\n  },\r\n  filter: function(query) {\r\n    var res = [];\r\n    if(typeof this.allboards === \"undefined\") return;\r\n    if(query == '') res = this.allboards;\r\n    else {\r\n      query = query.toLowerCase();\r\n      _.each(this.allboards, function(board) {\r\n        if(board.name.toLowerCase().search(query) !== -1 || board.desc.toLowerCase().search(query) !== -1)\r\n          res.push(board);\r\n      });\r\n    }\r\n    this.display(res);\r\n  },\r\n  display: function(list) {\r\n    var newhtml = '', opts = '';\r\n    _.each(list, function(item) {\r\n      newhtml += '<a class=\"menu-item\" title=\"'+ item.desc +'\" href=\"'+ku_boardsfolder+item.name+'/\">/'+item.name+'/ - '+ item.desc +'</a>';\r\n      opts += '<option value=\"'+item.name+'\">/'+item.name+'/ - '+ item.desc +'</option>';\r\n    });\r\n    $('#boards20').html(newhtml);\r\n    $('.boardsel20').append(opts);\r\n  }\r\n}\r\n\r\nvar countries = {\r\n  'A1': \"Anonymous Proxy\",\r\n  'A2': \"Satellite Provider\",\r\n  'O1': \"Other Country\",\r\n  'AD': \"Andorra\",\r\n  'AE': \"United Arab Emirates\",\r\n  'AF': \"Afghanistan\",\r\n  'AG': \"Antigua and Barbuda\",\r\n  'AI': \"Anguilla\",\r\n  'AL': \"Albania\",\r\n  'AM': \"Armenia\",\r\n  'AO': \"Angola\",\r\n  'AP': \"Asia/Pacific Region\",\r\n  'AQ': \"Antarctica\",\r\n  'AR': \"Argentina\",\r\n  'AS': \"American Samoa\",\r\n  'AT': \"Austria\",\r\n  'AU': \"Australia\",\r\n  'AW': \"Aruba\",\r\n  'AX': \"Aland Islands\",\r\n  'AZ': \"Azerbaijan\",\r\n  'BA': \"Bosnia and Herzegovina\",\r\n  'BB': \"Barbados\",\r\n  'BD': \"Bangladesh\",\r\n  'BE': \"Belgium\",\r\n  'BF': \"Burkina Faso\",\r\n  'BG': \"Bulgaria\",\r\n  'BH': \"Bahrain\",\r\n  'BI': \"Burundi\",\r\n  'BJ': \"Benin\",\r\n  'BL': \"Saint Bartelemey\",\r\n  'BM': \"Bermuda\",\r\n  'BN': \"Brunei Darussalam\",\r\n  'BO': \"Bolivia\",\r\n  'BQ': \"Bonaire, Saint Eustatius and Saba\",\r\n  'BR': \"Brazil\",\r\n  'BS': \"Bahamas\",\r\n  'BT': \"Bhutan\",\r\n  'BV': \"Bouvet Island\",\r\n  'BW': \"Botswana\",\r\n  'BY': \"Belarus\",\r\n  'BZ': \"Belize\",\r\n  'CA': \"Canada\",\r\n  'CC': \"Cocos (Keeling) Islands\",\r\n  'CD': \"Congo, The Democratic Republic of the\",\r\n  'CF': \"Central African Republic\",\r\n  'CG': \"Congo\",\r\n  'CH': \"Switzerland\",\r\n  'CI': \"Cote d'Ivoire\",\r\n  'CK': \"Cook Islands\",\r\n  'CL': \"Chile\",\r\n  'CM': \"Cameroon\",\r\n  'CN': \"China\",\r\n  'CO': \"Colombia\",\r\n  'CR': \"Costa Rica\",\r\n  'CU': \"Cuba\",\r\n  'CV': \"Cape Verde\",\r\n  'CW': \"Curacao\",\r\n  'CX': \"Christmas Island\",\r\n  'CY': \"Cyprus\",\r\n  'CZ': \"Czech Republic\",\r\n  'DE': \"Germany\",\r\n  'DJ': \"Djibouti\",\r\n  'DK': \"Denmark\",\r\n  'DM': \"Dominica\",\r\n  'DO': \"Dominican Republic\",\r\n  'DZ': \"Algeria\",\r\n  'EC': \"Ecuador\",\r\n  'EE': \"Estonia\",\r\n  'EG': \"Egypt\",\r\n  'EH': \"Western Sahara\",\r\n  'ER': \"Eritrea\",\r\n  'ES': \"Spain\",\r\n  'ET': \"Ethiopia\",\r\n  'EU': \"Europe\",\r\n  'FI': \"Finland\",\r\n  'FJ': \"Fiji\",\r\n  'FK': \"Falkland Islands (Malvinas)\",\r\n  'FM': \"Micronesia, Federated States of\",\r\n  'FO': \"Faroe Islands\",\r\n  'FR': \"France\",\r\n  'GA': \"Gabon\",\r\n  'GB': \"United Kingdom\",\r\n  'GD': \"Grenada\",\r\n  'GE': \"Georgia\",\r\n  'GF': \"French Guiana\",\r\n  'GG': \"Guernsey\",\r\n  'GH': \"Ghana\",\r\n  'GI': \"Gibraltar\",\r\n  'GL': \"Greenland\",\r\n  'GM': \"Gambia\",\r\n  'GN': \"Guinea\",\r\n  'GP': \"Guadeloupe\",\r\n  'GQ': \"Equatorial Guinea\",\r\n  'GR': \"Greece\",\r\n  'GS': \"South Georgia and the South Sandwich Islands\",\r\n  'GT': \"Guatemala\",\r\n  'GU': \"Guam\",\r\n  'GW': \"Guinea-Bissau\",\r\n  'GY': \"Guyana\",\r\n  'HK': \"Hong Kong\",\r\n  'HM': \"Heard Island and McDonald Islands\",\r\n  'HN': \"Honduras\",\r\n  'HR': \"Croatia\",\r\n  'HT': \"Haiti\",\r\n  'HU': \"Hungary\",\r\n  'ID': \"Indonesia\",\r\n  'IE': \"Ireland\",\r\n  'IL': \"Israel\",\r\n  'IM': \"Isle of Man\",\r\n  'IN': \"India\",\r\n  'IO': \"British Indian Ocean Territory\",\r\n  'IQ': \"Iraq\",\r\n  'IR': \"Iran, Islamic Republic of\",\r\n  'IS': \"Iceland\",\r\n  'IT': \"Italy\",\r\n  'JE': \"Jersey\",\r\n  'JM': \"Jamaica\",\r\n  'JO': \"Jordan\",\r\n  'JP': \"Japan\",\r\n  'KE': \"Kenya\",\r\n  'KG': \"Kyrgyzstan\",\r\n  'KH': \"Cambodia\",\r\n  'KI': \"Kiribati\",\r\n  'KM': \"Comoros\",\r\n  'KN': \"Saint Kitts and Nevis\",\r\n  'KP': \"Korea, Democratic People's Republic of\",\r\n  'KR': \"Korea, Republic of\",\r\n  'KW': \"Kuwait\",\r\n  'KY': \"Cayman Islands\",\r\n  'KZ': \"Kazakhstan\",\r\n  'LA': \"Lao People's Democratic Republic\",\r\n  'LB': \"Lebanon\",\r\n  'LC': \"Saint Lucia\",\r\n  'LI': \"Liechtenstein\",\r\n  'LK': \"Sri Lanka\",\r\n  'LR': \"Liberia\",\r\n  'LS': \"Lesotho\",\r\n  'LT': \"Lithuania\",\r\n  'LU': \"Luxembourg\",\r\n  'LV': \"Latvia\",\r\n  'LY': \"Libyan Arab Jamahiriya\",\r\n  'MA': \"Morocco\",\r\n  'MC': \"Monaco\",\r\n  'MD': \"Moldova, Republic of\",\r\n  'ME': \"Montenegro\",\r\n  'MF': \"Saint Martin\",\r\n  'MG': \"Madagascar\",\r\n  'MH': \"Marshall Islands\",\r\n  'MK': \"Macedonia\",\r\n  'ML': \"Mali\",\r\n  'MM': \"Myanmar\",\r\n  'MN': \"Mongolia\",\r\n  'MO': \"Macao\",\r\n  'MP': \"Northern Mariana Islands\",\r\n  'MQ': \"Martinique\",\r\n  'MR': \"Mauritania\",\r\n  'MS': \"Montserrat\",\r\n  'MT': \"Malta\",\r\n  'MU': \"Mauritius\",\r\n  'MV': \"Maldives\",\r\n  'MW': \"Malawi\",\r\n  'MX': \"Mexico\",\r\n  'MY': \"Malaysia\",\r\n  'MZ': \"Mozambique\",\r\n  'NA': \"Namibia\",\r\n  'NC': \"New Caledonia\",\r\n  'NE': \"Niger\",\r\n  'NF': \"Norfolk Island\",\r\n  'NG': \"Nigeria\",\r\n  'NI': \"Nicaragua\",\r\n  'NL': \"Netherlands\",\r\n  'NO': \"Norway\",\r\n  'NP': \"Nepal\",\r\n  'NR': \"Nauru\",\r\n  'NU': \"Niue\",\r\n  'NZ': \"New Zealand\",\r\n  'OM': \"Oman\",\r\n  'PA': \"Panama\",\r\n  'PE': \"Peru\",\r\n  'PF': \"French Polynesia\",\r\n  'PG': \"Papua New Guinea\",\r\n  'PH': \"Philippines\",\r\n  'PK': \"Pakistan\",\r\n  'PL': \"Poland\",\r\n  'PM': \"Saint Pierre and Miquelon\",\r\n  'PN': \"Pitcairn\",\r\n  'PR': \"Puerto Rico\",\r\n  'PS': \"Palestinian Territory\",\r\n  'PT': \"Portugal\",\r\n  'PW': \"Palau\",\r\n  'PY': \"Paraguay\",\r\n  'QA': \"Qatar\",\r\n  'RE': \"Reunion\",\r\n  'RO': \"Romania\",\r\n  'RS': \"Serbia\",\r\n  'RU': \"Russian Federation\",\r\n  'RW': \"Rwanda\",\r\n  'SA': \"Saudi Arabia\",\r\n  'SB': \"Solomon Islands\",\r\n  'SC': \"Seychelles\",\r\n  'SD': \"Sudan\",\r\n  'SE': \"Sweden\",\r\n  'SG': \"Singapore\",\r\n  'SH': \"Saint Helena\",\r\n  'SI': \"Slovenia\",\r\n  'SJ': \"Svalbard and Jan Mayen\",\r\n  'SK': \"Slovakia\",\r\n  'SL': \"Sierra Leone\",\r\n  'SM': \"San Marino\",\r\n  'SN': \"Senegal\",\r\n  'SO': \"Somalia\",\r\n  'SR': \"Suriname\",\r\n  'SS': \"South Sudan\",\r\n  'ST': \"Sao Tome and Principe\",\r\n  'SV': \"El Salvador\",\r\n  'SX': \"Sint Maarten\",\r\n  'SY': \"Syrian Arab Republic\",\r\n  'SZ': \"Swaziland\",\r\n  'TC': \"Turks and Caicos Islands\",\r\n  'TD': \"Chad\",\r\n  'TF': \"French Southern Territories\",\r\n  'TG': \"Togo\",\r\n  'TH': \"Thailand\",\r\n  'TJ': \"Tajikistan\",\r\n  'TK': \"Tokelau\",\r\n  'TL': \"Timor-Leste\",\r\n  'TM': \"Turkmenistan\",\r\n  'TN': \"Tunisia\",\r\n  'TO': \"Tonga\",\r\n  'TR': \"Turkey\",\r\n  'TT': \"Trinidad and Tobago\",\r\n  'TV': \"Tuvalu\",\r\n  'TW': \"Taiwan\",\r\n  'TZ': \"Tanzania, United Republic of\",\r\n  'UA': \"Ukraine\",\r\n  'UG': \"Uganda\",\r\n  'UM': \"United States Minor Outlying Islands\",\r\n  'US': \"United States\",\r\n  'UY': \"Uruguay\",\r\n  'UZ': \"Uzbekistan\",\r\n  'VA': \"Holy See (Vatican City State)\",\r\n  'VC': \"Saint Vincent and the Grenadines\",\r\n  'VE': \"Venezuela\",\r\n  'VG': \"Virgin Islands, British\",\r\n  'VI': \"Virgin Islands, U.S.\",\r\n  'VN': \"Vietnam\",\r\n  'VU': \"Vanuatu\",\r\n  'WF': \"Wallis and Futuna\",\r\n  'WS': \"Samoa\",\r\n  'YE': \"Yemen\",\r\n  'YT': \"Mayotte\",\r\n  'ZA': \"South Africa\",\r\n  'ZM': \"Zambia\",\r\n  'ZW': \"Zimbabwe\",\r\n  'XX': \"OMCK\",\r\n  'T1': \"Tor\"\r\n}\r\n\r\nvar bnrs = {\r\n  initiated: false,\r\n  init: function() {\r\n    $.getJSON(ku_boardspath+'/bnrs.json', function(data) {\r\n      var reduced = [];\r\n      if(data.length > 1) {\r\n        _.each(data, function(bnr) {\r\n          if(bnr.link !== this_board_dir) reduced.push(bnr);\r\n        });\r\n      }\r\n      else reduced = data;\r\n      bnrs.data = reduced;\r\n      bnrs.initiated = true;\r\n      bnrs.display();\r\n    });\r\n  },\r\n  display: function() {\r\n    if(!this.initiated) return;\r\n    if(!this.data.length) return;\r\n    var reduced = [];\r\n    if(typeof this.current !== 'undefined') {\r\n      _.each(this.data, function(item) {\r\n        if(item.path !== bnrs.current) reduced.push(item)\r\n      });\r\n    }\r\n    else reduced = this.data;\r\n    var toDisplay = randomItem(reduced);\r\n    this.current = toDisplay.path;\r\n    var link = (toDisplay.link.indexOf('http') === (-1)) ? ku_boardspath+'/'+toDisplay.link : toDisplay.link;\r\n    var newhtml = '<a class=\"bnrsupdate\" href=\"#\" onclick=\"javascript:bnrs.display();return false;\"></a><a href=\"'+link+'\"><img src=\"'+ku_boardspath+'/images/bnrs/'+toDisplay.path+'\" /></a>';\r\n    if($('.bnr').length) {\r\n      $('.bnr').html(newhtml);\r\n    }\r\n    else $('.logo').before('<div class=\"bnr-wrap\"><div class=\"bnr\">'+newhtml+'</div></div>');\r\n  },\r\n}\r\n\r\nfunction getRandomInt (min, max) {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nfunction randomItem(array) {\r\n  return array[getRandomInt(0, array.length-1)];\r\n}\r\n\r\nvar embedLinks = {\r\n  sites: [\r\n    {id: 'youtube', rx: /(?:youtu(?:\\.be|be\\.com)\\/(?:.*v(?:\\/|=)|(?:.*\\/)?)([\\w'-]+))/i },\r\n    {id: 'vimeo', rx: /[\\w\\W]*vimeo\\.com\\/(?:.*?)([0-9]+)(?:.*)?/ },\r\n    {id: 'coub', rx: /[\\w\\W]*coub\\.com\\/view\\/([\\w\\W]*)[\\w\\W]*/ },\r\n    {id: 'soundcloud', rx: /[\\w\\W]*soundcloud.com\\/([\\w\\W]*)[\\w\\W]*/i },\r\n  ],\r\n  process: function(val) {\r\n    var result = null;\r\n    _.find(this.sites, function(site) {\r\n      var fruit = site.rx.exec(val);\r\n      if(fruit != null) {\r\n        result = {\r\n          site: site.id,\r\n          code: fruit[1]\r\n        }\r\n      }\r\n    })\r\n    return result;\r\n  }\r\n}\r\n\r\nvar catalog = {\r\n  conf: {\r\n    sortBy: 'bumped',\r\n    layout: 'text',\r\n    respectStickied: true,\r\n    showHidden: true,\r\n    expandOnHover: true\r\n  },\r\n  saveConfig: function() {\r\n    localStorage['catalogSettings'] = JSON.stringify(this.conf);\r\n  },\r\n  init: function() {\r\n    document.body.classList.add('is-catalog')\r\n    // apply settings\r\n    if(localStorage['catalogSettings']) {\r\n      try {\r\n        var myConf = JSON.parse(localStorage['catalogSettings']);\r\n        _.each(myConf, function(val, key) {\r\n          this.conf[key] = val\r\n        }, this)\r\n      }\r\n      catch(e) {\r\n        console.error('Invalid catalog config');\r\n        localStorage.removeItem('catalogSettings');\r\n      }\r\n    }\r\n\r\n    /*var sortOptionElements = '';\r\n    _.each([\r\n      ['bumped', 'bumpOrder'],\r\n      ['replied', 'lastReply'],\r\n      ['timestamp', 'creationDate'],\r\n      ['reply_count', 'replyCount']\r\n    ], (function(val_desc) {\r\n      sortOptionElements += '<option value=\"'+val_desc[0]+'\"'+(val_desc[0]==this.conf.sortBy ? ' selected' : '')+'>'+_l[val_desc[1]]+'</option>';\r\n    }).bind(this));*/\r\n    // Catalog refresh button\r\n    var refreshBtn = `<div class=\"refresh-catalog\" title=\"${_l.refreshCatalog}\"><svg class=\"icon i-16in20\"><use xlink:href=\"#i-refresh\"></use></svg></div>`\r\n    // catalog control buttons\r\n    var sortBtns = '<div class=\"button-group\" data-select=\"sortBy\">';\r\n    _.each([\r\n      ['bumped', 'bumpOrder', 'bump', 'i-20'],\r\n      ['timestamp', 'creationDate', 'creation', 'i-20'],\r\n      ['replied', 'lastReply', 'reply', 'i-16in20'],\r\n      ['reply_count', 'replyCount', 'replies', 'i-20']\r\n    ], (function(v_d_i) {\r\n      sortBtns += '<div class=\"bg-button'+(v_d_i[0]==this.conf.sortBy ? ' bgb-selected' : '')+\r\n      '\" data-val=\"'+v_d_i[0]+'\" title=\"'+_l.sortBy+' '+_l[v_d_i[1]]+'\">\\\r\n      <svg class=\"icon '+v_d_i[3]+'\"><use xlink:href=\"#i-'+v_d_i[2]+'\"></use></svg></div>'\r\n    }).bind(this));\r\n    sortBtns += '</div>';\r\n    var pinBtns = '<div class=\"button-group'+(this.conf.sortBy !== 'bumped' ? ' disabled' : '')+'\" data-select=\"respectStickied\" id=\"pinControl\">';\r\n    _.each([\r\n      [1, 'doStick', 'pin', 'i-16in20'],\r\n      [0, 'doNotStick', 'unpin', 'i-16in20']\r\n    ], (function(v_d_i) {\r\n      pinBtns += '<div class=\"bg-button'+(v_d_i[0]==this.conf.respectStickied ? ' bgb-selected' : '')+\r\n      '\" data-val=\"'+v_d_i[0]+'\" title=\"'+_l[v_d_i[1]]+'\">\\\r\n      <svg class=\"icon '+v_d_i[3]+'\"><use xlink:href=\"#i-'+v_d_i[2]+'\"></use></svg></div>'\r\n    }).bind(this));\r\n    pinBtns += '</div>';\r\n    var hideBtns = '<div class=\"button-group\" data-select=\"showHidden\">';\r\n    _.each([\r\n      [0, 'hideHidden', 'hide', 'i-16in20'],\r\n      [1, 'showHidden', 'unhide', 'i-16in20']\r\n    ], (function(v_d_i) {\r\n      hideBtns += '<div class=\"bg-button'+(v_d_i[0]==this.conf.showHidden ? ' bgb-selected' : '')+\r\n      '\" data-val=\"'+v_d_i[0]+'\" title=\"'+_l[v_d_i[1]]+'\">\\\r\n      <svg class=\"icon '+v_d_i[3]+'\"><use xlink:href=\"#i-'+v_d_i[2]+'\"></use></svg></div>'\r\n    }).bind(this));\r\n    hideBtns += '</div>';\r\n    var layoutBtns = '<div class=\"button-group\" data-select=\"layout\">';\r\n    _.each([\r\n      ['text', 'smallPics', 'grid-small', 'i-20'],\r\n      ['gallery', 'largePics', 'gallery-grid', 'i-20'],\r\n      /*['legacy', 'legacyMode', 'legacy-grid', 'i-20']*/\r\n    ], (function(v_d_i) {\r\n      layoutBtns += '<div class=\"bg-button'+(v_d_i[0]==this.conf.layout ? ' bgb-selected' : '')+\r\n      '\" data-val=\"'+v_d_i[0]+'\" title=\"'+_l[v_d_i[1]]+'\">\\\r\n      <svg class=\"icon '+v_d_i[3]+'\"><use xlink:href=\"#i-'+v_d_i[2]+'\"></use></svg></div>'\r\n    }).bind(this));\r\n    layoutBtns += '</div>';\r\n    // searck input\r\n    var searchInput = '<input name=\"subject\" autocomplete=\"false\" class=\"button-group\" type=\"text\" id=\"cat-search\" placeholder=\"'+_l.search+'...\" /><input type=\"text\" name=\"FUCKYOUCHROMEFUCKYOU\" style=\"display:none;\"/>'\r\n\r\n    $('#catalog-controls').html(\r\n      refreshBtn+sortBtns+pinBtns+searchInput+hideBtns+layoutBtns\r\n    );\r\n    this.load();\r\n    if(this.conf.expandOnHover)\r\n      $('#catalog-contents').addClass('expand-on-hover-enabled');\r\n    // Card events\r\n    $('#catalog-contents')\r\n    .on('click', '.namedate-overlay', function() {\r\n      $(this).toggleClass('date-on name-on');\r\n    })\r\n    .on('click', '.ce-text .bigThumb', function(ev) {\r\n      ev.stopPropagation(); ev.preventDefault();\r\n      var $card = $(this).parents('.cat-entry');\r\n      $card.toggleClass('thumbExpanded');\r\n    })\r\n    .on('click', '.bigThumb audio, .bigThumb video', function(ev) {\r\n      ev.stopPropagation();\r\n    })\r\n    .on('animationstart webkitAnimationStart MSAnimationStart oanimationstart', (function(event) {\r\n      var $target = $(event.target);\r\n      if (event.originalEvent.animationName == \"embed-image-insert\" && !$target.hasClass('_inserted_'))\r\n        this.getEmbedThumb($target);\r\n    }).bind(this))\r\n    .on('mousedown', '.cat-prv', function(ev) {\r\n      ev.preventDefault();\r\n      PostPreviews._mouseover.bind(this)(ev);\r\n    })\r\n    .on('click', '.cat-prv', function(ev) {\r\n      ev.stopPropagation();\r\n      ev.preventDefault();\r\n    })\r\n    .on('mouseleave', '.cat-prv', function(ev) {\r\n      PostPreviews._mouseout.bind(this)(/*ev*/);\r\n    })\r\n    .on('click', '.i-hide', (function(ev) {\r\n      var $target = $(ev.currentTarget)\r\n      , $card = $target.parents('.cat-entry')\r\n      , threadID = $card.data('id')\r\n      , threadIX = _.findIndex(this.model, {'id': threadID})\r\n      , thread = this.model[threadIX];\r\n      thread.hidden = !thread.hidden;\r\n      // addClass won't work here for some reason\r\n      if(thread.hidden) {\r\n        $target[0].classList.add('pressed');\r\n        $target.html(makeIcon('unhide', '', true));\r\n        HiddenItems.hideItem('thread', threadID);\r\n        $card.addClass('thread-hidden')\r\n      }\r\n      else {\r\n        $target[0].classList.remove('pressed');\r\n        $target.html(makeIcon('hide', '', true));\r\n        HiddenItems.unhideItem('thread', threadID);\r\n        $card.removeClass('thread-hidden')\r\n      }\r\n      //invalidate rendered cache\r\n      this.model[threadIX] = thread;\r\n      delete this.rendered[this.conf.layout][threadID];\r\n    }).bind(this))\r\n    // catalog configuration\r\n    $('.bg-button').click((function(ev) {\r\n      var $target = $(ev.currentTarget);\r\n      if($target.hasClass('bgb-selected')) return;\r\n      var $group = $target.parent()\r\n      , val = $target.data('val')\r\n      , key = $group.data('select');\r\n      $group.find('.bg-button').removeClass('bgb-selected');\r\n      $target.addClass('bgb-selected');\r\n      if(key !== 'sortBy' && key !== 'layout') val = !!val;\r\n      else {\r\n        if(val == 'bumped') $('#pinControl').removeClass('disabled');\r\n        else $('#pinControl').addClass('disabled');\r\n      }\r\n      this.conf[key] = val;\r\n      this.saveConfig();\r\n      if(key !== 'showHidden') this.build();\r\n      else {\r\n        if(val) $('#catalog-contents').removeClass('hideHidden');\r\n        else $('#catalog-contents').addClass('hideHidden');\r\n      }\r\n    }).bind(this))\r\n    $('.refresh-catalog').click((function(ev) {\r\n      ev.preventDefault();\r\n      this.load();\r\n    }).bind(this));\r\n    //search\r\n    $('#cat-search').on('input', function() {\r\n      var query = $(this).val().toLowerCase().replace(/\\\"/, '\\\\\"');\r\n      try {\r\n        injector.remove('cat-search');\r\n      } catch(e) {}\r\n      if(query.length)\r\n        injector.inject('cat-search', '#catalog-contents .cat-entry:not([data-search *= \"'+query+'\"]) { display:none; }');\r\n      else injector.remove('cat-search');\r\n    }).trigger('input');\r\n  },\r\n  load: function() {\r\n    $('#catalog-contents').html(`<div class=\"cat-loading\"><div class=\"spinner\"></div>${_l.loading}...</div>`);\r\n    // clear data\r\n    this.rendered = {text: {}, gallery: {}};\r\n    this.model = null;\r\n    // get contents\r\n    $.getJSON('catalog.json?v='+(new Date().getTime()))\r\n    .done(this.build.bind(this))\r\n    .fail(function(err) {\r\n      throw err;\r\n    })\r\n  },\r\n  fileTypes: {\r\n    image: ['jpg', 'gif', 'png'],\r\n    jpgThumb: ['webm', 'mp4', 'cob', 'vim', 'you'],\r\n    iconsAvailable: ['swf', 'mp3', 'ogg', 'css', 'flv'],\r\n    audio: ['mp3', 'ogg'],\r\n    embed: ['cob', 'vim', 'you']\r\n  },\r\n  authorities: ['', 'Admin', 'Mod', '?', 'God'],\r\n  formatDate: function(timestamp, short) {\r\n    if(typeof short === 'undefined') short = false;\r\n    var date = new Date(timestamp * 1000)\r\n    , Dow = this.dateLocal.dows.hasOwnProperty(locale) ? this.dateLocal.dows[locale][date.getDay()] : this.dateLocal.dows.en[date.getDay()]\r\n    , yy = _.padLeft(date.getFullYear() % 100, 2, 0)\r\n    , mo = _.padLeft(date.getMonth()+1, 2, 0)\r\n    , Mon = (locale === 'ru') ? this.dateLocal.mons.ru[date.getMonth()] : date.getMonth()+1\r\n    , dd = _.padLeft(date.getDate(), 2, 0)\r\n    , hh = _.padLeft(date.getHours(), 2, 0)\r\n    , mm = _.padLeft(date.getMinutes(), 2, 0)\r\n    , ss = _.padLeft(date.getSeconds(), 2, 0);\r\n    return (short\r\n      ? ( (locale === 'ru')\r\n        ? (dd+'.'+mo+'.'+yy+'  ')\r\n        : (mo+'/'+dd+'/'+yy+' @ ') )\r\n      : ( (locale === 'ru')\r\n        ? (Dow+' '+dd+' '+Mon+''+yy+'  ')\r\n        : (mo+'/'+dd+'/'+yy+' ('+Dow+') @ ') )\r\n    ) + hh+':'+mm+':'+ss;\r\n  },\r\n  dateLocal: {\r\n    dows: {\r\n      ru: ['','','','','','',''],\r\n      en: ['Sun','Mon','Tue','Wen','Thu','Fri','Sat']\r\n    },\r\n    mons: {\r\n      ru: ['','','','','','','','','','','','']\r\n    }\r\n  },\r\n  build: function(data) {\r\n    if(typeof data === 'undefined') data = this.model;\r\n    if(!data) return;\r\n    // normalize\r\n    _.each(data, function(entry, i) {\r\n      _.each(['id', 'reply_count', 'bumped', 'replied', 'reply_count', 'timestamp', 'page', 'locked', 'stickied', 'deleted_timestamp'], function(prop) {\r\n        entry[prop] = ~~entry[prop];\r\n      })\r\n      data[i] = entry;\r\n    })\r\n    // Sort threads\r\n    if(this.conf.sortBy === 'bumped' && this.conf.respectStickied)\r\n      this.model = _.sortByOrder(data, ['stickied', 'bumped'], ['desc', 'desc']);\r\n    else {\r\n      var sby = [this.conf.sortBy];\r\n      if(this.conf.sortBy !== 'bumped')\r\n        sby.push('bumped')\r\n      this.model = _.sortByOrder(data, sby, _.repeat('desc', sby.length));\r\n    }\r\n\r\n    var html = '';\r\n\r\n    _.each(this.model, function(thread) {\r\n      html += this.buildEntry(thread);\r\n    }, this);\r\n\r\n    $('#catalog-contents').html(html);\r\n  },\r\n  getEmbedThumb: function($el) {\r\n    var site = $el.data('site'), id = $el.data('id'), img\r\n    , $thread = $el.parents('.cat-entry')\r\n    , threadID = $thread.data('id');\r\n    if(site == 'cob')\r\n      $.get(ku_boardspath+'/corpsy.php?code='+id, (function(res) {\r\n        $el.replaceWith('<img src=\"'+res.thumbnail_url+'\">');\r\n        this.rendered[this.conf.layout][threadID] = $thread[0].outerHTML;\r\n      }).bind(this));\r\n    if(site == 'vim')\r\n      $.get('http://vimeo.com/api/v2/video/'+id+'.json', (function(res) {\r\n        $el.replaceWith('<img src=\"'+res[0].thumbnail_medium+'\">');\r\n        this.rendered[this.conf.layout][threadID] = $thread[0].outerHTML\r\n      }).bind(this));\r\n  },\r\n\r\n  buildEntry: function(thread) {\r\n    if(this.rendered[this.conf.layout].hasOwnProperty(thread.id))\r\n      return this.rendered[this.conf.layout][thread.id];\r\n\r\n    if(!thread.processed) {\r\n      thread.url = '/'+this_board_dir+'/res/'+thread.id+'.html';\r\n      // --- Building blocks ---\r\n      // Thumbnails\r\n      var expanderBtn = '<svg class=\"actor icon cat-thumb-expand\"><use xlink:href=\"#i-expand\"></use></svg>',\r\n      playerBtn = '<svg class=\"actor icon cat-thumb-expand\"><use xlink:href=\"#i-play\"></use></svg>';\r\n      // Find first non-deleted file\r\n      let embed = thread.embeds ? (thread.embeds.find(e => e.file != 'removed') || 'removed') : null\r\n      //  for images\r\n      if(!embed || embed === 'removed') {\r\n        thread.smallThumb =\r\n        '<a href=\"'+thread.url+'\" class=\"smallThumb\">\\\r\n          <div class=\"nofile-removed ctx\">'+(embed === 'removed' ? '' : 'No File')+'</div>'\r\n        +'</a>';\r\n      }\r\n      else {\r\n        if (\r\n          _.includes(this.fileTypes.image, embed.file_type)\r\n          ||\r\n          _.includes(this.fileTypes.jpgThumb, embed.file_type)\r\n          ||\r\n          (\r\n            _.includes(this.fileTypes.audio, embed.file_type)\r\n            &&\r\n            (+embed.thumb_w) > 0\r\n            &&\r\n            (+embed.thumb_h) > 0\r\n          )\r\n        ) {\r\n          let ftype = _.includes(this.fileTypes.image, embed.file_type)\r\n            ? embed.file_type\r\n            : 'jpg'\r\n          , thumbURL = _.includes(this.fileTypes.embed, embed.file_type)\r\n            ? `${embed.file_type}-${embed.file}-`\r\n            : embed.file\r\n          , vartype = embed.file_type == 'mp3' ? ' onerror=\"switchFileType(this)\" extset=\"jpg,png,gif\"' : ''\r\n          thread.smallThumb =\r\n          '<a href=\"'+thread.url+'\" class=\"smallThumb\">\\\r\n            <img src=\"thumb/'+thumbURL+'c.'+ftype+'\"'+vartype+'>'\r\n          +'</a>';\r\n          thread.bigThumb =\r\n          '<img src=\"thumb/'+thumbURL+'s.'+ftype+'\"'+vartype+'>';\r\n        }\r\n        /*if(_.includes(this.fileTypes.image, thread.file_type)) {\r\n          thread.fileTypeClass = 'image';\r\n          thread.smallThumb =\r\n          '<a href=\"'+thread.url+'\" class=\"smallThumb\">\\\r\n            <img src=\"thumb/'+thread.file+'c.'+(thread.file_type === 'webm' ? 'jpg' : thread.file_type)+'\">'\r\n          +'</a>';\r\n          thread.bigThumb =\r\n          '<img src=\"thumb/'+thread.file+'s.'+(thread.file_type === 'webm' ? 'jpg' : thread.file_type)+'\">';\r\n        }*/\r\n        //  small thumbnail for embeds and generic files\r\n        else {\r\n          var smallSrc = (_.includes(this.fileTypes.iconsAvailable, embed.file_type))\r\n          ? '/inc/filetypes/'+embed.file_type+'.png'\r\n          : '/inc/filetypes/generic'+(_.includes(this.fileTypes.embed, embed.file_type) ? '-embed' : '')+'.png';\r\n          var expandable = _.includes(this.fileTypes.embed, embed.file_type) || _.includes(this.fileTypes.audio, embed.file_type);\r\n          thread.smallThumb =\r\n          '<a href=\"'+thread.url+'\" class=\"smallThumb\">\\\r\n            <img src=\"'+smallSrc+'\">' +\r\n            /*+ ''+(expandable ? playerBtn : '') +*/\r\n          '</a>';\r\n          //  for audios\r\n          if(_.includes(this.fileTypes.audio, embed.file_type)) {\r\n            thread.bigThumb =\r\n            '<audio src=\"src/'+embed.file+'.'+embed.file_type+'\" controls></audio>';\r\n          }\r\n        }\r\n        /*//  for embeds\r\n        if(_.includes(this.fileTypes.embed, thread.file_type)) {\r\n          thread.bigThumb = (thread.file_type == 'you')\r\n          ? '<img src=\"http://i.ytimg.com/vi/'+thread.file+'/mqdefault.jpg\">'\r\n          : '<div class=\"cat-bt-embed\" data-site=\"'+thread.file_type+'\" data-id=\"'+thread.file+'\"></div>';\r\n        }\r\n        //  for audios\r\n        if(_.includes(this.fileTypes.audio, thread.file_type)) {\r\n          thread.bigThumb =\r\n          '<audio src=\"src/'+thread.file+'.'+thread.file_type+'\" controls></audio>';\r\n        }*/\r\n        thread.bigThumb = '<a target=\"_blank\" href=\"'+thread.url+'\" class=\"bigThumb\">'+thread.bigThumb+'</a>';\r\n      }\r\n      /*if(!embed || embed === 'removed')\r\n        thread.bigThumb = '<a target=\"_blank\" href=\"'+thread.url+'\" class=\"bigThumb\">'+thread.bigThumb+'</a>';*/\r\n\r\n      //OP\r\n      thread.op = '<a target=\"_blank\" title=\"'+_l.goToThread+'\" target=\"_blank\" href=\"'+thread.url+'\" class=\"op-number ctx\">#'+thread.id+'</a>';\r\n\r\n      //preview\r\n      thread.preview =\r\n      '<a href=\"'+thread.url+'#'+thread.id+'\" class=\"actor cat-prv\">\\\r\n        <svg class=\"icon\"><use xlink:href=\"#i-eye\"></use></svg>\\\r\n      </a>';\r\n\r\n      //counters\r\n      var repliesLabel =\r\n      '<svg class=\"icon\"><use xlink:href=\"#i-reply\"></use></svg>\\\r\n      <span class=\"ctx reply-count\">'+thread.reply_count+'</span>';\r\n      if(thread.last_reply)\r\n        repliesLabel = '<a href=\"'+thread.url+'#'+thread.last_reply+'\" class=\"actor cat-prv\">'+repliesLabel+'</a>';\r\n      var replies =\r\n      '<div class=\"infolabel\">'+repliesLabel+'</div>',\r\n      images =\r\n      '<div class=\"infolabel\">\\\r\n        <svg class=\"icon\"><use xlink:href=\"#i-picture\"></use></svg>\\\r\n        <span class=\"ctx image-count\">'+thread.images+'</span>\\\r\n      </div>',\r\n      page =\r\n      '<div class=\"infolabel il-page\">\\\r\n        <a title=\"'+_l.threadOnPage+' '+thread.page+'\" target=\"_blank\" href=\"/'+this_board_dir+'/' + ((thread.page > 0) ? thread.page+'.html' : '')+'#'+thread.id+'\" class=\"actor\">\\\r\n          <svg class=\"icon\"><use xlink:href=\"#i-page\"></use></svg>\\\r\n          <span class=\"ctx page-number\">'+thread.page+'</span>\\\r\n        </a>\\\r\n      </div>';\r\n      thread.countersCombined = replies+images+page;\r\n\r\n      //Poster name+date\r\n      thread.posterauthority = +thread.posterauthority;\r\n      thread.nameDatePriority = 'date';\r\n      if(localStorage['cat_nameDatePriority'] == 'name' ||\r\n          (localStorage['cat_nameDatePriority'] != 'date' &&\r\n            (thread.name || thread.tripcode || thread.posterauthority)\r\n          )\r\n        ) thread.nameDatePriority = 'name';\r\n\r\n      // Poster name\r\n      var poster =\r\n      (thread.name ? '<span class=\"ctx postername\">'+thread.name+'</span>' : '') +\r\n      (thread.tripcode ? '<span class=\"ctx postertrip\">!'+thread.tripcode+'</span>' : '') +\r\n      (thread.posterauthority ? '<span class=\"ctx admin\">&nbsp;##'+this.authorities[thread.posterauthority]+'##</span>' : '');\r\n      thread.poster = '<div class=\"cat-poster\"><span class=\"ctx\">by&nbsp;</span>'+ (poster || '<span class=\"ctx c-postername\">'+(this_board_defaultName || _l.anonymous)+'</span>')+'</div>';\r\n\r\n      // Date\r\n      var dn = ' style=\"display:none\"';\r\n      thread.date = '<div class=\"ctx cat-date cat-date-long\">'+this.formatDate(thread.timestamp)+'</div>';\r\n      thread.dateCompact = '<div class=\"ctx cat-date cat-date-short\">'+this.formatDate(thread.timestamp, 1)+'</div>';\r\n\r\n      //search data\r\n      thread.searchData = _.escape(stripHTML(thread.subject + ' ' + thread.message).toLowerCase());\r\n\r\n      thread.message = thread.message.replace(/\\\\\"/mg, '\"');\r\n\r\n      thread.processed = true;\r\n      this.model[_.findIndex(this.model, {id: thread.id})] = thread;\r\n    }\r\n    //indicators\r\n    thread = this.buildIndicators(thread);\r\n\r\n    var html = this.layouts[this.conf.layout].bind(this)(thread);\r\n    this.rendered[this.conf.layout][thread.id] = html;\r\n    return html\r\n  },\r\n  buildIndicators: function(thread) {\r\n    thread.hidden =  HiddenItems.isHidden('thread', thread.id)\r\n    var pin = thread.stickied ? '<svg class=\"foradmin-act icon i-layer-1 i-pin\"><use xlink:href=\"#i-pin\"></use></svg>' : '',\r\n    lock = thread.locked ? '<svg class=\"foradmin-act icon i-layer-1 i-lock\"><use xlink:href=\"#i-lock\"></use></svg>' : '',\r\n    deathmark = thread.deleted_timestamp ? '<svg class=\"foradmin-act icon i-layer-1 i-deathmark\"><use xlink:href=\"#i-skull\"></use></svg>' : '',\r\n    hide = '<svg class=\"actor icon i-layer-1 i-hide'+(thread.hidden ? ' pressed' : '')+'\"><use xlink:href=\"#i-'+(thread.hidden ? 'unhide' : 'hide')+'\"></use></svg>',\r\n    burger = '<svg class=\"actor icon i-burger foradmin-show\"><use xlink:href=\"#i-burger\"></use></svg>',\r\n    del = '<svg class=\"actor icon i-layer-2 i-delete foradmin-show\"><use xlink:href=\"#i-x\"></use></svg>',\r\n    and = '<svg class=\"actor icon i-layer-2 i-dnb foradmin-show\"><use xlink:href=\"#i-and\"></use></svg>',\r\n    ban = '<svg class=\"actor icon i-layer-2 i-ban foradmin-show\"><use xlink:href=\"#i-ban\"></use></svg>';\r\n    thread.indicatorsCombined = '<div class=\"indicators\">'+burger+'<span class=\"i-layer-1\">'+deathmark+pin+lock+hide+'</span><span class=\"i-layer-2\">'+del+and+ban+'</span></div>';\r\n    return thread;\r\n  },\r\n  layouts: {\r\n    text: function(thread) {\r\n      return ''+\r\n      '<div data-id=\"'+thread.id+'\" class=\"cat-entry ce-text'+(thread.hidden ? ' thread-hidden' : '')+'\" data-search=\"'+thread.searchData+'\">\\\r\n        <div class=\"cat-card\">\\\r\n          <div class=\"ce-heda\">'\r\n            +thread.smallThumb+\r\n            '<div class=\"cat-infoline ci-op-link\">'\r\n              +thread.op\r\n              +thread.indicatorsCombined+\r\n            '</div>\\\r\n            <div class=\"cat-infoline namedate-overlay '+thread.nameDatePriority+'-on\">'\r\n              +thread.poster\r\n              +thread.date\r\n            +'</div>\\\r\n            <div class=\"cat-infoline\">'\r\n              +thread.preview\r\n              +thread.countersCombined+\r\n            '</div>\\\r\n          </div>\\\r\n          <div class=\"ce-opcontent ctx\">\\\r\n            <h5>'+thread.subject+'</h5>'+\r\n            thread.message+\r\n          '</div>\\\r\n        </div>'\r\n        +thread.bigThumb+\r\n      '</div>'\r\n    },\r\n    gallery: function(thread) {\r\n      return ''+\r\n      '<div data-id=\"'+thread.id+'\" class=\"cat-entry ce-gallery'+(thread.hidden ? ' thread-hidden' : '')+'\" data-search=\"'+thread.searchData+'\">\\\r\n        <div class=\"cat-card\">'+\r\n          thread.bigThumb+\r\n          '<div class=\"cat-infoline\">\\\r\n            <div class=\"ci-op-link\">'+thread.op+'</div>\\\r\n            <div class=\"counters\">'+thread.countersCombined+'</div>\\\r\n          </div>\\\r\n          <div class=\"cat-infoline\">'\r\n            +thread.preview+\r\n            '<div class=\"namedate-overlay '+thread.nameDatePriority+'-on\">'\r\n              +thread.poster\r\n              +thread.dateCompact\r\n            +'</div>'\r\n            +thread.indicatorsCombined+\r\n          '</div>\\\r\n          <div class=\"ce-opcontent ctx\">\\\r\n            <h5>'+thread.subject+'</h5>'+\r\n            thread.message+\r\n          '</div>\\\r\n        </div>\\\r\n      </div>'\r\n    }\r\n  }\r\n}\r\n\r\nfunction stripHTML(html) {\r\n  var tmp = document.implementation.createHTMLDocument(\"New\").body;\r\n  tmp.innerHTML = html;\r\n  return tmp.textContent || tmp.innerText || \"\";\r\n}\r\n\r\nvar overboard = {\r\n  get boards() {\r\n    if (!is_overboard)\r\n      return [boardid]\r\n    if (!this._boards)\r\n      this._boards = _.unique([].map.call(document.querySelectorAll('div[id^=thread]'), e => e.dataset.boardid))\r\n    return this._boards\r\n  },\r\n  idFromName: name => name!==null && $(`div[data-board=\"${name}\"]`).parents('div[id^=thread]').data('boardid')\r\n}\r\n\r\nvar unreadCounter = {\r\n  init: function(built) {\r\n    if (!built) {\r\n      built = + document.querySelector('meta[property=\"i0:buildtime\"]').content\r\n    }\r\n    this.lastvisits = localStorage['lastvisits'] ? (JSON.parse(localStorage['lastvisits']) || { }) : { }\r\n    overboard.boards.forEach(boardid => {\r\n      let last_ts = this.lastvisits.hasOwnProperty(boardid) ? parseInt(this.lastvisits[boardid]) : 0;\r\n      if(last_ts < built) {\r\n        this.lastvisits[boardid] = built\r\n        localStorage.setItem('lastvisits', JSON.stringify(this.lastvisits))\r\n      }\r\n    })\r\n  },\r\n  refreshTimestamp: function(timestamp, boardName=null) { // PHP standard timestamp length\r\n    if (!this.lastvisits)\r\n      this.init()\r\n    let id = !is_overboard ? boardid : overboard.idFromName(boardName)\r\n    if (id) {\r\n      if (timestamp===null || typeof timestamp === 'undefined')\r\n        timestamp = Math.round(new Date().getTime() / 1000)\r\n      this.lastvisits[id] = timestamp\r\n      localStorage.setItem('lastvisits', JSON.stringify(this.lastvisits))\r\n    }\r\n  },\r\n  update: function() {\r\n    if (!this.lastvisits)\r\n      this.init()\r\n    $.ajax({\r\n      url: '/newpostscount.php',\r\n      data: this.lastvisits,\r\n      dataType: 'json',\r\n      success: function(data) {\r\n        $('.newposts-counter').remove()\r\n        $('.got-updates').removeClass('got-updates')\r\n        _.each(data, function(val, brd) {\r\n          if ((+val) > 0) {\r\n            let valstr = `<span class=\"newposts-counter\">(${val})</span>`\r\n            , $brd = $(`.menu-item[href=\"/${brd}/\"]`)\r\n            if ($brd.length) {\r\n              $brd.append(valstr)\r\n              $(`.sect-exr[data-toexpand=\"${$brd.parents('.menu-sect').attr('id').split('ms-')[1]}\"]`).parent().addClass('got-updates')\r\n            }\r\n            $(`.mobile-nav option[value=\"${brd}\"]`).append(valstr)\r\n          }\r\n        })\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nvar HTMLoader = {\r\n  loadThread: function(boardID, threadID, done, postID) {\r\n    $.get(threadID === '?'\r\n      ? `${ku_boardspath}/postbynumber.php?b=${boardID}&p=${postID}`\r\n      : `${ku_boardspath}/${boardID}/res/${threadID}.html?${force_html_nocache ? Math.random() : ''}`)\r\n    .then(data => {\r\n      let posts = data.match(/<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pd:[0-9]+\\s*?<\\/div\\s*?>[\\s\\S]+?<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pd-end\\s*?<\\/div\\s*?>/gi)\r\n      .map(match => {\r\n        let res = match.match(/<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pd:([0-9]+)\\s*?<\\/div\\s*?>([\\s\\S]+?)<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pd-end\\s*?<\\/div\\s*?>/i);\r\n        return {\r\n          id: +res[1],\r\n          body: res[2]\r\n        }\r\n      })\r\n      if (threadID === '?') {\r\n        let thrno = data.match(/<!--i0:thrno=([0-9]+)-->/) //wtf\r\n        if (thrno)\r\n          threadID = thrno[1]\r\n      }\r\n      if (posts.length) {\r\n        let postMap = posts.map(post => {\r\n          this.cached[`${boardID}_${post.id}`] = post.body\r\n          return post.id\r\n        })\r\n        if (threadID !== '?') {\r\n          this.threadMaps[`${boardID}_${threadID}`] = postMap\r\n        }\r\n      }\r\n      done()\r\n    })\r\n    .fail(err => {\r\n      done(err.status || 'null')\r\n    })\r\n  },\r\n  getPost: function(boardID, threadID, postID, callback, secondTry) {\r\n    let cachedPost = this.cached[`${boardID}_${postID}`]\r\n    if (cachedPost) {\r\n      callback(false, cachedPost)\r\n      return\r\n    }\r\n    else {\r\n      if (!secondTry) {\r\n        let found = false\r\n        if (boardID === this_board_dir) {\r\n          let $post = $(`a[name=${postID}]`)\r\n          if ($post.length) {\r\n            let post = $post.parents('.postnode')[0].outerHTML\r\n            this.cached[`${boardID}_${postID}`] = post\r\n            found = true\r\n            callback(false, post)\r\n          }\r\n        }\r\n        if (!found) {\r\n          this.loadThread(boardID, threadID, err => {\r\n            if (err) {\r\n              callback(err)\r\n            }\r\n            else {\r\n              this.getPost(boardID, threadID, postID, callback, true)\r\n            }\r\n          }, postID)\r\n        }\r\n      }\r\n      else {\r\n        callback(null)\r\n      }\r\n    }\r\n  },\r\n  getThread: function(boardID, threadID, range, callback, secondTry, force) {\r\n    let threadMap = force ? false : this.threadMaps[`${boardID}_${threadID}`]\r\n    if (threadMap) {\r\n      if (range) {\r\n        threadMap = threadMap.filter(n => n > range[0] && n < range[1])\r\n      }\r\n      callback(false, threadMap.reduce((htm, postID) => htm + this.cached[`${boardID}_${postID}`], ''))\r\n    }\r\n    else {\r\n      if (!secondTry) {\r\n        this.loadThread(boardID, threadID, err => {\r\n          if (err) {\r\n            callback(err)\r\n          }\r\n          else {\r\n            this.getThread(boardID, threadID, range, callback, true)\r\n          }\r\n        })\r\n      }\r\n      else {\r\n        callback(null)\r\n      }\r\n    }\r\n  },\r\n  cached: {},\r\n  threadMaps: {},\r\n  cachedPostboxes: {},\r\n  getPostbox: function(boardID) {\r\n    return new Promise((resolve, reject) => {\r\n      if (boardID===false) // not overboard\r\n        return resolve(document.querySelector('#postform'))\r\n      if (this.cachedPostboxes[boardID])\r\n        return resolve(this.cachedPostboxes[boardID])\r\n      $.get(`${ku_boardspath}/${boardID}/`) // dirty deeds done dirt cheap\r\n      .then(data => {\r\n        let pb = data.match(/<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pb\\s*?<\\/div\\s*?>([\\s\\S]+?)<div\\s*?class\\s*?=\\s*?\"[^\"]*?i0svcel[^\"]*?\"\\s*?>!i0-pb-end\\s*?<\\/div\\s*?>/i)\r\n        if (!pb)\r\n          reject(404)\r\n        let c = document.createElement('div')\r\n        c.innerHTML = pb[1]\r\n        let hcaptchaScript\r\n        if (typeof hcaptcha === 'undefined' && (hcaptchaScript = pb[1].match(/<script src=\"(.+?js\\.hcaptcha\\.com.+?)\"/))) {\r\n          head.js(hcaptchaScript[1], () => console.log('hcaptcha loaded'))\r\n        }\r\n        this.cachedPostboxes[boardID] = c.firstChild\r\n        resolve(this.cachedPostboxes[boardID])\r\n      })\r\n      .fail(err => {\r\n        reject(err.status || 'null')\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nfunction switchFileType(el) {\r\n  let exp = /\\.([a-z0-9]+)(?=$|\\?)/i\r\n  , match = el.src.match(exp)\r\n  if (!match) return;\r\n  let exts = el.getAttribute('extset').toLowerCase().split(',')\r\n  if (!exts.length) return;\r\n  let i = exts.indexOf(match[1].toLowerCase())\r\n  if (i == -1 || i >= (exts.length-1)) return;\r\n  el.src = el.src.replace(exp, `.${exts[i+1]}`)\r\n}\r\n\r\nfunction LSfetchJSON(key) {\r\n  let val = null, data = localStorage[key]\r\n  if (typeof data !== 'undefined') {\r\n    try {\r\n      val = JSON.parse(data)\r\n    }\r\n    catch(e) {\r\n      console.error(e)\r\n      localStorage.removeItem(key)\r\n    }\r\n  }\r\n  return val\r\n}\r\n\r\n// YOBA alerts\r\nvar pups = {\r\n  push: function(a) {\r\n    // generate a unique alert ID\r\n    a.id = (+_.uniqueId(_.now())).toString(16)\r\n    this.container.insertAdjacentHTML('afterBegin', this.buildAlert(a))\r\n    a.el = document.getElementById(`pup_${a.id}`)\r\n    // Add the popup to the animation queue\r\n    a.el.style.marginTop = -a.el.getBoundingClientRect().height + 'px'\r\n    a.el.getBoundingClientRect() // This forces browser to respect the element's updated position for future animations (no idea why but it works)\r\n    // Close on click\r\n    a.el.onclick = () => {\r\n      delete a.timeout\r\n      a.onHold = false\r\n      a.old = true\r\n      a.el.classList.add('pup-away')\r\n      a.el.style.marginTop = -a.el.getBoundingClientRect().height + 'px'\r\n    }\r\n    // Do not close if mouse is over\r\n    a.el.onmouseenter = () => {\r\n      // iterate stack from end to start\r\n      this.stack.slice(0).reverse().find(ar => {\r\n        ar.onHold = true\r\n        return (ar.id == a.id) // break\r\n      })\r\n    }\r\n    // Close after mouse leave\r\n    a.el.onmouseleave = () => {\r\n      this.stack.forEach(ae => {\r\n        ae.onHold = false\r\n      })\r\n      this.holdOffTimeout = setTimeout(() => {\r\n        this.stack.forEach(ae => {\r\n          if (!ae.onHold && ae.old && ae.el) {\r\n            ae.el.classList.add('pup-away')\r\n            ae.el.style.marginTop = -a.el.getBoundingClientRect().height + 'px'\r\n          }\r\n        })\r\n      }, 200)\r\n    }\r\n    this.queue.add(() => {\r\n      this.scheduleClose(a)\r\n      a.el.classList.remove('pup-pre')\r\n      a.el.style.marginTop = null\r\n      a.el.classList.remove('pup-noshadow')\r\n    })\r\n    this.stack.push(a)\r\n    this.save()\r\n    return a.id\r\n  },\r\n  closeByID: function(aid) {\r\n    let a = this.byID(aid)\r\n    if (a)\r\n      a.el.onclick()\r\n  },\r\n  queue: {\r\n    stack: [],\r\n    busy: false,\r\n    add: function(fn) {\r\n      return new Promise((resolve, reject) => {\r\n        if (! this.busy) {\r\n          this.timeout = setTimeout(this.next.bind(this), this.cooldown * 1000)\r\n          this.busy = true\r\n          resolve(fn())\r\n        }\r\n        else {\r\n          this.stack.push(() => resolve(fn()))\r\n        }\r\n      })\r\n    },\r\n    next: function() {\r\n      let next = this.stack.shift()\r\n      if (! next)\r\n        this.busy = false\r\n      else {\r\n        next()\r\n        this.timeout = setTimeout(this.next.bind(this), this.cooldown * 1000)\r\n      }\r\n    },\r\n    cooldown: .3\r\n  },\r\n  byID: function(aid) {\r\n    return this.stack.find(a => a.id == aid)\r\n  },\r\n  update: function(aid, upd) {\r\n    let a = this.byID(aid)\r\n    if (typeof upd !== 'object')\r\n      a = {msg: upd}\r\n    _.extend(a, upd)\r\n    // reset timeout\r\n    this.scheduleClose(a)\r\n    a.el.setAttribute('pupclass', a.cls)\r\n    a.el.querySelector('.pup-wrapped').innerHTML = this.buildAlert(a, 1)\r\n    this.save()\r\n  },\r\n  buildAlert: function(a, contentsOnly=false) {\r\n    let contents = `\r\n      <div class=\"alert-icon\">\r\n        <svg class=\"icon\"><use xlink:href=\"#i-${this.iconMap[a.cls]}\"></use></svg>\r\n      </div>\r\n      <div class=\"alert-msg\">${a.msg}</div>`\r\n    if (contentsOnly)\r\n      return contents\r\n    return `<div class=\"pup ${a.old ? 'pup-away pup-away-full' : 'pup-pre pup-noshadow'}\" pupclass=\"${a.cls}\" id=\"pup_${a.id}\">\r\n      <div class=\"pup-wrapped\">\r\n        ${contents}\r\n      </div>\r\n    </div>`\r\n  },\r\n  iconMap: {\r\n    succ: 'success',\r\n    err: 'error',\r\n    info: 'info',\r\n    warn: 'warning'\r\n  },\r\n  historyToggle: function() {\r\n    if (!this.stack.length) {\r\n      this.push({cls: 'info', msg: _l.historyEmpty, destroy: true})\r\n      return\r\n    }\r\n    let on = this.container.classList.toggle('history-mode')\r\n    setTimeout(() => this.container.style.overflow = (on ? 'auto' : null), on ? 300 : 0)\r\n  },\r\n  scheduleClose: function(a) {\r\n    if (a.timeout)\r\n      clearTimeout(a.timeout)\r\n    if (a.onHold)\r\n      a.onHold = false\r\n    let time = (a.time || a.time === 0) ? a.time : this.defaultTimeout\r\n    if (time) // If time is 0 it means no timeout\r\n      a.timeout = setTimeout(() => {\r\n        a.old = true\r\n        if (! a.onHold) {\r\n          a.el.classList.add('pup-away')\r\n          a.el.style.marginTop = -a.el.getBoundingClientRect().height + 'px'\r\n        }\r\n      }, time * 1000)\r\n  },\r\n  defaultTimeout: 3.5, // in seconds\r\n  init: function(container_id=\"pups-container\") {\r\n    document.body.insertAdjacentHTML('beforeEnd', `<div id=\"${container_id}\"><div class=\"pup-history-shadow\"></div></div>`)\r\n    this.container = document.getElementById(container_id)\r\n    if (! this.container) {\r\n      console.error('No popup container found')\r\n      return;\r\n    }\r\n    this.container.onclick = () => {\r\n      if (this.container.classList.contains('history-mode')) {\r\n        return this.historyToggle()\r\n      }\r\n    }\r\n    // make aliases for error classes\r\n    ['err', 'warn', 'info', 'succ', 'wait'].forEach(pupclass => {\r\n      this[pupclass] = function(a, options={}) {\r\n        if (typeof a !== 'object')\r\n          a = {msg: a}\r\n        a.cls = pupclass\r\n        _.extend(a, options)\r\n        return this.push(a)\r\n      }\r\n    })\r\n    // load history from LS\r\n    let log = LSfetchJSON('I0_event_log') || []\r\n    log.forEach(a => {\r\n      a.old = true\r\n      this.container.insertAdjacentHTML('afterBegin', this.buildAlert(a))\r\n      this.stack.push(a)\r\n    })\r\n  },\r\n  historySize: 10,\r\n  save: function() {\r\n    let ss = [] \r\n    _.cloneDeep(this.stack).forEach(a => {\r\n      if (a.save) {\r\n        // Clear stack from the properties that don't need to be saved\r\n        ['old', 'onHold', 'timeout', 'el', 'save'].forEach(junkProperty => delete a[junkProperty])\r\n        ss.push(a)\r\n      }\r\n    })\r\n    while (ss.length > this.historySize) {\r\n      ss.shift()\r\n    }\r\n    localStorage['I0_event_log'] = JSON.stringify(ss)\r\n  },\r\n  stack: []\r\n}\r\n"]}